<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Pour un r√©cent projet sur lequel je suis impliqu√©, je me suis demand√© s‚Äôil n‚Äô√©tait pas possible de mieux repr√©senter les r√©sultats issus de mod√®les lin√©aires que le classique point + intervalles de confiance ou barres + intervalles de confiance. Ce post est une sorte de compte-rendu / pense-b√™te / notes-pour-le-moi-du-futur de mes r√©flexions et avanc√©es techniques.">

<title>Charly Marie ‚Äì Repr√©senter des distributions marginales contrefactuelles</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "Pas de r√©sultats",
    "search-matching-documents-text": "documents trouv√©s",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Recherche"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-SGV9X67YFY"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-SGV9X67YFY', { 'anonymize_ip': true});
</script>
<meta name="quarto:status" content="draft">
<style>
div.callout-calloutabstract.callout {
  border-left-color: #ECF4FC;
}
div.callout-calloutabstract.callout-style-default > .callout-header {
  background-color: rgba(236, 244, 252, 0.13);
}
div.callout-calloutabstract .callout-toggle::before {  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="rgb(33, 37, 41)" class="bi bi-chevron-down" viewbox="0 0 16 16"><path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"></path></svg>');}
div.callout-calloutabstract.callout-style-default .callout-icon::before, div.callout-calloutabstract.callout-titled .callout-icon::before {
  content: 'üìù';
  background-image: none;
}
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Charly Marie - Repr√©senter des distributions marginales contrefactuelles">
<meta property="og:description" content="Pour un r√©cent projet sur lequel je suis impliqu√©, je me suis demand√© s‚Äôil n‚Äô√©tait pas possible de mieux repr√©senter les r√©sultats issus de mod√®les lin√©aires que le classique point + intervalles de confiance ou barres + intervalles de confiance. Ce post est une sorte de compte-rendu / pense-b√™te / notes-pour-le-moi-du-futur de mes r√©flexions et avanc√©es techniques.">
<meta property="og:image" content="https://charlymarie.github.io/posts/Technique - Ploter des donn√©es et le r√©sultat d'un test/data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAABLAAAAGQCAMAAACJa2lsAAAABlBMVEUAAAD/+l2Z/dAAAMcklEQVR4nO3UQZJFKQ4DwJ77X3rWLD50R0DJfs48AYQl/fM/gCb+ST8A4N8yWEAbBgtow2ABbRgsoA2DBbRhsIA2DBbQhsEC2jBYQBsGC2jDYAFtGCygDYPFD/8Epf9OVaLBDwaLekSDHwwW9YgGPxgs6hENfjBY1CMa/GCwqEc0+MFgUY9o8IPBoh7R4AeDRT2iwQ8Gi3pEgx8MFvWIBj8YLOoRDX4wWNQjGvxgsKhHNPjBYFGPaPCDwaIe0eAHg0U9osEPBot6RIMfDBb1iAY/GCzqEQ1+MFjUIxr8YLCoRzT4wWBRj2jwg8GiHtHgB4NFPaLBDwaLekSDHwwW9YgGPxgs6hENfjBY1CMa/GCwqEc0+MFgUY9o8IPBoh7R4AeDRT2icTa0uUO/TWmicTa0uUO/TWmicZZs7lDpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9A6VPTlWicZZu70Dpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9A6VPTlWicZZu70Dpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9A6VPTlWicZZu70Dpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9A6VPTlWicZZu70Dpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9A6VPTlWicZZu70Dpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9A6VPTlWicZZu70Dpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9A6VPTlWicZZu70Dpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9A6VPTlWicZZu70Dpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9A6VPTlWicZZu70Dpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9A6VPTlWicZZu70Dpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9A6VPTlWicZZu70Dpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9A6VPTlWicZZu70Dpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9A6VPTlWicZZu70Dpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9A6VPTlWicZZu70Dpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9/Kl03NhxnrN0g/hT6bix4zxn6Qbxp9JxY8d5ztIN4k+l48aO85ylG8SfSseNHec5SzeIP5WOGzvOc5ZuEH8qHTd2nOcs3SD+VDpu7DjPWbpB/Kl03NhxnrN0g/hT6bix4zxn6Qbxp9JxY8d5ztIN4k+l48aO85ylG8SfSseNnS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ+c/nScdJXjvVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYEEVr1r+IQYLqnjV8g8xWFDFq5Z/iMGCKl61/EMMFlTxquUfYrCgilct/xCDBVW8avmHGCyo4lXLP8RgQRWvWv4hBguqeNXyDzFYUMWrln+IwYIqXrX8QwwWVPGq5R9isKCKVy3/EIMFVbxq+YcYLKjiVcs/xGBBFa9a/iEGC6p41fIPMVhQxauWf4jBgipetfxDDBZU8arlH2KwoIpXLf8QgwVVvGr5hxgsqOJVyz/EYEEVr1r+IQYLqnjV8g8xWFDFq5Z/iMGCKl61/EMMFlTxquUfYrCgilct/xCDBVW8avmHGCyo4lXLP8RgQRWvWv4hBguqeNXyDzFYUMWrln+IwYIqXrX8QwwWVPGq5R9isKCKVy3/EIMFVbxq+YcYLKjiVcs/xGBBFa9a/iEGC6p41fIPMVhQxauWf4jBgipetfxDDBZU8arlH2KwoIpXLf8QgwVVvGr5hxgsqOJVyz/EYEEVr1r+IQYLqnjV8g8xWFDFq5Z/iMGCKl61/EMMFlTxquUfYrCANmNpsACDBTTyamEuM1iAwQIaebUwlxkswGABjbxamMsMFmCwgEZeLcxlBgswWAD/hsEC2jBYQBsGC2jDYAFtGCygDYMFtGGwgDYMFtCGwQLaMFhAGwYLaOPZYAEkGSygDYMFtGGwgDYMFtCGwQLaMFhAGwYLaMNgAW0YLKANgwW0YbCANgwW0IbBAtr4P8Up0nJU8CwTAAAAAElFTkSuQmCC">
<meta property="og:site_name" content="Charly Marie">
</head>

<body class="nav-fixed indent-paragraphs">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><div id="quarto-draft-alert" class="alert alert-warning"><i class="bi bi-pencil-square"></i>Brouillon</div>
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Charly Marie</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Basculer la navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../research.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../work.html"> 
<span class="menu-text">Behavioural science</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../teaching.html"> 
<span class="menu-text">Academic teaching</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../seminars.html"> 
<span class="menu-text">Seminars</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../cv.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Sur cette page</h2>
   
  <ul>
  <li><a href="#r√©sum√©" id="toc-r√©sum√©" class="nav-link active" data-scroll-target="#r√©sum√©">R√©sum√©</a></li>
  <li><a href="#point-de-d√©part" id="toc-point-de-d√©part" class="nav-link" data-scroll-target="#point-de-d√©part">Point de d√©part</a></li>
  <li><a href="#pr√©parer-lenvironnement" id="toc-pr√©parer-lenvironnement" class="nav-link" data-scroll-target="#pr√©parer-lenvironnement">Pr√©parer l‚Äôenvironnement</a></li>
  <li><a href="#estimer-la-diff√©rence-entre-les-groupes" id="toc-estimer-la-diff√©rence-entre-les-groupes" class="nav-link" data-scroll-target="#estimer-la-diff√©rence-entre-les-groupes">Estimer la diff√©rence entre les groupes</a>
  <ul class="collapse">
  <li><a href="#repr√©senter-les-r√©sultats-de-leq-simple" id="toc-repr√©senter-les-r√©sultats-de-leq-simple" class="nav-link" data-scroll-target="#repr√©senter-les-r√©sultats-de-leq-simple">Repr√©senter les r√©sultats de l‚Äô√âquation&nbsp;1</a>
  <ul class="collapse">
  <li><a href="#repr√©senter-un-r√©sum√©-des-donn√©es" id="toc-repr√©senter-un-r√©sum√©-des-donn√©es" class="nav-link" data-scroll-target="#repr√©senter-un-r√©sum√©-des-donn√©es">Repr√©senter un r√©sum√© des donn√©es</a></li>
  <li><a href="#repr√©senter-un-r√©sum√©-des-donn√©es-et-les-observations" id="toc-repr√©senter-un-r√©sum√©-des-donn√©es-et-les-observations" class="nav-link" data-scroll-target="#repr√©senter-un-r√©sum√©-des-donn√©es-et-les-observations">Repr√©senter un r√©sum√© des donn√©es <em>et</em> les observations</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#estimer-la-diff√©rence-entre-les-groupes-en-contr√¥lant-pour-le-genre-et-l√¢ge" id="toc-estimer-la-diff√©rence-entre-les-groupes-en-contr√¥lant-pour-le-genre-et-l√¢ge" class="nav-link" data-scroll-target="#estimer-la-diff√©rence-entre-les-groupes-en-contr√¥lant-pour-le-genre-et-l√¢ge">Estimer la diff√©rence entre les groupes, en contr√¥lant pour le genre et l‚Äô√¢ge</a>
  <ul class="collapse">
  <li><a href="#repr√©senter-les-r√©sultats-de-leq-controle_interaction" id="toc-repr√©senter-les-r√©sultats-de-leq-controle_interaction" class="nav-link" data-scroll-target="#repr√©senter-les-r√©sultats-de-leq-controle_interaction">Repr√©senter les r√©sultats de l‚Äô√âquation&nbsp;2</a>
  <ul class="collapse">
  <li><a href="#repr√©senter-un-r√©sum√©-des-donn√©es-1" id="toc-repr√©senter-un-r√©sum√©-des-donn√©es-1" class="nav-link" data-scroll-target="#repr√©senter-un-r√©sum√©-des-donn√©es-1">Repr√©senter un r√©sum√© des donn√©es</a></li>
  <li><a href="#repr√©senter-un-r√©sum√©-des-donn√©es-et-les-observations-1" id="toc-repr√©senter-un-r√©sum√©-des-donn√©es-et-les-observations-1" class="nav-link" data-scroll-target="#repr√©senter-un-r√©sum√©-des-donn√©es-et-les-observations-1">Repr√©senter un r√©sum√© des donn√©es <em>et</em> les observations</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#r√©f√©rences" id="toc-r√©f√©rences" class="nav-link" data-scroll-target="#r√©f√©rences">R√©f√©rences</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Repr√©senter des distributions marginales contrefactuelles</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Montrer tout le code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Cacher tout le code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Voir les sources</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">R</div>
    <div class="quarto-category">Graphiques</div>
    <div class="quarto-category">Mod√®le lin√©aire</div>
    <div class="quarto-category">marginaleffects</div>
  </div>
  </div>

<div>
  <div class="description">
    Pour un r√©cent projet sur lequel je suis impliqu√©, je me suis demand√© s‚Äôil n‚Äô√©tait pas possible de <em>mieux</em> repr√©senter les r√©sultats issus de mod√®les lin√©aires que le classique point + intervalles de confiance ou barres + intervalles de confiance. Ce post est une sorte de compte-rendu / pense-b√™te / notes-pour-le-moi-du-futur de mes r√©flexions et avanc√©es techniques.
  </div>
</div>


<div class="quarto-title-meta column-page-left">

    
    <div>
    <div class="quarto-title-meta-heading">Date de publication</div>
    <div class="quarto-title-meta-contents">
      <p class="date">3 mai 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<hr style="border:1px solid blue">
<section id="r√©sum√©" class="level1">
<h1>R√©sum√©</h1>
</section>
<section id="point-de-d√©part" class="level1">
<h1>Point de d√©part</h1>
<p>En psychologie, en √©conomie, en biologie, etc‚Ä¶ nous analysons des donn√©es d‚Äôexp√©rimentations, que nous communiquons ensuite au sein de papiers, de chapitres, ou encore de conf√©rences. Nous analysons le plus souvent ces donn√©es via des mod√®les lin√©aires, et nous rapportons ensuite un joli test ou une jolie r√©gression (#NoKinkShaming). Les plus habiles d‚Äôentre nous vont jusqu‚Äô√† rapporter un (joli) graphique des r√©sultats et renvoyer la (jolie) table de r√©gression en annexe.</p>
<p>Deux cas de figure peuvent appara√Ætre.</p>
<ul>
<li><strong>On se contente de rapporter des points, souvent des moyennes, avec parfois un intervalle de confiance</strong>
<ul>
<li>Si le test n‚Äôest qu‚Äôune comparaison de moyennes, ces graphiques repr√©sentent des statistiques descriptives.</li>
<li>Si le test est une comparaison de moyennes <em>ajust√©es</em>, par exemple en sortie de r√©gression multiple, les graphiques sont un poil plus complexes √† r√©aliser, mais cela reste largement faisable avec la plupart des logiciels d‚Äôaujourd‚Äôhui.</li>
</ul></li>
<li><strong>On souhaite √©galement rapporter la distribution des donn√©es</strong>
<ul>
<li>A nouveau, si l‚Äôon travaille √† partir de deux variables, il est simple de repr√©senter les donn√©es sous-jacentes et leur r√©sum√©.</li>
<li>Cependant, d√®s lors que l‚Äôon raisonne √† partir d‚Äôune r√©gression en logique <em>toutes choses √©gales par ailleurs</em>, la repr√©sentation graphique se complique : les quantit√©s d‚Äôint√©r√™t ne sont plus les observations brutes, mais des pr√©dictions d√©riv√©es du mod√®le <em>pour une grille de pr√©dicteurs</em>.</li>
</ul></li>
</ul>
<p>Pourquoi vouloir s‚Äôemb√™ter √† repr√©senter l‚Äôensemble de la distribution? Car les graphiques en points / en barres sont limit√©s, en ce qu‚Äôils r√©sument l‚Äôensemble des donn√©es au seul param√®tre de la moyenne (cf.&nbsp;par exemple ce <a href="https://www.linkedin.com/posts/nicola-rennie_tidytuesday-rstats-dataviz-share-7404110322237669376-iRsT/" target="_blank">#TidyTuesday</a>). Les meilleures pratiques sont plut√¥t de repr√©senter (1) les donn√©es et (2) un r√©sum√© des donn√©es. Ce post de blog est une sorte de notes-pour-plus-tard-et-√†-moi-m√™me pour <em>visualiser ces pr√©dictions individuelles moyennes, avec un r√©sum√© des donn√©es</em>. Il se trouve que c‚Äôest faisable avec un peu d‚Äôhuile de coude<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
</section>
<section id="pr√©parer-lenvironnement" class="level1">
<h1>Pr√©parer l‚Äôenvironnement</h1>
<p>Je commence par charger les packages, par d√©finir un th√®me <code>ggplot2()</code>, et par simuler des donn√©es assez simples. L‚Äôavantage de les simuler, c‚Äôest que l‚Äôon peut sp√©cifier la <em>vraie</em> valeur qu‚Äôun param√®tre doit renvoyer :</p>
<div class="cell">
<details class="code-fold">
<summary>Voir le code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Charger les packages ####</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse); <span class="fu">library</span>(ggpubr); <span class="fu">library</span>(ggtext); <span class="fu">library</span>(modelsummary)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(easystats); <span class="fu">library</span>(broom); <span class="fu">library</span>(gt); <span class="fu">library</span>(ggdag); <span class="fu">library</span>(labelled); <span class="fu">library</span>(marginaleffects); <span class="fu">library</span>(ggdist); <span class="fu">library</span>(gtsummary)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_gtsummary_language</span>(<span class="st">"fr"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="do">#### D√©finir une seed, pour des r√©sultats reproductibles ####</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>seed <span class="ot">=</span> <span class="dv">891</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(seed)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="do">#### Construire un th√®me ggplot() personnalis√© ####</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Quasi enti√®rement copi√© d'Andrew Heiss: https://www.andrewheiss.com/blog/2021/12/20/fully-bayesian-ate-iptw/</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Avec l'aide de Nicolas Rennie: https://nrennie.rbind.io/art-of-viz/programming-languages.html</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>egypt <span class="ot">&lt;-</span> MetBrewer<span class="sc">::</span><span class="fu">met.brewer</span>(<span class="st">"Egypt"</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>theme_nice <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Times"</span>) <span class="sc">+</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_textbox_simple</span>(<span class="at">lineheight =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_textbox_simple</span>(<span class="at">lineheight =</span> <span class="fl">0.5</span>),</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_textbox_simple</span>(<span class="at">lineheight =</span> <span class="fl">0.5</span>),</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">0.8</span>), <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey80"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title=</span><span class="fu">element_blank</span>(),</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Rien en X</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks.x=</span><span class="fu">element_blank</span>())</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Faire de ce th√®me le th√®me par d√©faut</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_nice</span>())</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="do">#### G√©n√©rer des donn√©es ####</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Genre ~ 50/50</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>genre <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.5</span>)  <span class="co"># 1 = Gar√ßon, 0 = Fille</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>genre <span class="ot">&lt;-</span> <span class="fu">factor</span>(genre, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Fille"</span>, <span class="st">"Gar√ßon"</span>))</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="co"># √Çge : 18 √† 70, d√©pendant du genre</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  genre <span class="sc">==</span> <span class="st">"Gar√ßon"</span>,</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">runif</span>(n, <span class="dv">30</span>, <span class="dv">70</span>),  <span class="co"># Gar√ßons plus √¢g√©s en moyenne</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">runif</span>(n, <span class="dv">18</span>, <span class="dv">50</span>))   <span class="co"># Filles plus jeunes en moyenne</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Groupe : d√©pend du genre et donc indirectement √©galement de l‚Äô√¢ge</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>groupe_num <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>  genre <span class="sc">==</span> <span class="st">"Gar√ßon"</span>,</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.8</span>),</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.2</span>))</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>groupe <span class="ot">&lt;-</span> <span class="fu">factor</span>(groupe_num, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span>, <span class="st">"test"</span>))</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="do">#### G√©n√©ration de la r√©ponse ####</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Effets structurels</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>beta_groupe <span class="ot">&lt;-</span> <span class="dv">15</span>   <span class="co"># effet vrai</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>beta_fille <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>beta_age <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.6</span> <span class="co"># √¢ge d√©favorisant, corr√©l√© au groupe</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>reponse <span class="ot">&lt;-</span> <span class="dv">40</span> <span class="sc">+</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>  beta_groupe <span class="sc">*</span> (groupe <span class="sc">==</span> <span class="st">"test"</span>) <span class="sc">+</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>  beta_fille <span class="sc">*</span> (genre <span class="sc">==</span> <span class="st">"Fille"</span>) <span class="sc">+</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>  beta_age <span class="sc">*</span> age <span class="sc">+</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">8</span>)</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Contraindre la r√©ponse entre 0 et 100</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>reponse <span class="ot">&lt;-</span> <span class="fu">pmin</span>(<span class="fu">pmax</span>(reponse, <span class="dv">0</span>), <span class="dv">100</span>)</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">reponse =</span> reponse,</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">groupe  =</span> groupe,</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">genre   =</span> genre,</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>  <span class="at">age     =</span> <span class="fu">round</span>(age, <span class="dv">0</span>))</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(df) <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>  <span class="at">genre   =</span> <span class="st">"Genre"</span>,</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>  <span class="at">age     =</span> <span class="st">"√Çge"</span>,</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>  <span class="at">reponse =</span> <span class="st">"R√©ponse"</span>,</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">groupe  =</span> <span class="st">"Groupe"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>Une variable <code>r√©ponse</code> continue, qui peut prendre de 0 √† 100. Cette variable pourrait √™tre (presque) n‚Äôimporte quoi : l‚Äôestime de soi, la confiance en soi, la sant√©, le sentiment de comp√©tence √† l‚Äô√©cole‚Ä¶</li>
<li>Une variable <code>groupe</code>, qui encode une manipulation que l‚Äôon a r√©alis√©e. Cela peut √™tre en laboratoire, dans une √©cole, via Qualtrics‚Ä¶ √† nouveau, qu‚Äôimporte. Le vrai effet de cette variable est <span class="math inline">\(\beta\)</span> = 15.</li>
<li>Une variable <code>genre</code> binaire (d√©sol√© pour les personnes au-milieu ou en-dehors du genre, c‚Äôest pour simplifier).</li>
<li>Une variable <code>age</code> continue.</li>
</ul>
<p>Regardons ce que cela donne :</p>
<div class="cell">
<div id="tbl-descriptive0" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-descriptive0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script src="https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.js"></script>

    <script>
      // Create table-specific functions using external factory
      const tableFns_qf3awiukqnifi5qnjgse = TinyTable.createTableFunctions("tinytable_qf3awiukqnifi5qnjgse");
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '7', j: 1 }, { i: '7', j: 2 }, { i: '7', j: 3 }, { i: '7', j: 4 }, { i: '7', j: 5 }, { i: '7', j: 6 }, { i: '7', j: 7 }, { i: '7', j: 8 }, { i: '7', j: 9 } ], css_id: 'tinytable_css_uiccn6ko6zkoknlmf14s',}, 
          { positions: [ { i: '3', j: 1 }, { i: '3', j: 2 }, { i: '3', j: 3 }, { i: '3', j: 4 }, { i: '3', j: 5 }, { i: '3', j: 6 }, { i: '3', j: 7 }, { i: '3', j: 8 }, { i: '3', j: 9 } ], css_id: 'tinytable_css_7uv4iw7diut6ltui6g2o',}, 
          { positions: [ { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 4 }, { i: '0', j: 5 }, { i: '0', j: 6 }, { i: '0', j: 7 }, { i: '0', j: 8 }, { i: '0', j: 9 } ], css_id: 'tinytable_css_67vzb3awdz6wg01xbp16',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  tableFns_qf3awiukqnifi5qnjgse.styleCell(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.css">
    <style>
    /* tinytable css entries after */
    #tinytable_qf3awiukqnifi5qnjgse td.tinytable_css_uiccn6ko6zkoknlmf14s, #tinytable_qf3awiukqnifi5qnjgse th.tinytable_css_uiccn6ko6zkoknlmf14s {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.1em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }
    #tinytable_qf3awiukqnifi5qnjgse td.tinytable_css_7uv4iw7diut6ltui6g2o, #tinytable_qf3awiukqnifi5qnjgse th.tinytable_css_7uv4iw7diut6ltui6g2o {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 1; --line-color-bottom: #d3d8dc; --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.1em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%; ; font-weight: bold }
    #tinytable_qf3awiukqnifi5qnjgse td.tinytable_css_67vzb3awdz6wg01xbp16, #tinytable_qf3awiukqnifi5qnjgse th.tinytable_css_67vzb3awdz6wg01xbp16 {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 1; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }
    </style>
    <div class="container">
      <table class="tinytable" id="tinytable_qf3awiukqnifi5qnjgse" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        
        <thead>
              <tr>
                <th scope="col" data-row="0" data-col="1"> </th>
                <th scope="col" data-row="0" data-col="2">Unique</th>
                <th scope="col" data-row="0" data-col="3">Missing Pct.</th>
                <th scope="col" data-row="0" data-col="4">Mean</th>
                <th scope="col" data-row="0" data-col="5">SD</th>
                <th scope="col" data-row="0" data-col="6">Min</th>
                <th scope="col" data-row="0" data-col="7">Median</th>
                <th scope="col" data-row="0" data-col="8">Max</th>
                <th scope="col" data-row="0" data-col="9">Histogram</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td data-row="1" data-col="1">R√©ponse</td>
                  <td data-row="1" data-col="2">979</td>
                  <td data-row="1" data-col="3">0</td>
                  <td data-row="1" data-col="4">34.8</td>
                  <td data-row="1" data-col="5">17.3</td>
                  <td data-row="1" data-col="6">0.0</td>
                  <td data-row="1" data-col="7">35.0</td>
                  <td data-row="1" data-col="8">85.1</td>
                  <td data-row="1" data-col="9"><img src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAABLAAAAGQCAMAAACJa2lsAAAABlBMVEUAAAD///+l2Z/dAAAMcklEQVR4nO3UQZJFKQ4DwJ77X3rWLD50R0DJfs48AYQl/fM/gCb+ST8A4N8yWEAbBgtow2ABbRgsoA2DBbRhsIA2DBbQhsEC2jBYQBsGC2jDYAFtGCygDYPFD/8Epf9OVaLBDwaLekSDHwwW9YgGPxgs6hENfjBY1CMa/GCwqEc0+MFgUY9o8IPBoh7R4AeDRT2iwQ8Gi3pEgx8MFvWIBj8YLOoRDX4wWNQjGvxgsKhHNPjBYFGPaPCDwaIe0eAHg0U9osEPBot6RIMfDBb1iAY/GCzqEQ1+MFjUIxr8YLCoRzT4wWBRj2jwg8GiHtHgB4NFPaLBDwaLekSDHwwW9YgGPxgs6hENfjBY1CMa/GCwqEc0+MFgUY9o8IPBoh7R4AeDRT2icTa0uUO/TWmicTa0uUO/TWmicZZs7lDpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9A6VPTlWicZZu70Dpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9A6VPTlWicZZu70Dpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9A6VPTlWicZZu70Dpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9A6VPTlWicZZu70Dpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9A6VPTlWicZZu70Dpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9A6VPTlWicZZu70Dpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9A6VPTlWicZZu70Dpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9A6VPTlWicZZu70Dpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9A6VPTlWicZZu70Dpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9A6VPTlWicZZu70Dpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9A6VPTlWicZZu70Dpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9A6VPTlWicZZu70Dpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9A6VPTlWicZZu70Dpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9A6VPTlWicZZu70Dpk1OVaJyl2ztQ+uRUJRpn6fYOlD45VYnGWbq9/Kl03NhxnrN0g/hT6bix4zxn6Qbxp9JxY8d5ztIN4k+l48aO85ylG8SfSseNHec5SzeIP5WOGzvOc5ZuEH8qHTd2nOcs3SD+VDpu7DjPWbpB/Kl03NhxnrN0g/hT6bix4zxn6Qbxp9JxY8d5ztIN4k+l48aO85ylG8SfSseNnS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ6fLedIpZox01Nnpcp50ihkjHXV2upwnnWLGSEednS7nSaeYMdJRZ+c/nScdJXjvVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYMHiVdW4wWDB4lXVuMFgweJV1bjBYEEVr1r+IQYLqnjV8g8xWFDFq5Z/iMGCKl61/EMMFlTxquUfYrCgilct/xCDBVW8avmHGCyo4lXLP8RgQRWvWv4hBguqeNXyDzFYUMWrln+IwYIqXrX8QwwWVPGq5R9isKCKVy3/EIMFVbxq+YcYLKjiVcs/xGBBFa9a/iEGC6p41fIPMVhQxauWf4jBgipetfxDDBZU8arlH2KwoIpXLf8QgwVVvGr5hxgsqOJVyz/EYEEVr1r+IQYLqnjV8g8xWFDFq5Z/iMGCKl61/EMMFlTxquUfYrCgilct/xCDBVW8avmHGCyo4lXLP8RgQRWvWv4hBguqeNXyDzFYUMWrln+IwYIqXrX8QwwWVPGq5R9isKCKVy3/EIMFVbxq+YcYLKjiVcs/xGBBFa9a/iEGC6p41fIPMVhQxauWf4jBgipetfxDDBZU8arlH2KwoIpXLf8QgwVVvGr5hxgsqOJVyz/EYEEVr1r+IQYLqnjV8g8xWFDFq5Z/iMGCKl61/EMMFlTxquUfYrCANmNpsACDBTTyamEuM1iAwQIaebUwlxkswGABjbxamMsMFmCwgEZeLcxlBgswWAD/hsEC2jBYQBsGC2jDYAFtGCygDYMFtGGwgDYMFtCGwQLaMFhAGwYLaOPZYAEkGSygDYMFtGGwgDYMFtCGwQLaMFhAGwYLaMNgAW0YLKANgwW0YbCANgwW0IbBAtr4P8Up0nJU8CwTAAAAAElFTkSuQmCC" style="height: 1em;" class="figure-img"></td>
                </tr>
                <tr>
                  <td data-row="2" data-col="1">√Çge</td>
                  <td data-row="2" data-col="2">53</td>
                  <td data-row="2" data-col="3">0</td>
                  <td data-row="2" data-col="4">42.3</td>
                  <td data-row="2" data-col="5">13.2</td>
                  <td data-row="2" data-col="6">18.0</td>
                  <td data-row="2" data-col="7">42.0</td>
                  <td data-row="2" data-col="8">70.0</td>
                  <td data-row="2" data-col="9"><img src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAABLAAAAGQCAMAAACJa2lsAAAABlBMVEUAAAD///+l2Z/dAAAMbElEQVR4nO3UwZHFyg0DwO/8k/bJp8eqtURzMJS7I5AGIP75F8AS/6Q/AOC/ZbCANQwWsIbBAtYwWMAaBgtYw2ABaxgsYA2DBaxhsIA1DBawhsEC1jBYwBoGi7/9c0T6L1lAS/ibweISWsLfDBaX0BL+ZrC4hJbwN4PFJbSEvxksLqEl/M1gcQkt4W8Gi0toCX8zWFxCS/ibweISWsLfDBaX0BL+ZrC4hJbwN4PFJbSEv50ZrCPST0mPAPlbemX+h9JPSY8A+Vt6Zf6H0k9JjwCXSw/ANum86BHgcukB2CadFz0CXC49ANuk86JHgMulB2CbdF70CHC59ABsk86LHgEulx6AbdJ50SPA5dIDsE06L3oEuFx6ALZJ50WPAJdLD8A26bzoEeBy6QHYJp0XPQJcLj0A26TzokeAy6UHYJt0XvQIcLn0AGyTzoseAc5J3yaFdCnoEeCc9G1SSJeCHgHOSd8mhXQp6BHgnPRtUkiXgh4BzknfJoV0KegR4Jz0bVJIl4IeAc5J3yaFdCnoEeCc9G1SSJeCHgHOSd8mhXQp6BHgnPRtUkiXgh4BzknfJoV0KegR4Jz0bVJIl4IeAc5J3yaFdCnoEeCc9G1SSJeCHgHOSd8mhXQp6BHgnPRtUkiXgh4BzknfJoV0KegR4Jz0bVJIl4IeAc5J3yaFdCnoEeCc9G1SSJeCHgHOSd8mhXQp6BHgnPRtUkiXgh4BzknfJoV0KegR4Jz0bVJIl4IeAc5J3yaFdCnoEeCc9G1SSJeCHgHOSd8mhXQp6BHgnPRtUkiXgh4BzknfJoV0KegR4Jz0bVJIl4IeAc5J3yaFdCnoEeCc9G1SSJeCHgHOSd8mhXQp6BHgnPRtUkiXgh4BzknfJoV0KegR4Jz0bVJIl4IeAc5J3yaFdCnoEeCc9G1SSJeCHgHOSd8mhXQp6BHgnPRtUkiXgh4BzknfJoV0KegR4Jz0bVJIl4IeAc5J3yaFdCnoEeCc9G1SSJeCHgHOSd8mhXQp6BHgnPRtUkiXgh4BzknfJoV0KegR4Jz0bVJIl4IeAc5J3yaFdCnoEeCc9G1SSJeCHgHOSd8mhXQp6BHgnPRtUkiXgh4BzknfJoV0KegR4Jz0bVJIl4IeAc5J3yaFdCnoEeCc9G1SSJeCHgHOSd8mhXQp6BHgnPRtUkiXgh4BzknfJoV0KegR4Jz0bVJIl4IeAc5J3yaFdCnoEeCc9G1SSJeCHgHOSd8mhXQp6BHgnPRtUkiXgh4BzknfJoV0KegR4Jz0bVJIl4IeAc5J3yaFdCnoEeCc9G1SSJeCHgHOSd8mhXQp6BHgnPRtUkiXgh4BzknfJoV0KegR4Jz0bVJIl4IeAc5J3yaFdCnoEeCc9G1SSJeCHgHOSd8mhXQp6BHgnPRtUkiXgh4BzknfJoV0KegR4Jz0bVJIl4IeAc5J3yaFdCnoEeCc9G1SSJeCHgHOSd8mhXQp6BHgnPRtUkiXgh4BzknfJoV0KegR4Jz0bVJIl4IeAc5J3yaFdCnoEeCc9G1SSJeCHgHOSd8mhXQp6BHgnPRtUkiXgh4BzknfJoV0KegR4Jz0bVJIl4IeAc5J3yaFdCnoEeCc9G1SSJeCHgHOSd8mhXQp6BHgnPRtUkiXgh4BzknfJoV0KegR4Jz0bVJIl4IeAc5J3yaFdCnoEeCc9G1SSJeCHgHOSd8mhXQp6BHgnPRtUkiXgh4BzknfJoV0KegR4Jz0bVJIl4IeAc5J3yaFdCnoEeCc9G1SSJeCHgHOSd8mhXQp6BHgnPRtUkiXgh4BzknfJoV0KegR4Jz0bVJIl4IeAc5J3yaFdCnoEeCc9G1SSJeCHgHOSd8mhXQp6BHgnPRtUkiXgh4BzknfJoV0KegR4Jz0bVJIl4IeAc5J3yaFdCnoEeCc9G1SSJeCHgHOSd8mhXQp6BHgnPRtUkiXgh4BzknfJoV0KegR4Jz0bVJIl4IeAc5J3yaFdCnoEeCc9G1SSJeCHgHOSd8mhXQp6BHgnPRtUkiXgh4BzknfJoV0KegR4Jz0bVJIl4IeAc5J3yaFdCnouS/A7/T2zJ/wyIngmXNfgN/p7Zk/4ZETwTPnvgC/09szf8IjJ4Jnzn0Bfqe3Z/6ER04Ez5z7AvxOb8/8CY+cCJ459wX4nd6e+RMeORE8c+4L8Du9PfMnPHIieObcF+B3envmT3jkRPDMuS/A7/T2zJ/wyIngmXNfgN/p7Zk/4ZETwTPnvgC/09szf8IjJ4Jnzn0Bfqe3Z/6ER04Ez5z7AvxOb8/8CY+cCJ459wX4nd6e+RMeORE8c+4L8Du9PfMnPHIieObcF2C60Xxaut703BdgutF8Wrre9NwXYLrRfFq63vTcF2C60Xxaut703BdgutF8Wrre9NwXYLrRfFq63vTcF2C60Xxaut703BdgutF8Wrre9NwXYLrRfFq63vTcF2C60Xxaut703BdgutF8Wrre9NwXYLrRfFq63vTcF2C60Xxaut703BdgutF8Wrre9NwXYLrRfFq63vTcF2C60Xxaut703BdgutF8Wrre9NwXYLrRfFq63vTcF2C60Xxaut703BdgutF8Wrre9NwXYLrRfFq63vTcF2C60Xxaut703BdgutF8Wrre9NwXYLrRfFq63vTcF2C60Xzadyp84k/uc99vn0mb/1PfqfCJP7nPfb99Jm1YLn2oGff9droHsEL6UDPu++10D2CF9KFm3Pfb6R4A/5Fegx8XfhFwifQa/Ljwi4BLpNfgx4VfBFwivQY/Lvwi4BLpNfhx4RcBl0ivwY8Lvwi4RHoNflz4RcAl0mvw48IvAi6RXoMfF34RcIn0Gvy48IuAS6TX4MeFXwRcIr0GPy78IuAS6TX4ceEXAZdIr8GPC78IuER6DX5c+EXAJdJr8OPCLwIukV6DHxd+EXCJ9Br8uPCLgEuk1+DHhV8EXCK9Bj8u/CLgEuk1+HHhFwGXSK/Bjwu/CLhEeg1+XPhFwCXSa/Djwi8CLpFegx8XfhFwifQa/Ljwi4BLpNfgx4VfBFwivQY/Lvwi4BLpNfhx4RcBl0ivwY8Lvwi4RHoNflz4RcAl0mvw48IvAi6RXoMfF34R8P/k0TxM7c5r6dcDjno0D1O781r69YCjHs3D1O68ln494KhH8zC1O6+lXw846tE8TO3Oa+nXA456NA9Tu/Na+vWAox7Nw9TuvJZ+PeCoR/MwtTuvpV8POOrRPEztzmvp1wOOejQPU7vzWvr1gKMezcPU7ryWfj3gqEfzMLU7r6VfDzjq0TxM7c5r6dcDjno0D1O781r69YCjHs3D1O68ln494KhH8zC1O6+lXw846tE8TO3Oa+nXA456NA9Tu/Na+vWAox7Nw9TuvJZ+PeCoR/MwtTuvpV8POOrRPEztzmvp1wOOejQPU7vzWvr1gKMezcPU7ryWfj3gqEfzMLU7r6VfDzjq0TxM7c5r6dcDjno0D1O781r69YCjHs3D1O68ln494KhH8zC1O6+lXw846tE8TO3Oa+nXA456NA9Tu/Na+vWAox7Nw9TuvJZ+PeCoR/MwtTuvpV8POOrRPEztzmvp1wOOejQPU7vzWvr1gKMezcPU7ryWfj3gqEfzMLU7r6VfDzjq0TxM7c5r6dcDjno0D1O781r69YCjHs3D1O68ln494KhH8zC1O6+lXw846tE8TO3Oa+nXA456NA9Tu/Na+vWAox7Nw9TuvJZ+PeCoR/NgS4AkgwWsYbCANQwWsIbBAtYwWMAaBgtYw2ABaxgsYA2DBaxhsIA1DBawhsEC1jBYwBoGC1jDYAFrGCxgDYMFrGGwgDUMFrCGwQLWMFjAGgYLWMNgAWsYLGANgwWsYbCANQwWsIbBAtYwWMAaBgtYw2ABaxgsYA2DBaxhsIA1DBawhsEC1jBYwBoGC1jDYAFrGCxgDYMFrGGwgDUMFrCGwQLWMFjAGgYLWMNgAWsYLGANgwWsYbCANQwWsIbBAtYwWMAaBgtYw2ABaxgsYA2DBaxhsIA1DBawhsEC1jBYwBoGC1jDYAFrGCxgDYMFrGGwgDUMFrCGwQLWMFjAGgYLWMNgAWsYLGANgwWsYbCANQwWsIbBAtYwWMAaBgtYw2ABaxgsYA2DBaxhsIA1DBawhsEC1jBYwBoGC1jDYAFrGCxgDYMFrGGwgDUMFrCGwQLWMFjAGgYLWGNssACSDBawhsEC1jBYwBoGC1jDYAFrGCxgDYMFrGGwgDUMFrCGwQLWMFjAGgYLWMNgAWv8G4gWTegwtYLcAAAAAElFTkSuQmCC" style="height: 1em;" class="figure-img"></td>
                </tr>
                <tr>
                  <td data-row="3" data-col="1"></td>
                  <td data-row="3" data-col="2"></td>
                  <td data-row="3" data-col="3">N</td>
                  <td data-row="3" data-col="4">%</td>
                  <td data-row="3" data-col="5"> </td>
                  <td data-row="3" data-col="6"> </td>
                  <td data-row="3" data-col="7"> </td>
                  <td data-row="3" data-col="8"> </td>
                  <td data-row="3" data-col="9"> </td>
                </tr>
                <tr>
                  <td data-row="4" data-col="1">Groupe</td>
                  <td data-row="4" data-col="2">contr√¥le</td>
                  <td data-row="4" data-col="3">513</td>
                  <td data-row="4" data-col="4">51.3</td>
                  <td data-row="4" data-col="5"> </td>
                  <td data-row="4" data-col="6"> </td>
                  <td data-row="4" data-col="7"> </td>
                  <td data-row="4" data-col="8"> </td>
                  <td data-row="4" data-col="9"> </td>
                </tr>
                <tr>
                  <td data-row="5" data-col="1"></td>
                  <td data-row="5" data-col="2">test</td>
                  <td data-row="5" data-col="3">487</td>
                  <td data-row="5" data-col="4">48.7</td>
                  <td data-row="5" data-col="5"> </td>
                  <td data-row="5" data-col="6"> </td>
                  <td data-row="5" data-col="7"> </td>
                  <td data-row="5" data-col="8"> </td>
                  <td data-row="5" data-col="9"> </td>
                </tr>
                <tr>
                  <td data-row="6" data-col="1">Genre</td>
                  <td data-row="6" data-col="2">Fille</td>
                  <td data-row="6" data-col="3">502</td>
                  <td data-row="6" data-col="4">50.2</td>
                  <td data-row="6" data-col="5"> </td>
                  <td data-row="6" data-col="6"> </td>
                  <td data-row="6" data-col="7"> </td>
                  <td data-row="6" data-col="8"> </td>
                  <td data-row="6" data-col="9"> </td>
                </tr>
                <tr>
                  <td data-row="7" data-col="1"></td>
                  <td data-row="7" data-col="2">Gar√ßon</td>
                  <td data-row="7" data-col="3">498</td>
                  <td data-row="7" data-col="4">49.8</td>
                  <td data-row="7" data-col="5"> </td>
                  <td data-row="7" data-col="6"> </td>
                  <td data-row="7" data-col="7"> </td>
                  <td data-row="7" data-col="8"> </td>
                  <td data-row="7" data-col="9"> </td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-descriptive0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Description des donn√©es simul√©es.
</figcaption>
</figure>
</div>
</div>
<p>Cependant, pour une raison qui nous est inconnue, l‚Äôallocation al√©atoire n‚Äôa pas bien fonctionn√© (c‚Äôest bien la tuile !), et les donn√©es collect√©es d√©pendent <em>tr√®s</em> largement du genre et de l‚Äô√¢ge des personnes :</p>
<div class="cell">
<div id="tbl-descriptive1" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-descriptive1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<div id="rngfzrjfne" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#rngfzrjfne table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rngfzrjfne thead, #rngfzrjfne tbody, #rngfzrjfne tfoot, #rngfzrjfne tr, #rngfzrjfne td, #rngfzrjfne th {
  border-style: none;
}

#rngfzrjfne p {
  margin: 0;
  padding: 0;
}

#rngfzrjfne .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rngfzrjfne .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rngfzrjfne .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rngfzrjfne .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rngfzrjfne .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rngfzrjfne .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rngfzrjfne .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rngfzrjfne .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rngfzrjfne .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rngfzrjfne .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rngfzrjfne .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rngfzrjfne .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rngfzrjfne .gt_spanner_row {
  border-bottom-style: hidden;
}

#rngfzrjfne .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rngfzrjfne .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rngfzrjfne .gt_from_md > :first-child {
  margin-top: 0;
}

#rngfzrjfne .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rngfzrjfne .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rngfzrjfne .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rngfzrjfne .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rngfzrjfne .gt_row_group_first td {
  border-top-width: 2px;
}

#rngfzrjfne .gt_row_group_first th {
  border-top-width: 2px;
}

#rngfzrjfne .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rngfzrjfne .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rngfzrjfne .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rngfzrjfne .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rngfzrjfne .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rngfzrjfne .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rngfzrjfne .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rngfzrjfne .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rngfzrjfne .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rngfzrjfne .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rngfzrjfne .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rngfzrjfne .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rngfzrjfne .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rngfzrjfne .gt_left {
  text-align: left;
}

#rngfzrjfne .gt_center {
  text-align: center;
}

#rngfzrjfne .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rngfzrjfne .gt_font_normal {
  font-weight: normal;
}

#rngfzrjfne .gt_font_bold {
  font-weight: bold;
}

#rngfzrjfne .gt_font_italic {
  font-style: italic;
}

#rngfzrjfne .gt_super {
  font-size: 65%;
}

#rngfzrjfne .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rngfzrjfne .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rngfzrjfne .gt_indent_1 {
  text-indent: 5px;
}

#rngfzrjfne .gt_indent_2 {
  text-indent: 10px;
}

#rngfzrjfne .gt_indent_3 {
  text-indent: 15px;
}

#rngfzrjfne .gt_indent_4 {
  text-indent: 20px;
}

#rngfzrjfne .gt_indent_5 {
  text-indent: 25px;
}

#rngfzrjfne .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#rngfzrjfne div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header gt_col_headings gt_spanner_row">
<th rowspan="2" id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th colspan="4" id="level 1; stat_1_1" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
<strong>Fille</strong>
</div></th>
<th colspan="4" id="level 1; stat_1_2" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
<strong>Gar√ßon</strong>
</div></th>
</tr>
<tr class="odd gt_col_headings">
<th id="stat_1_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>[18,25]</strong><br>
N = 119<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_2_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>(25,40]</strong><br>
N = 233<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_3_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>(40,55]</strong><br>
N = 150<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_4_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>(55,70]</strong><br>
N = 0<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_1_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>[18,25]</strong><br>
N = 0<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_2_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>(25,40]</strong><br>
N = 113<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_3_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>(40,55]</strong><br>
N = 198<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_4_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>(55,70]</strong><br>
N = 187<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">R√©ponse</td>
<td class="gt_row gt_center" headers="stat_1_1">54.72 (10.17)</td>
<td class="gt_row gt_center" headers="stat_2_1">49.07 (9.84)</td>
<td class="gt_row gt_center" headers="stat_3_1">40.23 (10.43)</td>
<td class="gt_row gt_center" headers="stat_4_1"></td>
<td class="gt_row gt_center" headers="stat_1_2"></td>
<td class="gt_row gt_center" headers="stat_2_2">30.45 (10.24)</td>
<td class="gt_row gt_center" headers="stat_3_2">22.64 (9.64)</td>
<td class="gt_row gt_center" headers="stat_4_2">15.31 (9.73)</td>
</tr>
</tbody><tfoot>
<tr class="odd gt_footnotes">
<td colspan="9" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Moyenne (ET)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-descriptive1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Description des donn√©es simul√©es, par genre et par √¢ge.
</figcaption>
</figure>
</div>
</div>
<p>Or, mettons que le genre et l‚Äô√¢ge influencent √©galement la r√©ponse. On se retrouve dans le cadre classique d‚Äôune variable dite <em>confondante</em>, au sens o√π elle influence √† la fois le pr√©dicteur et la r√©ponse <span class="citation" data-cites="CinelliForneyPearl2022">(<a href="#ref-CinelliForneyPearl2022" role="doc-biblioref">Cinelli et al., 2022</a>)</span>, et biaise donc le v√©ritable effet causal. Le graphe acyclique dirig√©, du genre que l‚Äôon aimerait toujours aussi simple, est repr√©sent√© en <a href="#fig-plot_dag" class="quarto-xref">Figure&nbsp;1</a> :</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-plot_dag" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot_dag-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="draft_files/figure-html/fig-plot_dag-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot_dag-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Graphe acyclique dirig√© du processus de g√©n√©ration des donn√©es.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="estimer-la-diff√©rence-entre-les-groupes" class="level1">
<h1>Estimer la diff√©rence entre les groupes</h1>
<p>Dans notre √©chantillon, l‚Äôeffet d‚Äôun c√¥t√© du genre &amp; de l‚Äô√¢ge et de l‚Äôautre du groupe se compensent, de sorte que la diff√©rence moyenne observ√©e entre le groupe test et le groupe contr√¥le est fausse. En cons√©quence, ajuster le mod√®le lin√©aire suivant renvoie un coefficient <span class="math inline">\(\beta\)</span> biais√© :</p>
<p><span id="eq-simple"><span class="math display">\[
Y_i = \alpha + \beta D_i + \varepsilon_i
\tag{1}\]</span></span></p>
<p>o√π :</p>
<ul>
<li><span class="math inline">\(D_i\)</span> est une variable indicatrice telle que <span class="math inline">\(D_i = 1\)</span> si l‚Äôindividu <span class="math inline">\(i\)</span> appartient au groupe <em>test</em> et <span class="math inline">\(D_i = 0\)</span> s‚Äôil appartient au groupe <em>contr√¥le</em></li>
<li><span class="math inline">\(\beta\)</span> repr√©sente la diff√©rence moyenne de <span class="math inline">\(Y\)</span> entre le groupe test et le groupe contr√¥le</li>
</ul>
<div class="cell">
<div id="tbl-lm1" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-lm1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<div id="rwjchrwznv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#rwjchrwznv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rwjchrwznv thead, #rwjchrwznv tbody, #rwjchrwznv tfoot, #rwjchrwznv tr, #rwjchrwznv td, #rwjchrwznv th {
  border-style: none;
}

#rwjchrwznv p {
  margin: 0;
  padding: 0;
}

#rwjchrwznv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rwjchrwznv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rwjchrwznv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rwjchrwznv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rwjchrwznv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rwjchrwznv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rwjchrwznv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rwjchrwznv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rwjchrwznv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rwjchrwznv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rwjchrwznv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rwjchrwznv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rwjchrwznv .gt_spanner_row {
  border-bottom-style: hidden;
}

#rwjchrwznv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rwjchrwznv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rwjchrwznv .gt_from_md > :first-child {
  margin-top: 0;
}

#rwjchrwznv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rwjchrwznv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rwjchrwznv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rwjchrwznv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rwjchrwznv .gt_row_group_first td {
  border-top-width: 2px;
}

#rwjchrwznv .gt_row_group_first th {
  border-top-width: 2px;
}

#rwjchrwznv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rwjchrwznv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rwjchrwznv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rwjchrwznv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rwjchrwznv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rwjchrwznv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rwjchrwznv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rwjchrwznv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rwjchrwznv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rwjchrwznv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rwjchrwznv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rwjchrwznv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rwjchrwznv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rwjchrwznv .gt_left {
  text-align: left;
}

#rwjchrwznv .gt_center {
  text-align: center;
}

#rwjchrwznv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rwjchrwznv .gt_font_normal {
  font-weight: normal;
}

#rwjchrwznv .gt_font_bold {
  font-weight: bold;
}

#rwjchrwznv .gt_font_italic {
  font-style: italic;
}

#rwjchrwznv .gt_super {
  font-size: 65%;
}

#rwjchrwznv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rwjchrwznv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rwjchrwznv .gt_indent_1 {
  text-indent: 5px;
}

#rwjchrwznv .gt_indent_2 {
  text-indent: 10px;
}

#rwjchrwznv .gt_indent_3 {
  text-indent: 15px;
}

#rwjchrwznv .gt_indent_4 {
  text-indent: 20px;
}

#rwjchrwznv .gt_indent_5 {
  text-indent: 25px;
}

#rwjchrwznv .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#rwjchrwznv div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th id="Param√®tre" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Param√®tre</strong></th>
<th id="Estimation" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Estimation<br>
[IC 95 %]</strong></th>
<th id="Erreur-standard" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Erreur standard</strong></th>
<th id="Statistique-t-(998)" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Statistique <em>t</em> (998)</strong></th>
<th id="p" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong><em>p</em>-valeur</strong></th>
<th id="aŒ≤" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong><em>Œ≤</em><br>
[IC 95 %]</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Param√®tre">(Intercept)</td>
<td class="gt_row gt_center" headers="Estimation">37.89<br>[36.42; 39.37]</td>
<td class="gt_row gt_center" headers="Erreur standard">0.75</td>
<td class="gt_row gt_center" headers="Statistique t (998)">50.38</td>
<td class="gt_row gt_center" headers="p">&lt; .001</td>
<td class="gt_row gt_center" headers="Œ≤">0.18<br>[0.1; 0.27]</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Param√®tre">Groupe : Test</td>
<td class="gt_row gt_center" headers="Estimation">-6.42<br>[-8.53; -4.3]</td>
<td class="gt_row gt_center" headers="Erreur standard">1.08</td>
<td class="gt_row gt_center" headers="Statistique t (998)">-5.94</td>
<td class="gt_row gt_center" headers="p">&lt; .001</td>
<td class="gt_row gt_center" headers="Œ≤">-0.37<br>[-0.49; -0.25]</td>
</tr>
</tbody><tfoot>
<tr class="odd gt_footnotes">
<td colspan="6" class="gt_footnote"><em>Note</em> : n = 1 000 observations.</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-lm1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: R√©gression de la R√©ponse par le Groupe.
</figcaption>
</figure>
</div>
</div>
<p>L‚Äôintercept de la <a href="#tbl-lm1" class="quarto-xref">Table&nbsp;3</a> signifie que la moyenne de la r√©ponse du groupe de contr√¥le est de 37.89. Le param√®tre estim√© pour le groupe test signifie qu‚Äôil pr√©sente une diff√©rence moyenne au groupe contr√¥le de -6.42. Donc, sa moyenne vaut 37.89 + -6.42 = 31.47.</p>
<p>Ce que l‚Äôon peut facilement v√©rifier, via une simple moyenne, dans la <a href="#tbl-mean1" class="quarto-xref">Table&nbsp;4</a> :</p>
<div class="cell">
<div id="tbl-mean1" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-mean1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<div id="cqxvxgmwub" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#cqxvxgmwub table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#cqxvxgmwub thead, #cqxvxgmwub tbody, #cqxvxgmwub tfoot, #cqxvxgmwub tr, #cqxvxgmwub td, #cqxvxgmwub th {
  border-style: none;
}

#cqxvxgmwub p {
  margin: 0;
  padding: 0;
}

#cqxvxgmwub .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#cqxvxgmwub .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#cqxvxgmwub .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#cqxvxgmwub .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#cqxvxgmwub .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cqxvxgmwub .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cqxvxgmwub .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cqxvxgmwub .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#cqxvxgmwub .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#cqxvxgmwub .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#cqxvxgmwub .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#cqxvxgmwub .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#cqxvxgmwub .gt_spanner_row {
  border-bottom-style: hidden;
}

#cqxvxgmwub .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#cqxvxgmwub .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#cqxvxgmwub .gt_from_md > :first-child {
  margin-top: 0;
}

#cqxvxgmwub .gt_from_md > :last-child {
  margin-bottom: 0;
}

#cqxvxgmwub .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#cqxvxgmwub .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#cqxvxgmwub .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#cqxvxgmwub .gt_row_group_first td {
  border-top-width: 2px;
}

#cqxvxgmwub .gt_row_group_first th {
  border-top-width: 2px;
}

#cqxvxgmwub .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cqxvxgmwub .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#cqxvxgmwub .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#cqxvxgmwub .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cqxvxgmwub .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cqxvxgmwub .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#cqxvxgmwub .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#cqxvxgmwub .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#cqxvxgmwub .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cqxvxgmwub .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cqxvxgmwub .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cqxvxgmwub .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cqxvxgmwub .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cqxvxgmwub .gt_left {
  text-align: left;
}

#cqxvxgmwub .gt_center {
  text-align: center;
}

#cqxvxgmwub .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#cqxvxgmwub .gt_font_normal {
  font-weight: normal;
}

#cqxvxgmwub .gt_font_bold {
  font-weight: bold;
}

#cqxvxgmwub .gt_font_italic {
  font-style: italic;
}

#cqxvxgmwub .gt_super {
  font-size: 65%;
}

#cqxvxgmwub .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#cqxvxgmwub .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#cqxvxgmwub .gt_indent_1 {
  text-indent: 5px;
}

#cqxvxgmwub .gt_indent_2 {
  text-indent: 10px;
}

#cqxvxgmwub .gt_indent_3 {
  text-indent: 15px;
}

#cqxvxgmwub .gt_indent_4 {
  text-indent: 20px;
}

#cqxvxgmwub .gt_indent_5 {
  text-indent: 25px;
}

#cqxvxgmwub .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#cqxvxgmwub div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="Groupe" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Groupe</th>
<th id="Moyenne" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Moyenne</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Groupe">Contr√¥le</td>
<td class="gt_row gt_right" headers="Moyenne">37.89</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Groupe">Test</td>
<td class="gt_row gt_right" headers="Moyenne">31.47</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-mean1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Tri √† plat de la moyenne de la R√©ponse, par le Groupe.
</figcaption>
</figure>
</div>
</div>
<section id="repr√©senter-les-r√©sultats-de-leq-simple" class="level2">
<h2 class="anchored" data-anchor-id="repr√©senter-les-r√©sultats-de-leq-simple">Repr√©senter les r√©sultats de l‚Äô<a href="#eq-simple" class="quarto-xref">√âquation&nbsp;1</a></h2>
<p>Autrement dit, si le mod√®le lin√©aire ne contient que deux param√®tres (un intercept et une variable), il est possible de directement travailler √† partir des donn√©es brutes pour calculer les moyennes et intervalles de confiance<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. Cependant, je crois qu‚Äôil vaut mieux travailler √† partir de mod√®les lin√©aires qu‚Äô√† partir des donn√©es brutes :</p>
<ul>
<li>D‚Äôabord, s‚Äôil est vrai que pour des mod√®les simples comme le notre cela ne change rien √† l‚Äôestimation des param√®tres, pour des mod√®les plus complexes (trois param√®tres, des interactions, etc‚Ä¶), les param√®tres estim√©s ne sont plus les param√®tres bruts. Il faudra directement travailler √† partir du mod√®le, autant s‚Äôy habituer.</li>
<li>De plus, au-del√† des estimations, c‚Äôest l‚Äôerreur qui nous int√©resse : c‚Äôest √† partir de l‚Äôerreur que l‚Äôon calcule les intervalles de confiance, <em>t</em> ou <em>z</em>, et <em>p</em>. Travailler √† partir d‚Äôun mod√®le lin√©aire permet donc utiliser des erreurs robustes √† l‚Äôh√©t√©rosc√©dasticit√©, bootstrap, clusters, et d‚Äôautres encore <span class="citation" data-cites="Zeileis2004">(<a href="#ref-Zeileis2004" role="doc-biblioref">Zeileis, 2004</a>)</span>.</li>
<li>Finalement, c‚Äôest une bonne pratique, en anticipation de mod√®les plus complexes comme par exemple des mod√®les de panel <span class="citation" data-cites="berge_2018">(<a href="#ref-berge_2018" role="doc-biblioref">Berg√©, 2018</a>)</span>.</li>
</ul>
<p>C‚Äôest la m√©thode que nous allons employer pour r√©aliser la <a href="#fig-plot_exemple" class="quarto-xref">Figure&nbsp;2</a> √† partir d‚Äôerreurs robustes.</p>
<section id="repr√©senter-un-r√©sum√©-des-donn√©es" class="level3">
<h3 class="anchored" data-anchor-id="repr√©senter-un-r√©sum√©-des-donn√©es">Repr√©senter un r√©sum√© des donn√©es</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Voir le code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>marginal_means_lm1 <span class="ot">&lt;-</span> <span class="fu">avg_predictions</span>(lm1, <span class="at">variables =</span> <span class="st">"groupe"</span>, <span class="at">vcov =</span> <span class="st">"HC3"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> marginal_means_lm1 <span class="sc">%&gt;%</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> groupe, <span class="at">y =</span> estimate, <span class="at">colour =</span> groupe, <span class="at">shape =</span> groupe)) <span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">colour =</span> <span class="cn">NULL</span>),</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">0</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"test"</span> <span class="ot">=</span> egypt[<span class="dv">1</span>], <span class="st">"contr√¥le"</span> <span class="ot">=</span> egypt[<span class="dv">2</span>]),</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span>, <span class="st">"test"</span>),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="st">"Contr√¥le"</span>, <span class="st">"test"</span> <span class="ot">=</span> <span class="st">"Test"</span>)) <span class="sc">+</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"test"</span> <span class="ot">=</span> <span class="dv">16</span>, <span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="dv">17</span>), </span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span>, <span class="st">"test"</span>), </span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="st">"Contr√¥le"</span>, <span class="st">"test"</span> <span class="ot">=</span> <span class="st">"Test"</span>)) <span class="sc">+</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">17</span>, <span class="dv">16</span>),</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="dv">0</span>)),</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Moyenne de la r√©ponse, en fonction du groupe"</span>,</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Graphique en points."</span>,</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>, </span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"R√©ponse moyenne"</span>)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> marginal_means_lm1 <span class="sc">%&gt;%</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> groupe, <span class="at">y =</span> estimate, <span class="at">fill =</span> groupe)) <span class="sc">+</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high), <span class="at">width =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"test"</span> <span class="ot">=</span> egypt[<span class="dv">1</span>], <span class="st">"contr√¥le"</span> <span class="ot">=</span> egypt[<span class="dv">2</span>]), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span>, <span class="st">"test"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="st">"Contr√¥le"</span>, <span class="st">"test"</span> <span class="ot">=</span> <span class="st">"Test"</span>)) <span class="sc">+</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Moyenne de la r√©ponse, en fonction du groupe"</span>, <span class="at">subtitle =</span> <span class="st">"Graphique en barres."</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"R√©ponse moyenne"</span>)</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  p1, p2,</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="st">"v"</span>, </span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">common.legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="st">"bottom"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot_exemple" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot_exemple-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="draft_files/figure-html/fig-plot_exemple-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot_exemple-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Un exemple de graphiques qui fonctionnent, mais qui pourraient √™tre am√©lior√©s. La barre repr√©sente l‚Äôintervalle de confiance √† 95 %, calcul√© √† partir d‚Äôerreurs robustes √† l‚Äôh√©t√©rosc√©dasticit√©.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Ces graphiques sont quasiment cl√© en main : ils repr√©sentent les moyennes marginales issues d‚Äôun mod√®le lin√©aire, avec l‚Äôincertitude li√©e √† l‚Äôestimation calcul√©e de fa√ßon robuste.</p>
</section>
<section id="repr√©senter-un-r√©sum√©-des-donn√©es-et-les-observations" class="level3">
<h3 class="anchored" data-anchor-id="repr√©senter-un-r√©sum√©-des-donn√©es-et-les-observations">Repr√©senter un r√©sum√© des donn√©es <em>et</em> les observations</h3>
<p>Le graphique que l‚Äôon vient de r√©aliser masque (1) les 1 000 observations que nous avons simul√©es et (2) la dispersion des donn√©es. Nous pourrions souhaiter repr√©senter ces donn√©es, et la complexit√© qu‚Äôelles recoupent, par exemple avec <code>ggdist</code> <span class="citation" data-cites="kay_ggdist">(<a href="#ref-kay_ggdist" role="doc-biblioref">Kay, 2024</a>)</span>.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Voir le code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> marginal_means_lm1 <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> groupe, <span class="at">y =</span> estimate)) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_slab</span>(</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> df,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">x =</span> groupe, <span class="at">y =</span> reponse, <span class="at">fill =</span> groupe),</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">scale =</span> <span class="fl">0.45</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">colour =</span> <span class="cn">NA</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">adjust =</span> <span class="fl">0.7</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_dotsinterval</span>(</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> df,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">x =</span> groupe, <span class="at">y =</span> reponse, <span class="at">fill =</span> groupe, <span class="at">shape =</span> groupe),</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">side =</span> <span class="st">"bottom"</span>,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">scale =</span> <span class="fl">0.45</span>,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">point_size =</span> <span class="fl">1.5</span>,</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">adjust =</span> <span class="fl">0.7</span>,</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">point_interval =</span> mean_qi,</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">justification =</span> <span class="fl">1.1</span>,</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">slab_linewidth =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">colour =</span> groupe), <span class="at">width =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"test"</span> <span class="ot">=</span> egypt[<span class="dv">1</span>], <span class="st">"contr√¥le"</span> <span class="ot">=</span> egypt[<span class="dv">2</span>]),</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span>, <span class="st">"test"</span>),</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="st">"Contr√¥le"</span>, <span class="st">"test"</span> <span class="ot">=</span> <span class="st">"Test"</span>)) <span class="sc">+</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"test"</span> <span class="ot">=</span> egypt[<span class="dv">1</span>], <span class="st">"contr√¥le"</span> <span class="ot">=</span> egypt[<span class="dv">2</span>]),</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span>, <span class="st">"test"</span>),</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="st">"Contr√¥le"</span>, <span class="st">"test"</span> <span class="ot">=</span> <span class="st">"Test"</span>),</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"test"</span> <span class="ot">=</span> <span class="dv">16</span>, <span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="dv">17</span>),</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span>, <span class="st">"test"</span>),</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="st">"Contr√¥le"</span>, <span class="st">"test"</span> <span class="ot">=</span> <span class="st">"Test"</span>)) <span class="sc">+</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Moyenne de la r√©ponse, en fonction du groupe"</span>,</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="st">"Intervalles de confiance robustes et distribution des donn√©es."</span>,</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"R√©ponse moyenne"</span>) <span class="sc">+</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">colour =</span> <span class="st">"none"</span>,</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">shape =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">override.aes =</span> <span class="fu">list</span>(</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour =</span> <span class="fu">c</span>(egypt[<span class="dv">2</span>], egypt[<span class="dv">1</span>]),</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill   =</span> <span class="fu">c</span>(egypt[<span class="dv">2</span>], egypt[<span class="dv">1</span>]),</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>          <span class="at">slab_alpha =</span> <span class="dv">0</span>,</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>          <span class="at">linetype =</span> <span class="dv">0</span>)))</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>p3</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot_lm1_hetero" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot_lm1_hetero-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="draft_files/figure-html/fig-plot_lm1_hetero-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot_lm1_hetero-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Un exemple de graphique qui repr√©sente un effet de traitement contrefactuel. Le point repr√©sente la moyenne marginale estim√©e √† partir du mod√®le lin√©aire. La ligne color√©e correspond √† l‚Äôintervalle de confiance √† 95 % issu du mod√®le lin√©aire et robuste √† l‚Äôh√©t√©rosc√©dasticit√©. Les segments noirs situ√©s sous les points d√©crivent la distribution empirique des donn√©es : le segment le plus √©pais contient 66 % de la masse de la distribution, et le segment plus fin 95 %. La courbe de densit√© √† droite repr√©sente l‚Äôestimation liss√©e de la distribution des observations. Les points √† gauche correspondent aux observations individuelles, empil√©es afin de rendre leur concentration visible.
</figcaption>
</figure>
</div>
</div>
</div>
<p>On pourrait certainement am√©liorer ce plot, qui est tr√®s charg√©, mais c‚Äôest d√©j√† un bon point de d√©part je crois.</p>
</section>
</section>
</section>
<section id="estimer-la-diff√©rence-entre-les-groupes-en-contr√¥lant-pour-le-genre-et-l√¢ge" class="level1">
<h1>Estimer la diff√©rence entre les groupes, en contr√¥lant pour le genre et l‚Äô√¢ge</h1>
<p>Seulement voil√† : ce plot est faux. Et nous le savons, car nous avons g√©n√©r√© des donn√©es pour lesquelles <span class="math inline">\(\beta = 15\)</span>. Il faudrait donc, a minima, ajuster un mod√®le lin√©aire int√©grant le genre et l‚Äô√¢ge. Certains pourraient m√™me pr√©ciser qu‚Äôil vaudrait encore mieux int√©grer l‚Äôensemble des interactions groupe x genre x √¢ge.</p>
<p>Ici, on va rester calmes et plut√¥t ajuster le mod√®le suivant, qui autorise une h√©t√©rog√©n√©it√© de l‚Äôeffet du groupe en fonction de l‚Äô√¢ge et du genre :</p>
<p><span id="eq-controle_interaction"><span class="math display">\[
\begin{aligned}
Y_i
= {} &amp; \alpha
+ \beta D_i
+ \gamma G_i
+ \delta A_i \\
&amp; + \eta \, (D_i \times G_i)
+ \theta \, (D_i \times A_i)
+ \varepsilon_i
\end{aligned}
\tag{2}\]</span></span></p>
<p>o√π :</p>
<ul>
<li><span class="math inline">\(D_i\)</span> indique l‚Äôappartenance de l‚Äôindividu <span class="math inline">\(i\)</span>, telle que <span class="math inline">\(D_i = 0\)</span> si l‚Äôindividu <span class="math inline">\(i\)</span> est dans le groupe contr√¥le et <span class="math inline">\(D_i = 1\)</span> s‚Äôil l‚Äôindividu <span class="math inline">\(i\)</span> est dans le groupe test.</li>
<li><span class="math inline">\(G_i\)</span> est une variable indicatrice telle que <span class="math inline">\(G_i = 0\)</span> si l‚Äôindividu <span class="math inline">\(i\)</span> est une fille et <span class="math inline">\(G_i = 1\)</span> s‚Äôil s‚Äôagit d‚Äôun gar√ßon.</li>
<li><span class="math inline">\(A_i\)</span> d√©signe l‚Äô√¢ge, mod√©lis√© comme une variable continue.</li>
<li>Le param√®tre <span class="math inline">\(\beta\)</span> repr√©sente l‚Äôeffet du traitement pour l‚Äôindividu de r√©f√©rence (<span class="math inline">\(G_i = 0\)</span> et <span class="math inline">\(A_i = 0\)</span>), <span class="math inline">\(\gamma\)</span> la diff√©rence moyenne associ√©e au genre dans le groupe contr√¥le, et <span class="math inline">\(\delta\)</span> l‚Äôeffet marginal de l‚Äô√¢ge dans le groupe contr√¥le pour l‚Äôindividu de r√©f√©rence.</li>
<li>Les param√®tres <span class="math inline">\(\eta\)</span> et <span class="math inline">\(\theta\)</span> captent respectivement la modification de l‚Äôeffet du traitement selon le genre et selon l‚Äô√¢ge.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Voir le code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>lm2 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(reponse <span class="sc">~</span> groupe <span class="sc">*</span> (genre <span class="sc">+</span> age), .)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Il ne faut pas interpr√©ter directement les coefficients issus du mod√®le <span class="citation" data-cites="WestreichGreenland2013">(cf. <a href="#ref-WestreichGreenland2013" role="doc-biblioref">Westreich &amp; Greenland, 2013</a>)</span>, mais passer par la comparaison de moyennes marginales contrefactuelles estim√©es √† partir de l‚Äô<a href="#eq-controle_interaction" class="quarto-xref">√âquation&nbsp;2</a>.</p>
<div class="cell">
<details class="code-fold">
<summary>Voir le code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>marginal_comparisons_lm2 <span class="ot">&lt;-</span> <span class="fu">avg_comparisons</span>(lm2, <span class="at">variables =</span> <span class="st">"groupe"</span>, <span class="at">vcov =</span> <span class="st">"HC3"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>marginal_comparisons_lm2 <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> <span class="fu">ifelse</span>(p.value <span class="sc">&lt;</span> .<span class="dv">001</span>, <span class="st">"&lt; .001"</span>, <span class="fu">round</span>(p.value, <span class="dv">3</span>)),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">2</span>)),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">paste0</span>(estimate, <span class="st">"&lt;br&gt;"</span>, <span class="st">"["</span>, conf.low, <span class="st">"; "</span>, conf.high, <span class="st">"]"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(term, contrast, s.value, conf.low, conf.high)) <span class="sc">%&gt;%</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">html</span>(<span class="st">"&lt;strong&gt;Estimation&lt;br&gt;[IC 95 %]&lt;/strong&gt;"</span>),</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">std.error =</span> <span class="fu">html</span>(<span class="st">"&lt;strong&gt;Erreur standard&lt;/strong&gt;"</span>),</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="fu">html</span>(</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"&lt;strong&gt;Statistique &lt;em&gt;t&lt;/em&gt; ("</span>,</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>             broom<span class="sc">::</span><span class="fu">glance</span>(lm2)<span class="sc">$</span>df.residual,</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>             <span class="st">")&lt;/strong&gt;"</span>)),</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> <span class="fu">html</span>(<span class="st">"&lt;strong&gt;&lt;em&gt;p&lt;/em&gt;-valeur&lt;/strong&gt;"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_markdown</span>(<span class="at">columns =</span> <span class="fu">c</span>(estimate)) <span class="sc">%&gt;%</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>,</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>      estimate,</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>      std.error,</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>      statistic,</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>      p.value)) <span class="sc">%&gt;%</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html</span>(<span class="fu">paste0</span>(<span class="st">"&lt;em&gt;Note&lt;/em&gt; : n = "</span>,</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>            scales<span class="sc">::</span><span class="fu">number</span>(broom<span class="sc">::</span><span class="fu">glance</span>(lm2)<span class="sc">$</span>nobs),</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>            <span class="st">" observations. Comparaison des moyennes marginales estim√©es √† partir du mod√®le lin√©aire."</span>)))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-lm2" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-lm2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<div id="mfzrgteuex" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mfzrgteuex table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mfzrgteuex thead, #mfzrgteuex tbody, #mfzrgteuex tfoot, #mfzrgteuex tr, #mfzrgteuex td, #mfzrgteuex th {
  border-style: none;
}

#mfzrgteuex p {
  margin: 0;
  padding: 0;
}

#mfzrgteuex .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mfzrgteuex .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mfzrgteuex .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mfzrgteuex .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mfzrgteuex .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mfzrgteuex .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mfzrgteuex .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mfzrgteuex .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mfzrgteuex .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mfzrgteuex .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mfzrgteuex .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mfzrgteuex .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mfzrgteuex .gt_spanner_row {
  border-bottom-style: hidden;
}

#mfzrgteuex .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mfzrgteuex .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mfzrgteuex .gt_from_md > :first-child {
  margin-top: 0;
}

#mfzrgteuex .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mfzrgteuex .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mfzrgteuex .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mfzrgteuex .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mfzrgteuex .gt_row_group_first td {
  border-top-width: 2px;
}

#mfzrgteuex .gt_row_group_first th {
  border-top-width: 2px;
}

#mfzrgteuex .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mfzrgteuex .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mfzrgteuex .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mfzrgteuex .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mfzrgteuex .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mfzrgteuex .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mfzrgteuex .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mfzrgteuex .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mfzrgteuex .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mfzrgteuex .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mfzrgteuex .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mfzrgteuex .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mfzrgteuex .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mfzrgteuex .gt_left {
  text-align: left;
}

#mfzrgteuex .gt_center {
  text-align: center;
}

#mfzrgteuex .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mfzrgteuex .gt_font_normal {
  font-weight: normal;
}

#mfzrgteuex .gt_font_bold {
  font-weight: bold;
}

#mfzrgteuex .gt_font_italic {
  font-style: italic;
}

#mfzrgteuex .gt_super {
  font-size: 65%;
}

#mfzrgteuex .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mfzrgteuex .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mfzrgteuex .gt_indent_1 {
  text-indent: 5px;
}

#mfzrgteuex .gt_indent_2 {
  text-indent: 10px;
}

#mfzrgteuex .gt_indent_3 {
  text-indent: 15px;
}

#mfzrgteuex .gt_indent_4 {
  text-indent: 20px;
}

#mfzrgteuex .gt_indent_5 {
  text-indent: 25px;
}

#mfzrgteuex .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mfzrgteuex div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Estimation<br>
[IC 95 %]</strong></th>
<th id="std.error" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Erreur standard</strong></th>
<th id="statistic" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Statistique <em>t</em> (994)</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong><em>p</em>-valeur</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="estimate">14.92<br>[13.68; 16.16]</td>
<td class="gt_row gt_center" headers="std.error">0.63</td>
<td class="gt_row gt_center" headers="statistic">23.57</td>
<td class="gt_row gt_center" headers="p.value">&lt; .001</td>
</tr>
</tbody><tfoot>
<tr class="even gt_footnotes">
<td colspan="4" class="gt_footnote"><em>Note</em> : n = 1 000 observations. Comparaison des moyennes marginales estim√©es √† partir du mod√®le lin√©aire.</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-lm2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: Comparaison des moyennes marginales issues de l‚Äô<a href="#eq-controle_interaction" class="quarto-xref">√âquation&nbsp;2</a>, r√©gressant la R√©ponse par le Groupe, en contr√¥lant pour l‚Äôinteraction avec le genre et l‚Äô√¢ge.
</figcaption>
</figure>
</div>
</div>
<p>Ouf ! Les choses sont bien faites et <span class="math inline">\(\beta\)</span> vaut bien (presque) 15.</p>
<section id="repr√©senter-les-r√©sultats-de-leq-controle_interaction" class="level2">
<h2 class="anchored" data-anchor-id="repr√©senter-les-r√©sultats-de-leq-controle_interaction">Repr√©senter les r√©sultats de l‚Äô<a href="#eq-controle_interaction" class="quarto-xref">√âquation&nbsp;2</a></h2>
<p>On pourrait rapporter la <a href="#tbl-lm2" class="quarto-xref">Table&nbsp;5</a>, et on serait d√©j√† bien content¬∑e. Sur le m√™me mode que la <a href="#fig-plot_exemple" class="quarto-xref">Figure&nbsp;2</a>, on pourrait √©galement r√©aliser un graphique des moyennes marginales.</p>
<section id="repr√©senter-un-r√©sum√©-des-donn√©es-1" class="level3">
<h3 class="anchored" data-anchor-id="repr√©senter-un-r√©sum√©-des-donn√©es-1">Repr√©senter un r√©sum√© des donn√©es</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Voir le code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>p_ate_predictions_points <span class="ot">&lt;-</span> <span class="fu">avg_predictions</span>(lm2, <span class="at">variables =</span> <span class="st">"groupe"</span>, <span class="at">vcov =</span> <span class="st">"HC3"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> groupe, <span class="at">y =</span> estimate, <span class="at">color =</span> groupe, <span class="at">shape =</span> groupe) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high), <span class="at">width =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Effets contrefactuels moyens"</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Point et intervalles de confiance √† 95 %."</span>,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"R√©ponse"</span>) <span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"test"</span> <span class="ot">=</span> egypt[<span class="dv">1</span>], <span class="st">"contr√¥le"</span> <span class="ot">=</span> egypt[<span class="dv">2</span>]),</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span>, <span class="st">"test"</span>),</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="st">"Contr√¥le"</span>, <span class="st">"test"</span> <span class="ot">=</span> <span class="st">"Test"</span>)) <span class="sc">+</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"test"</span> <span class="ot">=</span> egypt[<span class="dv">1</span>], <span class="st">"contr√¥le"</span> <span class="ot">=</span> egypt[<span class="dv">2</span>]),</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span>, <span class="st">"test"</span>),</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="st">"Contr√¥le"</span>, <span class="st">"test"</span> <span class="ot">=</span> <span class="st">"Test"</span>),</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"test"</span> <span class="ot">=</span> <span class="dv">16</span>, <span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="dv">17</span>),</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span>, <span class="st">"test"</span>),</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="st">"Contr√¥le"</span>, <span class="st">"test"</span> <span class="ot">=</span> <span class="st">"Test"</span>)) <span class="sc">+</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"none"</span>,</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">override.aes =</span> <span class="fu">list</span>(</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="fu">c</span>(egypt[<span class="dv">2</span>], egypt[<span class="dv">1</span>]),</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill   =</span> <span class="fu">c</span>(egypt[<span class="dv">2</span>], egypt[<span class="dv">1</span>]),</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">slab_alpha =</span> <span class="dv">0</span>,</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">linetype =</span> <span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), </span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>p_ate_predictions_bars <span class="ot">&lt;-</span> <span class="fu">avg_predictions</span>(lm2, <span class="at">variables =</span> <span class="st">"groupe"</span>, <span class="at">vcov =</span> <span class="st">"HC3"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> groupe, <span class="at">y =</span> estimate, <span class="at">fill =</span> groupe) <span class="sc">+</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high), <span class="at">width =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Effets contrefactuels moyens"</span>,</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Point et intervalles de confiance √† 95 %."</span>,</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"R√©ponse"</span>) <span class="sc">+</span></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"test"</span> <span class="ot">=</span> egypt[<span class="dv">1</span>], <span class="st">"contr√¥le"</span> <span class="ot">=</span> egypt[<span class="dv">2</span>]),</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span>, <span class="st">"test"</span>),</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="st">"Contr√¥le"</span>, <span class="st">"test"</span> <span class="ot">=</span> <span class="st">"Test"</span>),</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"none"</span>,</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">override.aes =</span> <span class="fu">list</span>(</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="fu">c</span>(egypt[<span class="dv">2</span>], egypt[<span class="dv">1</span>]),</span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill   =</span> <span class="fu">c</span>(egypt[<span class="dv">2</span>], egypt[<span class="dv">1</span>]),</span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">slab_alpha =</span> <span class="dv">0</span>,</span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">linetype =</span> <span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), </span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))</span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(</span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>  p_ate_predictions_points, p_ate_predictions_bars,</span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="st">"v"</span>, </span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>  <span class="at">common.legend =</span> <span class="cn">TRUE</span>, </span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="st">"bottom"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot_lm2_simple" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot_lm2_simple-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="draft_files/figure-html/fig-plot_lm2_simple-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot_lm2_simple-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Un exemple de graphiques qui fonctionnes eux aussi, mais qui pourraient eux aussi √™tre am√©lior√©s. La barre repr√©sente l‚Äôintervalle de confiance √† 95 %, calcul√© √† partir d‚Äôerreurs robustes √† l‚Äôh√©t√©rosc√©dasticit√©.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Finalement, on pourrait aussi r√©aliser un graphique de l‚Äôeffet de traitement moyen.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Voir le code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_comparisons</span>(lm2, <span class="at">variables =</span> <span class="st">"groupe"</span>, <span class="at">vcov =</span> <span class="st">"HC3"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> term, <span class="at">y =</span> estimate) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high), <span class="at">width =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Effet de traitement moyen"</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Point et intervalles de confiance √† 95 %."</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"R√©ponse"</span>) <span class="sc">+</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot_lm2_ate" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot_lm2_ate-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="draft_files/figure-html/fig-plot_lm2_ate-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot_lm2_ate-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Exemple de graphique d‚Äôeffet de traitement moyen. Le point repr√©sente l‚Äôeffet de traitement moyen, la barre l‚Äôintervalle de confiance √† 95 %, calcul√© √† partir d‚Äôerreurs robustes √† l‚Äôh√©t√©rosc√©dasticit√©.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="repr√©senter-un-r√©sum√©-des-donn√©es-et-les-observations-1" class="level3">
<h3 class="anchored" data-anchor-id="repr√©senter-un-r√©sum√©-des-donn√©es-et-les-observations-1">Repr√©senter un r√©sum√© des donn√©es <em>et</em> les observations</h3>
<p>On retombe ici sur le probl√®me soulev√© au d√©part : alors que l‚Äôon a 1 000 observations, les <a href="#fig-plot_lm2_simple" class="quarto-xref">Figure&nbsp;4</a> et <a href="#fig-plot_lm2_ate" class="quarto-xref">Figure&nbsp;5</a> ne les r√©sument qu‚Äôen une seule information. On va d√©sormais r√©aliser deux graphiques diff√©rents, qui repr√©sentent les observations <em>et</em> le r√©sum√© des donn√©es. Mais les choses se compliquent, car les donn√©es n‚Äôexistent pas en tant que tel.</p>
<ul>
<li><strong>Un graphique des effets contrefactuels <em>individuels</em> </strong>. Pour cela, on va
<ul>
<li>Estimer <span class="math inline">\(\widehat{Y_i}\)</span>, pour un contrefactuel dans lequel l‚Äôensemble de l‚Äô√©chantillon serait <em>soit</em> dans le groupe test, <em>soit</em> dans le groupe contr√¥le. Dit autrement, on va doubler le jeu de donn√©es et (1) maintenir l‚Äôensemble des covariables constantes, (2) modifier le fait que l‚Äôobservation appartienne au groupe test ou contr√¥le √† covariables constantes, puis (3) estimer <span class="math inline">\(\widehat{Y_i}\)</span> selon que l‚Äôobservation soit dans un groupe test ou contr√¥le.</li>
<li>Estimer la moyenne de ces <span class="math inline">\(\widehat{Y_i}\)</span>, <em>par groupe</em> test ou contr√¥le, ainsi que les intervalles de confiance.</li>
<li>R√©aliser le graphique.</li>
</ul></li>
<li><strong>Un graphique des effets contrefactuels <em>moyens</em> </strong>. Pour cela, on va
<ul>
<li>Repartir des donn√©es g√©n√©r√©es pour le premier graphique.</li>
<li>Estimer la diff√©rence, <em>pour chaque observation</em>, selon qu‚Äôelle soit en groupe test ou contr√¥le.</li>
<li>Estimer la diff√©rence <em>moyenne</em> de ces diff√©rences et les intervalles de confiance.</li>
<li>R√©aliser le graphique.</li>
</ul></li>
</ul>
<p>Ca peut sembler √™tre beaucoup, mais c‚Äôest en r√©alit√© aujourd‚Äôhui (relativement) facilement faisable.</p>
<section id="estimer-widehaty_i" class="level4">
<h4 class="anchored" data-anchor-id="estimer-widehaty_i">Estimer <span class="math inline">\(\widehat{Y_i}\)</span></h4>
<p>La premi√®re √©tape consiste √† utiliser les coefficients estim√©s par le mod√®le lin√©aire de l‚Äô<a href="#eq-controle_interaction" class="quarto-xref">√âquation&nbsp;2</a> afin de pr√©dire, pour chaque observation, la valeur que prendrait la r√©ponse dans chacun des √©tats contrefactuels consid√©r√©s.</p>
<p>Pour le dire autrement, voici l‚Äô<a href="#eq-controle_interaction" class="quarto-xref">√âquation&nbsp;2</a>, int√©grant les coefficients estim√©s par r√©gression lin√©aire :</p>
<p><span id="eq-controle_interaction_estimee"><span class="math display">\[
\begin{aligned}
Y_i
= {} &amp; 64.62
+ 13.86 D_i
+ -25.23 G_i
+ -0.58 A_i \\
&amp; + -1.71 \, (D_i \times G_i)
+ 0.05 \, (D_i \times A_i)
+ \varepsilon_i
\end{aligned}
\tag{3}\]</span></span></p>
<p>A partir de ces coefficients, on peut, pour chaque observation, calculer ce que vaut <span class="math inline">\(\widehat{Y}_i\)</span>. Ainsi, pour une observation du groupe test (<span class="math inline">\(D_i = 1\)</span>), une fille (<span class="math inline">\(G_i = 0\)</span>), √¢g√©e de 35 ans (<span class="math inline">\(A_i = 35\)</span>), on obtient :</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{Y}_i
= {} &amp; 64.62
+ 13.86 \times 1
+ -25.23 \times 0
+ -0.58 \times 35 \\
&amp; + -1.71 \times (1 \times 0)
+ 0.05 \times (1 \times 35)
\end{aligned}
\]</span></p>
<p>soit :</p>
<p><span class="math display">\[
\widehat{Y}_i = 59.87
\]</span></p>
<p>On suit cette logique, pour l‚Äôensemble des observations, doubl√©es soit pour appartenir au groupe de test soit au groupe de contr√¥le.</p>
<div class="cell">
<details class="code-fold">
<summary>Voir le code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># D√©finir une grille contrefactuelle</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>counterfactual_datagrid_lm2 <span class="ot">=</span> <span class="fu">datagrid</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">groupe =</span> <span class="fu">c</span>(<span class="st">"test"</span>, <span class="st">"contr√¥le"</span>),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid_type =</span> <span class="st">"counterfactual"</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> df)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimer, pour cette nouvelle grille, ce que vaudrait Y_hat</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>df_hat <span class="ot">&lt;-</span> <span class="fu">predictions</span>(</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  lm2,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> counterfactual_datagrid_lm2)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="estimer-la-moyenne-de-ces-widehaty-par-groupe-selon-ce-contrefactuel" class="level4">
<h4 class="anchored" data-anchor-id="estimer-la-moyenne-de-ces-widehaty-par-groupe-selon-ce-contrefactuel">Estimer la moyenne de ces <span class="math inline">\(\widehat{Y}\)</span>, par groupe, selon ce contrefactuel</h4>
<p>Ici, on moyenne les pr√©dictions individuelles r√©alis√©es √† l‚Äô√©tape pr√©c√©dente.</p>
<div class="cell">
<details class="code-fold">
<summary>Voir le code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>avg_predictions_lm2 <span class="ot">&lt;-</span> <span class="fu">avg_predictions</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  lm2,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> counterfactual_datagrid_lm2,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="st">"groupe"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">vcov =</span> <span class="st">"HC3"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="estimer-la-diff√©rence-pour-chaque-personne-pour-ce-m√™me-contrefactuel." class="level4">
<h4 class="anchored" data-anchor-id="estimer-la-diff√©rence-pour-chaque-personne-pour-ce-m√™me-contrefactuel.">Estimer la diff√©rence, pour chaque personne, pour ce m√™me contrefactuel.</h4>
<p>Notre jeu de donn√©es contient 1 000 observations, et la grille contrefactuelle en contient donc 2 000 (chaque observation est d√©doubl√©e pour appartenir une fois au groupe test et une fois au groupe contr√¥le). Calculons, pour chaque observation, la diff√©rence entre chaque √©tat <em>√† covariables constantes</em>.</p>
<div class="cell">
<details class="code-fold">
<summary>Voir le code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>delta_i <span class="ot">&lt;-</span> df_hat <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(rowidcf, groupe, estimate) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> rowidcf, <span class="at">names_from =</span> groupe, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">contraste =</span> <span class="st">"Test - Contr√¥le"</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> test <span class="sc">-</span> contr√¥le)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="estimer-la-diff√©rence-moyenne" class="level4">
<h4 class="anchored" data-anchor-id="estimer-la-diff√©rence-moyenne">Estimer la diff√©rence moyenne</h4>
<p>On l‚Äôa d√©j√† faut plus haut pour l‚Äô<a href="#eq-controle_interaction" class="quarto-xref">√âquation&nbsp;2</a>. Je le refais ici, car on va l√©g√®rement modifier l‚Äôobjet pour l‚Äôint√©grer au sein du futur graphique.</p>
<div class="cell">
<details class="code-fold">
<summary>Voir le code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>delta_avg <span class="ot">&lt;-</span> <span class="fu">avg_comparisons</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  lm2,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> counterfactual_datagrid_lm2,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="st">"groupe"</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">vcov =</span> <span class="st">"HC3"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contraste =</span> <span class="st">"Test - Contr√¥le"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="repr√©senter-les-donn√©es" class="level4">
<h4 class="anchored" data-anchor-id="repr√©senter-les-donn√©es">Repr√©senter les donn√©es</h4>
<p>Je repr√©sente les donn√©es de deux fa√ßons :</p>
<ul>
<li>D‚Äôabord, les pr√©dictions pour le groupe test et le groupe contr√¥le, par observation.</li>
<li>Puis, les pr√©dictions pour l‚Äôeffet marginal estim√©, c‚Äôest-√†-dire la diff√©rence de pr√©diction entre le groupe test et contr√¥le, par observation.</li>
</ul>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Voir le code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> df_hat <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> groupe, <span class="at">y =</span> estimate)) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_slab</span>(</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill =</span> groupe),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale =</span> <span class="fl">0.45</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="cn">NA</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> <span class="fl">0.7</span>,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill =</span> groupe, <span class="at">shape =</span> groupe),</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">side =</span> <span class="st">"bottom"</span>,</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale =</span> <span class="fl">0.45</span>,</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_size =</span> <span class="fl">1.5</span>,</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> <span class="fl">0.7</span>,</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_interval =</span> mean_qi,</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="fl">1.1</span>,</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">slab_linewidth =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">data =</span> avg_predictions_lm2,</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">colour =</span> groupe), <span class="at">width =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"test"</span> <span class="ot">=</span> egypt[<span class="dv">1</span>], <span class="st">"contr√¥le"</span> <span class="ot">=</span> egypt[<span class="dv">2</span>]),</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span>, <span class="st">"test"</span>),</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="st">"Contr√¥le"</span>, <span class="st">"test"</span> <span class="ot">=</span> <span class="st">"Test"</span>)) <span class="sc">+</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"test"</span> <span class="ot">=</span> egypt[<span class="dv">1</span>], <span class="st">"contr√¥le"</span> <span class="ot">=</span> egypt[<span class="dv">2</span>]),</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span>, <span class="st">"test"</span>),</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="st">"Contr√¥le"</span>, <span class="st">"test"</span> <span class="ot">=</span> <span class="st">"Test"</span>),</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"test"</span> <span class="ot">=</span> <span class="dv">16</span>, <span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="dv">17</span>),</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span>, <span class="st">"test"</span>),</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="st">"Contr√¥le"</span>, <span class="st">"test"</span> <span class="ot">=</span> <span class="st">"Test"</span>)) <span class="sc">+</span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">100</span>), <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Effets contrefactuels individuels :&lt;br&gt;Groupes Test &amp; Contr√¥le"</span>,</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Distribution des effets pr√©dits."</span>,</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"≈∂"</span>) <span class="sc">+</span></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"none"</span>,</span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">override.aes =</span> <span class="fu">list</span>(</span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="fu">c</span>(egypt[<span class="dv">2</span>], egypt[<span class="dv">1</span>]),</span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill   =</span> <span class="fu">c</span>(egypt[<span class="dv">2</span>], egypt[<span class="dv">1</span>]),</span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">slab_alpha =</span> <span class="dv">0</span>,</span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">linetype =</span> <span class="dv">0</span>)))</span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> delta_i <span class="sc">%&gt;%</span></span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> contraste, <span class="at">y =</span> estimate)) <span class="sc">+</span></span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_slab</span>(</span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill =</span> contraste),</span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale =</span> <span class="fl">0.45</span>,</span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="cn">NA</span>,</span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> <span class="fl">0.7</span>,</span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(</span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill =</span> contraste),</span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">side =</span> <span class="st">"bottom"</span>,</span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale =</span> <span class="fl">0.45</span>,</span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_size =</span> <span class="dv">2</span>,</span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> <span class="fl">0.7</span>,</span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_interval =</span> mean_qi,</span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="fl">1.1</span>,</span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">slab_linewidth =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(</span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> delta_avg,</span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">colour =</span> contraste),</span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">0</span>,</span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-85"><a href="#cb12-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Test - Contr√¥le"</span> <span class="ot">=</span> egypt[<span class="dv">1</span>]), <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Effets contrefactuels individuel :&lt;br&gt;Œî Test - Contr√¥le"</span>,</span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Distribution des effets pr√©dits."</span>,</span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Œî ≈∂ (Test - Contr√¥le)"</span>) <span class="sc">+</span></span>
<span id="cb12-92"><a href="#cb12-92" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-93"><a href="#cb12-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="st">"none"</span>)</span>
<span id="cb12-94"><a href="#cb12-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-95"><a href="#cb12-95" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(</span>
<span id="cb12-96"><a href="#cb12-96" aria-hidden="true" tabindex="-1"></a>  p4, p5,</span>
<span id="cb12-97"><a href="#cb12-97" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="st">"v"</span>, </span>
<span id="cb12-98"><a href="#cb12-98" aria-hidden="true" tabindex="-1"></a>  <span class="at">common.legend =</span> <span class="cn">TRUE</span>, </span>
<span id="cb12-99"><a href="#cb12-99" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="st">"bottom"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-plot_lm2_hetero" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot_lm2_hetero-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="draft_files/figure-html/fig-plot_lm2_hetero-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot_lm2_hetero-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Un exemple de graphique qui repr√©sente l‚Äôh√©t√©rog√©n√©it√©, calcul√© √† partir des donn√©es estim√©es par r√©gression lin√©aire. Effets individuels et effet moyen obtenus √† partir du mod√®le lin√©aire. Erreur robuste √† l‚Äôh√©t√©rosc√©dasticit√©. La ligne color√©e correspond √† l‚Äôintervalle de confiance √† 95 %. Le segment noir le plus √©pais contient 66 % de la masse de la distribution, et le segment plus fin 95 %.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>L‚Äô<a href="#eq-controle_interaction" class="quarto-xref">√âquation&nbsp;2</a> a permis de retrouver le vrai effet moyen de l‚Äôintervention <span class="math inline">\(\beta\)</span> = 14.92. Cet effet moyen peut √™tre rapport√© de plusieurs fa√ßons :</p>
<ul>
<li>Sous la forme d‚Äôune table (cf. <a href="#tbl-lm2" class="quarto-xref">Table&nbsp;5</a>).</li>
<li>Sous la forme d‚Äôun graphique
<ul>
<li>Soit les moyennes marginales des groupes tests &amp; contr√¥le, via des points ou des barres, comme la <a href="#fig-plot_lm2_simple" class="quarto-xref">Figure&nbsp;4</a>.</li>
<li>Soit l‚Äôeffet de traitement moyen. C‚Äôest la <a href="#fig-plot_lm2_ate" class="quarto-xref">Figure&nbsp;5</a>.</li>
<li>Soit la distribution des effets contrefactuels <em>par groupe</em>. C‚Äôest-√†-dire, pour chaque observation et √† covariables constantes, <span class="math inline">\(\hat{Y_i}\)</span>. C‚Äôest le graphique de gauche de la <a href="#fig-plot_lm2_hetero" class="quarto-xref">Figure&nbsp;6</a>.</li>
<li>Soit la distribution des effets contrefactuels <em>individuels</em>. C‚Äôest le graphique de droite de la <a href="#fig-plot_lm2_hetero" class="quarto-xref">Figure&nbsp;6</a>. C‚Äôest-√†-dire, pour chaque observation et √† covariables constantes, la diff√©rence <span class="math inline">\(\hat{Y_i}(\text{test}) - \hat{Y_i}(\text{contr√¥le})\)</span>.</li>
</ul></li>
</ul>
<p>Au-del√† des aspects techniques, une question demeure pour ma part : est-ce coh√©rent de repr√©senter des quantit√©s contrefactuelles <em>√† la maille individuelle</em> ? Si l‚Äôeffet de traitement moyen est non-biais√©</p>
</section>
<section id="r√©f√©rences" class="level1">



<!-- -->


</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">R√©f√©rences</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-berge_2018" class="csl-entry" role="listitem">
Berg√©, L. (2018). Efficient estimation of maximum likelihood models with multiple fixed-effects: the <span>R</span> package <span>FENmlm</span>. <em>CREA Discussion Papers</em>, <em>13</em>.
</div>
<div id="ref-CinelliForneyPearl2022" class="csl-entry" role="listitem">
Cinelli, C., Forney, A., &amp; Pearl, J. (2022). A Crash Course in Good and Bad Controls. <em>Sociological Methods &amp; Research</em>, <em>53</em>(3). <a href="https://doi.org/10.1177/00491241221099552">https://doi.org/10.1177/00491241221099552</a>
</div>
<div id="ref-kay_ggdist" class="csl-entry" role="listitem">
Kay, M. (2024). <span>ggdist</span>: Visualizations of Distributions and Uncertainty in the Grammar of Graphics. <em>IEEE Transactions on Visualization and Computer Graphics</em>, <em>30</em>(1), 414‚Äë424. <a href="https://doi.org/10.1109/TVCG.2023.3327195">https://doi.org/10.1109/TVCG.2023.3327195</a>
</div>
<div id="ref-WestreichGreenland2013" class="csl-entry" role="listitem">
Westreich, D., &amp; Greenland, S. (2013). The Table 2 Fallacy: Presenting and Interpreting Confounder and Modifier Coefficients. <em>American Journal of Epidemiology</em>, <em>177</em>(4), 292‚Äë298. <a href="https://doi.org/10.1093/aje/kws412">https://doi.org/10.1093/aje/kws412</a>
</div>
<div id="ref-Zeileis2004" class="csl-entry" role="listitem">
Zeileis, A. (2004). Econometric Computing with <span>HC</span> and <span>HAC</span> Covariance Matrix Estimators. <em>Journal of Statistical Software</em>, <em>11</em>(10), 1‚Äë17. <a href="https://doi.org/10.18637/jss.v011.i10">https://doi.org/10.18637/jss.v011.i10</a>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Notes de bas de page</h2>

<ol>
<li id="fn1"><p>Par contre, je n‚Äôai toujours pas r√©ussi √† d√©cider si c‚Äôest pertinent. C‚Äôest peut-√™tre un signe que √ßa ne l‚Äôest pas‚Ä¶<a href="#fnref1" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn2"><p>Un mod√®le lin√©aire √† un ou deux param√®tres, estim√© √† partir des moindres carr√©s ordinaires, renvoie des moyennes descriptives.<a href="#fnref2" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copi√©");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copi√©");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/charlymarie\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Code source</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb13" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Repr√©senter des distributions marginales contrefactuelles"</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 05-03-2026</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> ["R", "Graphiques", "Mod√®le lin√©aire", "marginaleffects"]</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="an">tags:</span><span class="co"> ["Technique", "R"]</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Pour un r√©cent projet sur lequel je suis impliqu√©, je me suis demand√© s'il n'√©tait pas possible de *mieux* repr√©senter les r√©sultats issus de mod√®les lin√©aires que le classique point + intervalles de confiance ou barres + intervalles de confiance. Ce post est une sorte de compte-rendu / pense-b√™te / notes-pour-le-moi-du-futur de mes r√©flexions et avanc√©es techniques."</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="an">lang:</span><span class="co"> fr</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="an">body-classes:</span><span class="co"> indent-paragraphs</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="an">draft:</span><span class="co"> true</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "Voir le code"</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: wrap</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co">    code-block-bg: true</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co">  error: false</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>&lt;hr style="border:1px solid blue" /&gt;</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="fu"># R√©sum√©</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="fu"># Point de d√©part</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>En psychologie, en √©conomie, en biologie, etc... nous analysons des donn√©es d'exp√©rimentations, que nous communiquons ensuite au sein de papiers, de chapitres, ou encore de conf√©rences. Nous analysons le plus souvent ces donn√©es via des mod√®les lin√©aires, et nous rapportons ensuite un joli test ou une jolie r√©gression (#NoKinkShaming). Les plus habiles d'entre nous vont jusqu'√† rapporter un (joli) graphique des r√©sultats et renvoyer la (jolie) table de r√©gression en annexe.</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>Deux cas de figure peuvent appara√Ætre.</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**On se contente de rapporter des points, souvent des moyennes, avec parfois un intervalle de confiance**</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Si le test n'est qu'une comparaison de moyennes, ces graphiques repr√©sentent des statistiques descriptives.</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Si le test est une comparaison de moyennes *ajust√©es*, par exemple en sortie de r√©gression multiple, les graphiques sont un poil plus complexes √† r√©aliser, mais cela reste largement faisable avec la plupart des logiciels d'aujourd'hui.</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**On souhaite √©galement rapporter la distribution des donn√©es**</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>A nouveau, si l'on travaille √† partir de deux variables, il est simple de repr√©senter les donn√©es sous-jacentes et leur r√©sum√©.</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Cependant, d√®s lors que l‚Äôon raisonne √† partir d‚Äôune r√©gression en logique *toutes choses √©gales par ailleurs*, la repr√©sentation graphique se complique : les quantit√©s d‚Äôint√©r√™t ne sont plus les observations brutes, mais des pr√©dictions d√©riv√©es du mod√®le *pour une grille de pr√©dicteurs*.</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>Pourquoi vouloir s'emb√™ter √† repr√©senter l'ensemble de la distribution? Car les graphiques en points / en barres sont limit√©s, en ce qu'ils r√©sument l'ensemble des donn√©es au seul param√®tre de la moyenne (cf. par exemple ce <span class="co">[</span><span class="ot">#TidyTuesday</span><span class="co">](https://www.linkedin.com/posts/nicola-rennie_tidytuesday-rstats-dataviz-share-7404110322237669376-iRsT/)</span>{target="_blank"}). Les meilleures pratiques sont plut√¥t de repr√©senter (1) les donn√©es et (2) un r√©sum√© des donn√©es. Ce post de blog est une sorte de notes-pour-plus-tard-et-√†-moi-m√™me pour *visualiser ces pr√©dictions individuelles moyennes, avec un r√©sum√© des donn√©es*. Il se trouve que c‚Äôest faisable avec un peu d'huile de coude^<span class="co">[</span><span class="ot">Par contre, je n'ai toujours pas r√©ussi √† d√©cider si c'est pertinent. C'est peut-√™tre un signe que √ßa ne l'est pas...</span><span class="co">]</span>.</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a><span class="fu"># Pr√©parer l'environnement</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>Je commence par charger les packages, par d√©finir un th√®me <span class="in">`ggplot2()`</span>, et par simuler des donn√©es assez simples. L'avantage de les simuler, c'est que l'on peut sp√©cifier la *vraie* valeur qu'un param√®tre doit renvoyer : </span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a><span class="do">#### Charger les packages ####</span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse); <span class="fu">library</span>(ggpubr); <span class="fu">library</span>(ggtext); <span class="fu">library</span>(modelsummary)</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(easystats); <span class="fu">library</span>(broom); <span class="fu">library</span>(gt); <span class="fu">library</span>(ggdag); <span class="fu">library</span>(labelled); <span class="fu">library</span>(marginaleffects); <span class="fu">library</span>(ggdist); <span class="fu">library</span>(gtsummary)</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_gtsummary_language</span>(<span class="st">"fr"</span>)</span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a><span class="do">#### D√©finir une seed, pour des r√©sultats reproductibles ####</span></span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>seed <span class="ot">=</span> <span class="dv">891</span></span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(seed)</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a><span class="do">#### Construire un th√®me ggplot() personnalis√© ####</span></span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Quasi enti√®rement copi√© d'Andrew Heiss: https://www.andrewheiss.com/blog/2021/12/20/fully-bayesian-ate-iptw/</span></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Avec l'aide de Nicolas Rennie: https://nrennie.rbind.io/art-of-viz/programming-languages.html</span></span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>egypt <span class="ot">&lt;-</span> MetBrewer<span class="sc">::</span><span class="fu">met.brewer</span>(<span class="st">"Egypt"</span>)</span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>theme_nice <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Times"</span>) <span class="sc">+</span></span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_textbox_simple</span>(<span class="at">lineheight =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_textbox_simple</span>(<span class="at">lineheight =</span> <span class="fl">0.5</span>),</span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_textbox_simple</span>(<span class="at">lineheight =</span> <span class="fl">0.5</span>),</span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">0.8</span>), <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey80"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title=</span><span class="fu">element_blank</span>(),</span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Rien en X</span></span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks.x=</span><span class="fu">element_blank</span>())</span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a><span class="co"># Faire de ce th√®me le th√®me par d√©faut</span></span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_nice</span>())</span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a><span class="do">#### G√©n√©rer des donn√©es ####</span></span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Genre ~ 50/50</span></span>
<span id="cb13-91"><a href="#cb13-91" aria-hidden="true" tabindex="-1"></a>genre <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.5</span>)  <span class="co"># 1 = Gar√ßon, 0 = Fille</span></span>
<span id="cb13-92"><a href="#cb13-92" aria-hidden="true" tabindex="-1"></a>genre <span class="ot">&lt;-</span> <span class="fu">factor</span>(genre, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Fille"</span>, <span class="st">"Gar√ßon"</span>))</span>
<span id="cb13-93"><a href="#cb13-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-94"><a href="#cb13-94" aria-hidden="true" tabindex="-1"></a><span class="co"># √Çge : 18 √† 70, d√©pendant du genre</span></span>
<span id="cb13-95"><a href="#cb13-95" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb13-96"><a href="#cb13-96" aria-hidden="true" tabindex="-1"></a>  genre <span class="sc">==</span> <span class="st">"Gar√ßon"</span>,</span>
<span id="cb13-97"><a href="#cb13-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">runif</span>(n, <span class="dv">30</span>, <span class="dv">70</span>),  <span class="co"># Gar√ßons plus √¢g√©s en moyenne</span></span>
<span id="cb13-98"><a href="#cb13-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">runif</span>(n, <span class="dv">18</span>, <span class="dv">50</span>))   <span class="co"># Filles plus jeunes en moyenne</span></span>
<span id="cb13-99"><a href="#cb13-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-100"><a href="#cb13-100" aria-hidden="true" tabindex="-1"></a><span class="co"># Groupe : d√©pend du genre et donc indirectement √©galement de l‚Äô√¢ge</span></span>
<span id="cb13-101"><a href="#cb13-101" aria-hidden="true" tabindex="-1"></a>groupe_num <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb13-102"><a href="#cb13-102" aria-hidden="true" tabindex="-1"></a>  genre <span class="sc">==</span> <span class="st">"Gar√ßon"</span>,</span>
<span id="cb13-103"><a href="#cb13-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.8</span>),</span>
<span id="cb13-104"><a href="#cb13-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.2</span>))</span>
<span id="cb13-105"><a href="#cb13-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-106"><a href="#cb13-106" aria-hidden="true" tabindex="-1"></a>groupe <span class="ot">&lt;-</span> <span class="fu">factor</span>(groupe_num, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span>, <span class="st">"test"</span>))</span>
<span id="cb13-107"><a href="#cb13-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-108"><a href="#cb13-108" aria-hidden="true" tabindex="-1"></a><span class="do">#### G√©n√©ration de la r√©ponse ####</span></span>
<span id="cb13-109"><a href="#cb13-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-110"><a href="#cb13-110" aria-hidden="true" tabindex="-1"></a><span class="co"># Effets structurels</span></span>
<span id="cb13-111"><a href="#cb13-111" aria-hidden="true" tabindex="-1"></a>beta_groupe <span class="ot">&lt;-</span> <span class="dv">15</span>   <span class="co"># effet vrai</span></span>
<span id="cb13-112"><a href="#cb13-112" aria-hidden="true" tabindex="-1"></a>beta_fille <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb13-113"><a href="#cb13-113" aria-hidden="true" tabindex="-1"></a>beta_age <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.6</span> <span class="co"># √¢ge d√©favorisant, corr√©l√© au groupe</span></span>
<span id="cb13-114"><a href="#cb13-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-115"><a href="#cb13-115" aria-hidden="true" tabindex="-1"></a>reponse <span class="ot">&lt;-</span> <span class="dv">40</span> <span class="sc">+</span></span>
<span id="cb13-116"><a href="#cb13-116" aria-hidden="true" tabindex="-1"></a>  beta_groupe <span class="sc">*</span> (groupe <span class="sc">==</span> <span class="st">"test"</span>) <span class="sc">+</span></span>
<span id="cb13-117"><a href="#cb13-117" aria-hidden="true" tabindex="-1"></a>  beta_fille <span class="sc">*</span> (genre <span class="sc">==</span> <span class="st">"Fille"</span>) <span class="sc">+</span></span>
<span id="cb13-118"><a href="#cb13-118" aria-hidden="true" tabindex="-1"></a>  beta_age <span class="sc">*</span> age <span class="sc">+</span></span>
<span id="cb13-119"><a href="#cb13-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">8</span>)</span>
<span id="cb13-120"><a href="#cb13-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-121"><a href="#cb13-121" aria-hidden="true" tabindex="-1"></a><span class="co"># Contraindre la r√©ponse entre 0 et 100</span></span>
<span id="cb13-122"><a href="#cb13-122" aria-hidden="true" tabindex="-1"></a>reponse <span class="ot">&lt;-</span> <span class="fu">pmin</span>(<span class="fu">pmax</span>(reponse, <span class="dv">0</span>), <span class="dv">100</span>)</span>
<span id="cb13-123"><a href="#cb13-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-124"><a href="#cb13-124" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb13-125"><a href="#cb13-125" aria-hidden="true" tabindex="-1"></a>  <span class="at">reponse =</span> reponse,</span>
<span id="cb13-126"><a href="#cb13-126" aria-hidden="true" tabindex="-1"></a>  <span class="at">groupe  =</span> groupe,</span>
<span id="cb13-127"><a href="#cb13-127" aria-hidden="true" tabindex="-1"></a>  <span class="at">genre   =</span> genre,</span>
<span id="cb13-128"><a href="#cb13-128" aria-hidden="true" tabindex="-1"></a>  <span class="at">age     =</span> <span class="fu">round</span>(age, <span class="dv">0</span>))</span>
<span id="cb13-129"><a href="#cb13-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-130"><a href="#cb13-130" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(df) <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb13-131"><a href="#cb13-131" aria-hidden="true" tabindex="-1"></a>  <span class="at">genre   =</span> <span class="st">"Genre"</span>,</span>
<span id="cb13-132"><a href="#cb13-132" aria-hidden="true" tabindex="-1"></a>  <span class="at">age     =</span> <span class="st">"√Çge"</span>,</span>
<span id="cb13-133"><a href="#cb13-133" aria-hidden="true" tabindex="-1"></a>  <span class="at">reponse =</span> <span class="st">"R√©ponse"</span>,</span>
<span id="cb13-134"><a href="#cb13-134" aria-hidden="true" tabindex="-1"></a>  <span class="at">groupe  =</span> <span class="st">"Groupe"</span>)</span>
<span id="cb13-135"><a href="#cb13-135" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb13-136"><a href="#cb13-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-137"><a href="#cb13-137" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Une variable <span class="in">`r√©ponse`</span> continue, qui peut prendre de 0 √† 100. Cette variable pourrait √™tre (presque) n'importe quoi : l'estime de soi, la confiance en soi, la sant√©, le sentiment de comp√©tence √† l'√©cole...</span>
<span id="cb13-138"><a href="#cb13-138" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Une variable <span class="in">`groupe`</span>, qui encode une manipulation que l'on a r√©alis√©e. Cela peut √™tre en laboratoire, dans une √©cole, via Qualtrics... √† nouveau, qu'importe. Le vrai effet de cette variable est $\beta$ = 15.</span>
<span id="cb13-139"><a href="#cb13-139" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Une variable <span class="in">`genre`</span> binaire (d√©sol√© pour les personnes au-milieu ou en-dehors du genre, c'est pour simplifier).</span>
<span id="cb13-140"><a href="#cb13-140" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Une variable <span class="in">`age`</span> continue.</span>
<span id="cb13-141"><a href="#cb13-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-142"><a href="#cb13-142" aria-hidden="true" tabindex="-1"></a>Regardons ce que cela donne : </span>
<span id="cb13-143"><a href="#cb13-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-144"><a href="#cb13-144" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE}</span></span>
<span id="cb13-145"><a href="#cb13-145" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: tbl-descriptive0</span></span>
<span id="cb13-146"><a href="#cb13-146" aria-hidden="true" tabindex="-1"></a><span class="in">#| tbl-cap: "Description des donn√©es simul√©es."</span></span>
<span id="cb13-147"><a href="#cb13-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-148"><a href="#cb13-148" aria-hidden="true" tabindex="-1"></a><span class="in">datasummary_skim(df, output = "html")</span></span>
<span id="cb13-149"><a href="#cb13-149" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb13-150"><a href="#cb13-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-151"><a href="#cb13-151" aria-hidden="true" tabindex="-1"></a>Cependant, pour une raison qui nous est inconnue, l'allocation al√©atoire n'a pas bien fonctionn√© (c'est bien la tuile !), et les donn√©es collect√©es d√©pendent *tr√®s* largement du genre et de l'√¢ge des personnes :</span>
<span id="cb13-152"><a href="#cb13-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-153"><a href="#cb13-153" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE}</span></span>
<span id="cb13-154"><a href="#cb13-154" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: tbl-descriptive1</span></span>
<span id="cb13-155"><a href="#cb13-155" aria-hidden="true" tabindex="-1"></a><span class="in">#| tbl-cap: "Description des donn√©es simul√©es, par genre et par √¢ge."</span></span>
<span id="cb13-156"><a href="#cb13-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-157"><a href="#cb13-157" aria-hidden="true" tabindex="-1"></a><span class="in">df %&gt;%</span></span>
<span id="cb13-158"><a href="#cb13-158" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb13-159"><a href="#cb13-159" aria-hidden="true" tabindex="-1"></a><span class="in">    age_cat = cut(</span></span>
<span id="cb13-160"><a href="#cb13-160" aria-hidden="true" tabindex="-1"></a><span class="in">      age,</span></span>
<span id="cb13-161"><a href="#cb13-161" aria-hidden="true" tabindex="-1"></a><span class="in">      breaks = c(floor(min(age)), 25, 40, 55, ceiling(max(age))),</span></span>
<span id="cb13-162"><a href="#cb13-162" aria-hidden="true" tabindex="-1"></a><span class="in">      include.lowest = TRUE),</span></span>
<span id="cb13-163"><a href="#cb13-163" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb13-164"><a href="#cb13-164" aria-hidden="true" tabindex="-1"></a><span class="in">    age_cat = fct_relevel(</span></span>
<span id="cb13-165"><a href="#cb13-165" aria-hidden="true" tabindex="-1"></a><span class="in">      age_cat,</span></span>
<span id="cb13-166"><a href="#cb13-166" aria-hidden="true" tabindex="-1"></a><span class="in">      "[18,25]",</span></span>
<span id="cb13-167"><a href="#cb13-167" aria-hidden="true" tabindex="-1"></a><span class="in">      "(25,40]",</span></span>
<span id="cb13-168"><a href="#cb13-168" aria-hidden="true" tabindex="-1"></a><span class="in">      "(40,55]",</span></span>
<span id="cb13-169"><a href="#cb13-169" aria-hidden="true" tabindex="-1"></a><span class="in">      "(55,70]")) %&gt;% </span></span>
<span id="cb13-170"><a href="#cb13-170" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb13-171"><a href="#cb13-171" aria-hidden="true" tabindex="-1"></a><span class="in">  tbl_strata(</span></span>
<span id="cb13-172"><a href="#cb13-172" aria-hidden="true" tabindex="-1"></a><span class="in">    strata = genre,</span></span>
<span id="cb13-173"><a href="#cb13-173" aria-hidden="true" tabindex="-1"></a><span class="in">    .tbl_fun = ~ .x %&gt;%</span></span>
<span id="cb13-174"><a href="#cb13-174" aria-hidden="true" tabindex="-1"></a><span class="in">      tbl_summary(</span></span>
<span id="cb13-175"><a href="#cb13-175" aria-hidden="true" tabindex="-1"></a><span class="in">        by = age_cat,</span></span>
<span id="cb13-176"><a href="#cb13-176" aria-hidden="true" tabindex="-1"></a><span class="in">        include = reponse,</span></span>
<span id="cb13-177"><a href="#cb13-177" aria-hidden="true" tabindex="-1"></a><span class="in">        statistic = all_continuous() ~ "{mean} ({sd})",</span></span>
<span id="cb13-178"><a href="#cb13-178" aria-hidden="true" tabindex="-1"></a><span class="in">        digits = all_continuous() ~ 2)) %&gt;%</span></span>
<span id="cb13-179"><a href="#cb13-179" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb13-180"><a href="#cb13-180" aria-hidden="true" tabindex="-1"></a><span class="in">  modify_table_body(</span></span>
<span id="cb13-181"><a href="#cb13-181" aria-hidden="true" tabindex="-1"></a><span class="in">    ~ .x %&gt;%</span></span>
<span id="cb13-182"><a href="#cb13-182" aria-hidden="true" tabindex="-1"></a><span class="in">      mutate(</span></span>
<span id="cb13-183"><a href="#cb13-183" aria-hidden="true" tabindex="-1"></a><span class="in">        across(</span></span>
<span id="cb13-184"><a href="#cb13-184" aria-hidden="true" tabindex="-1"></a><span class="in">          where(is.character),</span></span>
<span id="cb13-185"><a href="#cb13-185" aria-hidden="true" tabindex="-1"></a><span class="in">          ~ ifelse(.x == "NA (NA)", "", .x)))) %&gt;%</span></span>
<span id="cb13-186"><a href="#cb13-186" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb13-187"><a href="#cb13-187" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb13-188"><a href="#cb13-188" aria-hidden="true" tabindex="-1"></a><span class="in">  modify_header(label = "")</span></span>
<span id="cb13-189"><a href="#cb13-189" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb13-190"><a href="#cb13-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-191"><a href="#cb13-191" aria-hidden="true" tabindex="-1"></a>Or, mettons que le genre et l'√¢ge influencent √©galement la r√©ponse. On se retrouve dans le cadre classique d'une variable dite *confondante*, au sens o√π elle influence √† la fois le pr√©dicteur et la r√©ponse <span class="co">[</span><span class="ot">@CinelliForneyPearl2022</span><span class="co">]</span>, et biaise donc le v√©ritable effet causal. Le graphe acyclique dirig√©, du genre que l'on aimerait toujours aussi simple, est repr√©sent√© en @fig-plot_dag :</span>
<span id="cb13-192"><a href="#cb13-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-193"><a href="#cb13-193" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE}</span></span>
<span id="cb13-194"><a href="#cb13-194" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-plot_dag</span></span>
<span id="cb13-195"><a href="#cb13-195" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Graphe acyclique dirig√© du processus de g√©n√©ration des donn√©es."</span></span>
<span id="cb13-196"><a href="#cb13-196" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: "80%"</span></span>
<span id="cb13-197"><a href="#cb13-197" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-align: "center"</span></span>
<span id="cb13-198"><a href="#cb13-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-199"><a href="#cb13-199" aria-hidden="true" tabindex="-1"></a><span class="in">dagify(</span></span>
<span id="cb13-200"><a href="#cb13-200" aria-hidden="true" tabindex="-1"></a><span class="in">  Reponse ~ Groupe + Genre + Age,</span></span>
<span id="cb13-201"><a href="#cb13-201" aria-hidden="true" tabindex="-1"></a><span class="in">  Groupe  ~ Genre + Age,</span></span>
<span id="cb13-202"><a href="#cb13-202" aria-hidden="true" tabindex="-1"></a><span class="in">  exposure = "Groupe",</span></span>
<span id="cb13-203"><a href="#cb13-203" aria-hidden="true" tabindex="-1"></a><span class="in">  outcome  = "Reponse",</span></span>
<span id="cb13-204"><a href="#cb13-204" aria-hidden="true" tabindex="-1"></a><span class="in">  coords = list(</span></span>
<span id="cb13-205"><a href="#cb13-205" aria-hidden="true" tabindex="-1"></a><span class="in">    x = c(Groupe = 1, Genre = 2, Age = 2, Reponse = 3),</span></span>
<span id="cb13-206"><a href="#cb13-206" aria-hidden="true" tabindex="-1"></a><span class="in">    y = c(Groupe = 1, Genre = 2, Age = 0, Reponse = 1))) %&gt;%</span></span>
<span id="cb13-207"><a href="#cb13-207" aria-hidden="true" tabindex="-1"></a><span class="in">  tidy_dagitty() %&gt;%</span></span>
<span id="cb13-208"><a href="#cb13-208" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(ggplot2::aes(x = x, y = y, xend = xend, yend = yend)) +</span></span>
<span id="cb13-209"><a href="#cb13-209" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_dag_point(size = 26) +</span></span>
<span id="cb13-210"><a href="#cb13-210" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_dag_edges(</span></span>
<span id="cb13-211"><a href="#cb13-211" aria-hidden="true" tabindex="-1"></a><span class="in">    start_cap = ggraph::circle(12, "mm"),</span></span>
<span id="cb13-212"><a href="#cb13-212" aria-hidden="true" tabindex="-1"></a><span class="in">    end_cap   = ggraph::circle(12, "mm")) +</span></span>
<span id="cb13-213"><a href="#cb13-213" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_dag_text(colour = "white") +</span></span>
<span id="cb13-214"><a href="#cb13-214" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_dag()</span></span>
<span id="cb13-215"><a href="#cb13-215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb13-216"><a href="#cb13-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-217"><a href="#cb13-217" aria-hidden="true" tabindex="-1"></a><span class="fu"># Estimer la diff√©rence entre les groupes</span></span>
<span id="cb13-218"><a href="#cb13-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-219"><a href="#cb13-219" aria-hidden="true" tabindex="-1"></a>Dans notre √©chantillon, l'effet d'un c√¥t√© du genre &amp; de l'√¢ge et de l'autre du groupe se compensent, de sorte que la diff√©rence moyenne observ√©e entre le groupe test et le groupe contr√¥le est fausse. En cons√©quence, ajuster le mod√®le lin√©aire suivant renvoie un coefficient $\beta$ biais√© :</span>
<span id="cb13-220"><a href="#cb13-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-221"><a href="#cb13-221" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb13-222"><a href="#cb13-222" aria-hidden="true" tabindex="-1"></a>Y_i = \alpha + \beta D_i + \varepsilon_i</span>
<span id="cb13-223"><a href="#cb13-223" aria-hidden="true" tabindex="-1"></a>$$ {#eq-simple}</span>
<span id="cb13-224"><a href="#cb13-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-225"><a href="#cb13-225" aria-hidden="true" tabindex="-1"></a>o√π :</span>
<span id="cb13-226"><a href="#cb13-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-227"><a href="#cb13-227" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$D_i$ est une variable indicatrice telle que $D_i = 1$ si l‚Äôindividu $i$ appartient au groupe *test* et $D_i = 0$ s‚Äôil appartient au groupe *contr√¥le*</span>
<span id="cb13-228"><a href="#cb13-228" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\beta$ repr√©sente la diff√©rence moyenne de $Y$ entre le groupe test et le groupe contr√¥le</span>
<span id="cb13-229"><a href="#cb13-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-230"><a href="#cb13-230" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE}</span></span>
<span id="cb13-231"><a href="#cb13-231" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: tbl-lm1</span></span>
<span id="cb13-232"><a href="#cb13-232" aria-hidden="true" tabindex="-1"></a><span class="in">#| tbl-cap: "R√©gression de la R√©ponse par le Groupe."</span></span>
<span id="cb13-233"><a href="#cb13-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-234"><a href="#cb13-234" aria-hidden="true" tabindex="-1"></a><span class="in">summary_lm &lt;- function(model, vcov = NULL) {</span></span>
<span id="cb13-235"><a href="#cb13-235" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb13-236"><a href="#cb13-236" aria-hidden="true" tabindex="-1"></a><span class="in">  # Extraire les param√®tres non standardis√©s</span></span>
<span id="cb13-237"><a href="#cb13-237" aria-hidden="true" tabindex="-1"></a><span class="in">  mp &lt;- parameters::model_parameters(model,</span></span>
<span id="cb13-238"><a href="#cb13-238" aria-hidden="true" tabindex="-1"></a><span class="in">                                     vcov = vcov,</span></span>
<span id="cb13-239"><a href="#cb13-239" aria-hidden="true" tabindex="-1"></a><span class="in">                                     use_labels = TRUE)</span></span>
<span id="cb13-240"><a href="#cb13-240" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb13-241"><a href="#cb13-241" aria-hidden="true" tabindex="-1"></a><span class="in">  # Extraire les param√®tres standardis√©s (refit)</span></span>
<span id="cb13-242"><a href="#cb13-242" aria-hidden="true" tabindex="-1"></a><span class="in">  mp_std &lt;- dplyr::select(parameters::model_parameters(model,</span></span>
<span id="cb13-243"><a href="#cb13-243" aria-hidden="true" tabindex="-1"></a><span class="in">                                                       standardize = "refit",</span></span>
<span id="cb13-244"><a href="#cb13-244" aria-hidden="true" tabindex="-1"></a><span class="in">                                                       vcov = vcov,</span></span>
<span id="cb13-245"><a href="#cb13-245" aria-hidden="true" tabindex="-1"></a><span class="in">                                                       use_labels = TRUE),</span></span>
<span id="cb13-246"><a href="#cb13-246" aria-hidden="true" tabindex="-1"></a><span class="in">                          </span></span>
<span id="cb13-247"><a href="#cb13-247" aria-hidden="true" tabindex="-1"></a><span class="in">                          Parameter,</span></span>
<span id="cb13-248"><a href="#cb13-248" aria-hidden="true" tabindex="-1"></a><span class="in">                          Std_Coefficient = Coefficient,</span></span>
<span id="cb13-249"><a href="#cb13-249" aria-hidden="true" tabindex="-1"></a><span class="in">                          Std_CI_low = CI_low,</span></span>
<span id="cb13-250"><a href="#cb13-250" aria-hidden="true" tabindex="-1"></a><span class="in">                          Std_CI_high = CI_high)</span></span>
<span id="cb13-251"><a href="#cb13-251" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb13-252"><a href="#cb13-252" aria-hidden="true" tabindex="-1"></a><span class="in">  mp &lt;- dplyr::left_join(mp, mp_std, by = "Parameter")</span></span>
<span id="cb13-253"><a href="#cb13-253" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb13-254"><a href="#cb13-254" aria-hidden="true" tabindex="-1"></a><span class="in">  # Preparer les donn√©es</span></span>
<span id="cb13-255"><a href="#cb13-255" aria-hidden="true" tabindex="-1"></a><span class="in">  mp &lt;- dplyr::mutate(mp,</span></span>
<span id="cb13-256"><a href="#cb13-256" aria-hidden="true" tabindex="-1"></a><span class="in">                      </span></span>
<span id="cb13-257"><a href="#cb13-257" aria-hidden="true" tabindex="-1"></a><span class="in">                      # Arrondir p √† trois d√©cimales</span></span>
<span id="cb13-258"><a href="#cb13-258" aria-hidden="true" tabindex="-1"></a><span class="in">                      p = ifelse(p &lt; .001, "&lt; .001", round(p, 3)),</span></span>
<span id="cb13-259"><a href="#cb13-259" aria-hidden="true" tabindex="-1"></a><span class="in">                      </span></span>
<span id="cb13-260"><a href="#cb13-260" aria-hidden="true" tabindex="-1"></a><span class="in">                      # Arrondir les autres valeurs √† deux d√©cimales</span></span>
<span id="cb13-261"><a href="#cb13-261" aria-hidden="true" tabindex="-1"></a><span class="in">                      dplyr::across(dplyr::where(is.numeric), ~ round(.x, 2)),</span></span>
<span id="cb13-262"><a href="#cb13-262" aria-hidden="true" tabindex="-1"></a><span class="in">                      </span></span>
<span id="cb13-263"><a href="#cb13-263" aria-hidden="true" tabindex="-1"></a><span class="in">                      # R√©unir l'intervalle de confiance et le placer sous le Coefficient</span></span>
<span id="cb13-264"><a href="#cb13-264" aria-hidden="true" tabindex="-1"></a><span class="in">                      Coefficient = paste0(Coefficient, "&lt;br&gt;", "[", CI_low, "; ", CI_high, "]"),</span></span>
<span id="cb13-265"><a href="#cb13-265" aria-hidden="true" tabindex="-1"></a><span class="in">                      </span></span>
<span id="cb13-266"><a href="#cb13-266" aria-hidden="true" tabindex="-1"></a><span class="in">                      # R√©unir l'intervalle de confiance et le placer sous Œ≤</span></span>
<span id="cb13-267"><a href="#cb13-267" aria-hidden="true" tabindex="-1"></a><span class="in">                      Œ≤ = paste0(Std_Coefficient, "&lt;br&gt;", "[", Std_CI_low, "; ", Std_CI_high, "]"))</span></span>
<span id="cb13-268"><a href="#cb13-268" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb13-269"><a href="#cb13-269" aria-hidden="true" tabindex="-1"></a><span class="in">  # Renommer les colonnes : les colonnes avec un nom simple</span></span>
<span id="cb13-270"><a href="#cb13-270" aria-hidden="true" tabindex="-1"></a><span class="in">  mp &lt;- dplyr::rename(mp,</span></span>
<span id="cb13-271"><a href="#cb13-271" aria-hidden="true" tabindex="-1"></a><span class="in">                      Param√®tre = Parameter,</span></span>
<span id="cb13-272"><a href="#cb13-272" aria-hidden="true" tabindex="-1"></a><span class="in">                      Estimation = Coefficient,</span></span>
<span id="cb13-273"><a href="#cb13-273" aria-hidden="true" tabindex="-1"></a><span class="in">                      "Erreur standard" = SE,</span></span>
<span id="cb13-274"><a href="#cb13-274" aria-hidden="true" tabindex="-1"></a><span class="in">                      p = p)</span></span>
<span id="cb13-275"><a href="#cb13-275" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb13-276"><a href="#cb13-276" aria-hidden="true" tabindex="-1"></a><span class="in">  # Renommer les colonnes : la colonne t est un peu plus complexe, car je souhaite y int√©grer le nombre de degr√©s de libert√© de la statistique</span></span>
<span id="cb13-277"><a href="#cb13-277" aria-hidden="true" tabindex="-1"></a><span class="in">  mp &lt;- dplyr::rename_with(mp,</span></span>
<span id="cb13-278"><a href="#cb13-278" aria-hidden="true" tabindex="-1"></a><span class="in">                           ~ paste0("Statistique t (", broom::glance(model)$df.residual, ")"),</span></span>
<span id="cb13-279"><a href="#cb13-279" aria-hidden="true" tabindex="-1"></a><span class="in">                           .cols = t)</span></span>
<span id="cb13-280"><a href="#cb13-280" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb13-281"><a href="#cb13-281" aria-hidden="true" tabindex="-1"></a><span class="in">  # Ne pas garder les colonnes qui ont d√©j√† √©t√© incorpor√©es √† d'autres, ou ne sont pas utiles</span></span>
<span id="cb13-282"><a href="#cb13-282" aria-hidden="true" tabindex="-1"></a><span class="in">  mp &lt;- dplyr::select(mp,</span></span>
<span id="cb13-283"><a href="#cb13-283" aria-hidden="true" tabindex="-1"></a><span class="in">                      -c(CI, CI_low, CI_high, df_error, Std_Coefficient, Std_CI_low, Std_CI_high))</span></span>
<span id="cb13-284"><a href="#cb13-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-285"><a href="#cb13-285" aria-hidden="true" tabindex="-1"></a><span class="in">  mp</span></span>
<span id="cb13-286"><a href="#cb13-286" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb13-287"><a href="#cb13-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-288"><a href="#cb13-288" aria-hidden="true" tabindex="-1"></a><span class="in">tab_lm &lt;- function(summary_lm_df, lm_model) {</span></span>
<span id="cb13-289"><a href="#cb13-289" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb13-290"><a href="#cb13-290" aria-hidden="true" tabindex="-1"></a><span class="in">  tab &lt;- gt::gt(summary_lm_df)</span></span>
<span id="cb13-291"><a href="#cb13-291" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb13-292"><a href="#cb13-292" aria-hidden="true" tabindex="-1"></a><span class="in">  t_col &lt;- paste0("Statistique t (", broom::glance(lm_model)$df.residual, ")")</span></span>
<span id="cb13-293"><a href="#cb13-293" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb13-294"><a href="#cb13-294" aria-hidden="true" tabindex="-1"></a><span class="in">  tab &lt;- gt::cols_label(tab,</span></span>
<span id="cb13-295"><a href="#cb13-295" aria-hidden="true" tabindex="-1"></a><span class="in">                        Param√®tre = gt::html("&lt;strong&gt;Param√®tre&lt;/strong&gt;"),</span></span>
<span id="cb13-296"><a href="#cb13-296" aria-hidden="true" tabindex="-1"></a><span class="in">                        Estimation = gt::html("&lt;strong&gt;Estimation&lt;br&gt;[IC 95 %]&lt;/strong&gt;"),</span></span>
<span id="cb13-297"><a href="#cb13-297" aria-hidden="true" tabindex="-1"></a><span class="in">                        `Erreur standard` = gt::html("&lt;strong&gt;Erreur standard&lt;/strong&gt;"),</span></span>
<span id="cb13-298"><a href="#cb13-298" aria-hidden="true" tabindex="-1"></a><span class="in">                        !!t_col := gt::html(</span></span>
<span id="cb13-299"><a href="#cb13-299" aria-hidden="true" tabindex="-1"></a><span class="in">                          paste0("&lt;strong&gt;Statistique &lt;em&gt;t&lt;/em&gt; (",</span></span>
<span id="cb13-300"><a href="#cb13-300" aria-hidden="true" tabindex="-1"></a><span class="in">                                 broom::glance(lm_model)$df.residual,</span></span>
<span id="cb13-301"><a href="#cb13-301" aria-hidden="true" tabindex="-1"></a><span class="in">                                 ")&lt;/strong&gt;")</span></span>
<span id="cb13-302"><a href="#cb13-302" aria-hidden="true" tabindex="-1"></a><span class="in">                        ),</span></span>
<span id="cb13-303"><a href="#cb13-303" aria-hidden="true" tabindex="-1"></a><span class="in">                        p = gt::html("&lt;strong&gt;&lt;em&gt;p&lt;/em&gt;-valeur&lt;/strong&gt;"),</span></span>
<span id="cb13-304"><a href="#cb13-304" aria-hidden="true" tabindex="-1"></a><span class="in">                        Œ≤ = gt::html("&lt;strong&gt;&lt;em&gt;Œ≤&lt;/em&gt;&lt;br&gt;[IC 95 %]&lt;/strong&gt;"))</span></span>
<span id="cb13-305"><a href="#cb13-305" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb13-306"><a href="#cb13-306" aria-hidden="true" tabindex="-1"></a><span class="in">  tab &lt;- gt::fmt_markdown(tab, columns = c(Estimation, Œ≤))</span></span>
<span id="cb13-307"><a href="#cb13-307" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb13-308"><a href="#cb13-308" aria-hidden="true" tabindex="-1"></a><span class="in">  tab &lt;- gt::cols_align(tab,</span></span>
<span id="cb13-309"><a href="#cb13-309" aria-hidden="true" tabindex="-1"></a><span class="in">                        align = "center",</span></span>
<span id="cb13-310"><a href="#cb13-310" aria-hidden="true" tabindex="-1"></a><span class="in">                        columns = c(</span></span>
<span id="cb13-311"><a href="#cb13-311" aria-hidden="true" tabindex="-1"></a><span class="in">                          Estimation,</span></span>
<span id="cb13-312"><a href="#cb13-312" aria-hidden="true" tabindex="-1"></a><span class="in">                          `Erreur standard`,</span></span>
<span id="cb13-313"><a href="#cb13-313" aria-hidden="true" tabindex="-1"></a><span class="in">                          !!t_col,</span></span>
<span id="cb13-314"><a href="#cb13-314" aria-hidden="true" tabindex="-1"></a><span class="in">                          p,</span></span>
<span id="cb13-315"><a href="#cb13-315" aria-hidden="true" tabindex="-1"></a><span class="in">                          Œ≤))</span></span>
<span id="cb13-316"><a href="#cb13-316" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb13-317"><a href="#cb13-317" aria-hidden="true" tabindex="-1"></a><span class="in">  tab &lt;- gt::tab_footnote(tab,</span></span>
<span id="cb13-318"><a href="#cb13-318" aria-hidden="true" tabindex="-1"></a><span class="in">                          gt::html(paste0("&lt;em&gt;Note&lt;/em&gt; : n = ",</span></span>
<span id="cb13-319"><a href="#cb13-319" aria-hidden="true" tabindex="-1"></a><span class="in">                                          scales::number(broom::glance(lm_model)$nobs),</span></span>
<span id="cb13-320"><a href="#cb13-320" aria-hidden="true" tabindex="-1"></a><span class="in">                                          " observations.")))</span></span>
<span id="cb13-321"><a href="#cb13-321" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb13-322"><a href="#cb13-322" aria-hidden="true" tabindex="-1"></a><span class="in">  tab</span></span>
<span id="cb13-323"><a href="#cb13-323" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb13-324"><a href="#cb13-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-325"><a href="#cb13-325" aria-hidden="true" tabindex="-1"></a><span class="in">lm1 &lt;- df %&gt;%</span></span>
<span id="cb13-326"><a href="#cb13-326" aria-hidden="true" tabindex="-1"></a><span class="in">  lm(reponse ~ groupe, .)</span></span>
<span id="cb13-327"><a href="#cb13-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-328"><a href="#cb13-328" aria-hidden="true" tabindex="-1"></a><span class="in">lm1 %&gt;%</span></span>
<span id="cb13-329"><a href="#cb13-329" aria-hidden="true" tabindex="-1"></a><span class="in">  summary_lm(vcov = "HC3") %&gt;%</span></span>
<span id="cb13-330"><a href="#cb13-330" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb13-331"><a href="#cb13-331" aria-hidden="true" tabindex="-1"></a><span class="in">    Param√®tre = ifelse(Param√®tre == "groupetest", "Groupe : Test", Param√®tre)) %&gt;%</span></span>
<span id="cb13-332"><a href="#cb13-332" aria-hidden="true" tabindex="-1"></a><span class="in">  tab_lm(lm_model = lm1)</span></span>
<span id="cb13-333"><a href="#cb13-333" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb13-334"><a href="#cb13-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-335"><a href="#cb13-335" aria-hidden="true" tabindex="-1"></a>L'intercept de la @tbl-lm1 signifie que la moyenne de la r√©ponse du groupe de contr√¥le est de <span class="in">`r round(lm1$coefficients[1], 2)`</span>. Le param√®tre estim√© pour le groupe test signifie qu'il pr√©sente une diff√©rence moyenne au groupe contr√¥le de <span class="in">`r round(lm1$coefficients[2], 2)`</span>. Donc, sa moyenne vaut <span class="in">`r round(lm1$coefficients[1], 2)`</span> + <span class="in">`r round(lm1$coefficients[2], 2)`</span> = <span class="in">`r round(lm1$coefficients[1] + lm1$coefficients[2], 2)`</span>.</span>
<span id="cb13-336"><a href="#cb13-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-337"><a href="#cb13-337" aria-hidden="true" tabindex="-1"></a>Ce que l'on peut facilement v√©rifier, via une simple moyenne, dans la @tbl-mean1 :</span>
<span id="cb13-338"><a href="#cb13-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-339"><a href="#cb13-339" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE}</span></span>
<span id="cb13-340"><a href="#cb13-340" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: tbl-mean1</span></span>
<span id="cb13-341"><a href="#cb13-341" aria-hidden="true" tabindex="-1"></a><span class="in">#| tbl-cap: "Tri √† plat de la moyenne de la R√©ponse, par le Groupe."</span></span>
<span id="cb13-342"><a href="#cb13-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-343"><a href="#cb13-343" aria-hidden="true" tabindex="-1"></a><span class="in">df %&gt;%</span></span>
<span id="cb13-344"><a href="#cb13-344" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(groupe) %&gt;%</span></span>
<span id="cb13-345"><a href="#cb13-345" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(Moyenne = mean(reponse)) %&gt;%</span></span>
<span id="cb13-346"><a href="#cb13-346" aria-hidden="true" tabindex="-1"></a><span class="in">  ungroup() %&gt;%</span></span>
<span id="cb13-347"><a href="#cb13-347" aria-hidden="true" tabindex="-1"></a><span class="in">  rename(Groupe = groupe) %&gt;%</span></span>
<span id="cb13-348"><a href="#cb13-348" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb13-349"><a href="#cb13-349" aria-hidden="true" tabindex="-1"></a><span class="in">    Groupe = ifelse(Groupe == "contr√¥le", "Contr√¥le", "Test"),</span></span>
<span id="cb13-350"><a href="#cb13-350" aria-hidden="true" tabindex="-1"></a><span class="in">    Moyenne = round(Moyenne, 2)) %&gt;%</span></span>
<span id="cb13-351"><a href="#cb13-351" aria-hidden="true" tabindex="-1"></a><span class="in">  gt() </span></span>
<span id="cb13-352"><a href="#cb13-352" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb13-353"><a href="#cb13-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-354"><a href="#cb13-354" aria-hidden="true" tabindex="-1"></a><span class="fu">## Repr√©senter les r√©sultats de l'@eq-simple </span></span>
<span id="cb13-355"><a href="#cb13-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-356"><a href="#cb13-356" aria-hidden="true" tabindex="-1"></a>Autrement dit, si le mod√®le lin√©aire ne contient que deux param√®tres (un intercept et une variable), il est possible de directement travailler √† partir des donn√©es brutes pour calculer les moyennes et intervalles de confiance^<span class="co">[</span><span class="ot">Un mod√®le lin√©aire √† un ou deux param√®tres, estim√© √† partir des moindres carr√©s ordinaires, renvoie des moyennes descriptives.</span><span class="co">]</span>. Cependant, je crois qu'il vaut mieux travailler √† partir de mod√®les lin√©aires qu'√† partir des donn√©es brutes :</span>
<span id="cb13-357"><a href="#cb13-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-358"><a href="#cb13-358" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>D'abord, s'il est vrai que pour des mod√®les simples comme le notre cela ne change rien √† l'estimation des param√®tres, pour des mod√®les plus complexes (trois param√®tres, des interactions, etc...), les param√®tres estim√©s ne sont plus les param√®tres bruts. Il faudra directement travailler √† partir du mod√®le, autant s'y habituer.</span>
<span id="cb13-359"><a href="#cb13-359" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>De plus, au-del√† des estimations, c'est l'erreur qui nous int√©resse : c'est √† partir de l'erreur que l'on calcule les intervalles de confiance, *t* ou *z*, et *p*. Travailler √† partir d'un mod√®le lin√©aire permet donc utiliser des erreurs robustes √† l'h√©t√©rosc√©dasticit√©, bootstrap, clusters, et d'autres encore <span class="co">[</span><span class="ot">@Zeileis2004</span><span class="co">]</span>.</span>
<span id="cb13-360"><a href="#cb13-360" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Finalement, c'est une bonne pratique, en anticipation de mod√®les plus complexes comme par exemple des mod√®les de panel <span class="co">[</span><span class="ot">@berge_2018</span><span class="co">]</span>. </span>
<span id="cb13-361"><a href="#cb13-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-362"><a href="#cb13-362" aria-hidden="true" tabindex="-1"></a>C'est la m√©thode que nous allons employer pour r√©aliser la @fig-plot_exemple √† partir d'erreurs robustes.</span>
<span id="cb13-363"><a href="#cb13-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-364"><a href="#cb13-364" aria-hidden="true" tabindex="-1"></a><span class="fu">### Repr√©senter un r√©sum√© des donn√©es</span></span>
<span id="cb13-365"><a href="#cb13-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-368"><a href="#cb13-368" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb13-369"><a href="#cb13-369" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot_exemple</span></span>
<span id="cb13-370"><a href="#cb13-370" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Un exemple de graphiques qui fonctionnent, mais qui pourraient √™tre am√©lior√©s. La barre repr√©sente l'intervalle de confiance √† 95 %, calcul√© √† partir d'erreurs robustes √† l'h√©t√©rosc√©dasticit√©."</span></span>
<span id="cb13-371"><a href="#cb13-371" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "80%"</span></span>
<span id="cb13-372"><a href="#cb13-372" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: "center"</span></span>
<span id="cb13-373"><a href="#cb13-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-374"><a href="#cb13-374" aria-hidden="true" tabindex="-1"></a>marginal_means_lm1 <span class="ot">&lt;-</span> <span class="fu">avg_predictions</span>(lm1, <span class="at">variables =</span> <span class="st">"groupe"</span>, <span class="at">vcov =</span> <span class="st">"HC3"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-375"><a href="#cb13-375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb13-376"><a href="#cb13-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-377"><a href="#cb13-377" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> marginal_means_lm1 <span class="sc">%&gt;%</span></span>
<span id="cb13-378"><a href="#cb13-378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> groupe, <span class="at">y =</span> estimate, <span class="at">colour =</span> groupe, <span class="at">shape =</span> groupe)) <span class="sc">+</span></span>
<span id="cb13-379"><a href="#cb13-379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(</span>
<span id="cb13-380"><a href="#cb13-380" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">colour =</span> <span class="cn">NULL</span>),</span>
<span id="cb13-381"><a href="#cb13-381" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">0</span>,</span>
<span id="cb13-382"><a href="#cb13-382" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb13-383"><a href="#cb13-383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb13-384"><a href="#cb13-384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(</span>
<span id="cb13-385"><a href="#cb13-385" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"test"</span> <span class="ot">=</span> egypt[<span class="dv">1</span>], <span class="st">"contr√¥le"</span> <span class="ot">=</span> egypt[<span class="dv">2</span>]),</span>
<span id="cb13-386"><a href="#cb13-386" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span>, <span class="st">"test"</span>),</span>
<span id="cb13-387"><a href="#cb13-387" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="st">"Contr√¥le"</span>, <span class="st">"test"</span> <span class="ot">=</span> <span class="st">"Test"</span>)) <span class="sc">+</span></span>
<span id="cb13-388"><a href="#cb13-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(</span>
<span id="cb13-389"><a href="#cb13-389" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"test"</span> <span class="ot">=</span> <span class="dv">16</span>, <span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="dv">17</span>), </span>
<span id="cb13-390"><a href="#cb13-390" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span>, <span class="st">"test"</span>), </span>
<span id="cb13-391"><a href="#cb13-391" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="st">"Contr√¥le"</span>, <span class="st">"test"</span> <span class="ot">=</span> <span class="st">"Test"</span>)) <span class="sc">+</span></span>
<span id="cb13-392"><a href="#cb13-392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb13-393"><a href="#cb13-393" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(</span>
<span id="cb13-394"><a href="#cb13-394" aria-hidden="true" tabindex="-1"></a>      <span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">17</span>, <span class="dv">16</span>),</span>
<span id="cb13-395"><a href="#cb13-395" aria-hidden="true" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="dv">0</span>)),</span>
<span id="cb13-396"><a href="#cb13-396" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb13-397"><a href="#cb13-397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb13-398"><a href="#cb13-398" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), </span>
<span id="cb13-399"><a href="#cb13-399" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb13-400"><a href="#cb13-400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-401"><a href="#cb13-401" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Moyenne de la r√©ponse, en fonction du groupe"</span>,</span>
<span id="cb13-402"><a href="#cb13-402" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Graphique en points."</span>,</span>
<span id="cb13-403"><a href="#cb13-403" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>, </span>
<span id="cb13-404"><a href="#cb13-404" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"R√©ponse moyenne"</span>)</span>
<span id="cb13-405"><a href="#cb13-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-406"><a href="#cb13-406" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> marginal_means_lm1 <span class="sc">%&gt;%</span></span>
<span id="cb13-407"><a href="#cb13-407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> groupe, <span class="at">y =</span> estimate, <span class="at">fill =</span> groupe)) <span class="sc">+</span></span>
<span id="cb13-408"><a href="#cb13-408" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb13-409"><a href="#cb13-409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high), <span class="at">width =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb13-410"><a href="#cb13-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"test"</span> <span class="ot">=</span> egypt[<span class="dv">1</span>], <span class="st">"contr√¥le"</span> <span class="ot">=</span> egypt[<span class="dv">2</span>]), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span>, <span class="st">"test"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="st">"Contr√¥le"</span>, <span class="st">"test"</span> <span class="ot">=</span> <span class="st">"Test"</span>)) <span class="sc">+</span></span>
<span id="cb13-411"><a href="#cb13-411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb13-412"><a href="#cb13-412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Moyenne de la r√©ponse, en fonction du groupe"</span>, <span class="at">subtitle =</span> <span class="st">"Graphique en barres."</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"R√©ponse moyenne"</span>)</span>
<span id="cb13-413"><a href="#cb13-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-414"><a href="#cb13-414" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(</span>
<span id="cb13-415"><a href="#cb13-415" aria-hidden="true" tabindex="-1"></a>  p1, p2,</span>
<span id="cb13-416"><a href="#cb13-416" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="st">"v"</span>, </span>
<span id="cb13-417"><a href="#cb13-417" aria-hidden="true" tabindex="-1"></a>  <span class="at">common.legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb13-418"><a href="#cb13-418" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="st">"bottom"</span>)</span>
<span id="cb13-419"><a href="#cb13-419" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb13-420"><a href="#cb13-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-421"><a href="#cb13-421" aria-hidden="true" tabindex="-1"></a>Ces graphiques sont quasiment cl√© en main : ils repr√©sentent les moyennes marginales issues d'un mod√®le lin√©aire, avec l'incertitude li√©e √† l'estimation calcul√©e de fa√ßon robuste. </span>
<span id="cb13-422"><a href="#cb13-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-423"><a href="#cb13-423" aria-hidden="true" tabindex="-1"></a><span class="fu">### Repr√©senter un r√©sum√© des donn√©es *et* les observations</span></span>
<span id="cb13-424"><a href="#cb13-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-425"><a href="#cb13-425" aria-hidden="true" tabindex="-1"></a>Le graphique que l'on vient de r√©aliser masque (1) les 1 000 observations que nous avons simul√©es et (2) la dispersion des donn√©es. Nous pourrions souhaiter repr√©senter ces donn√©es, et la complexit√© qu'elles recoupent, par exemple avec <span class="in">`ggdist`</span> <span class="co">[</span><span class="ot">@kay_ggdist</span><span class="co">]</span>.</span>
<span id="cb13-426"><a href="#cb13-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-429"><a href="#cb13-429" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb13-430"><a href="#cb13-430" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot_lm1_hetero</span></span>
<span id="cb13-431"><a href="#cb13-431" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Un exemple de graphique qui repr√©sente un effet de traitement contrefactuel. Le point repr√©sente la moyenne marginale estim√©e √† partir du mod√®le lin√©aire. La ligne color√©e correspond √† l‚Äôintervalle de confiance √† 95 % issu du mod√®le lin√©aire et robuste √† l‚Äôh√©t√©rosc√©dasticit√©. Les segments noirs situ√©s sous les points d√©crivent la distribution empirique des donn√©es : le segment le plus √©pais contient 66 % de la masse de la distribution, et le segment plus fin 95 %. La courbe de densit√© √† droite repr√©sente l‚Äôestimation liss√©e de la distribution des observations. Les points √† gauche correspondent aux observations individuelles, empil√©es afin de rendre leur concentration visible."</span></span>
<span id="cb13-432"><a href="#cb13-432" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "80%"</span></span>
<span id="cb13-433"><a href="#cb13-433" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: "center"</span></span>
<span id="cb13-434"><a href="#cb13-434" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb13-435"><a href="#cb13-435" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb13-436"><a href="#cb13-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-437"><a href="#cb13-437" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> marginal_means_lm1 <span class="sc">%&gt;%</span></span>
<span id="cb13-438"><a href="#cb13-438" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-439"><a href="#cb13-439" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> groupe, <span class="at">y =</span> estimate)) <span class="sc">+</span></span>
<span id="cb13-440"><a href="#cb13-440" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-441"><a href="#cb13-441" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_slab</span>(</span>
<span id="cb13-442"><a href="#cb13-442" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> df,</span>
<span id="cb13-443"><a href="#cb13-443" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">x =</span> groupe, <span class="at">y =</span> reponse, <span class="at">fill =</span> groupe),</span>
<span id="cb13-444"><a href="#cb13-444" aria-hidden="true" tabindex="-1"></a>      <span class="at">scale =</span> <span class="fl">0.45</span>,</span>
<span id="cb13-445"><a href="#cb13-445" aria-hidden="true" tabindex="-1"></a>      <span class="at">colour =</span> <span class="cn">NA</span>,</span>
<span id="cb13-446"><a href="#cb13-446" aria-hidden="true" tabindex="-1"></a>      <span class="at">adjust =</span> <span class="fl">0.7</span>,</span>
<span id="cb13-447"><a href="#cb13-447" aria-hidden="true" tabindex="-1"></a>      <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb13-448"><a href="#cb13-448" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-449"><a href="#cb13-449" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_dotsinterval</span>(</span>
<span id="cb13-450"><a href="#cb13-450" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> df,</span>
<span id="cb13-451"><a href="#cb13-451" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">x =</span> groupe, <span class="at">y =</span> reponse, <span class="at">fill =</span> groupe, <span class="at">shape =</span> groupe),</span>
<span id="cb13-452"><a href="#cb13-452" aria-hidden="true" tabindex="-1"></a>      <span class="at">side =</span> <span class="st">"bottom"</span>,</span>
<span id="cb13-453"><a href="#cb13-453" aria-hidden="true" tabindex="-1"></a>      <span class="at">scale =</span> <span class="fl">0.45</span>,</span>
<span id="cb13-454"><a href="#cb13-454" aria-hidden="true" tabindex="-1"></a>      <span class="at">point_size =</span> <span class="fl">1.5</span>,</span>
<span id="cb13-455"><a href="#cb13-455" aria-hidden="true" tabindex="-1"></a>      <span class="at">adjust =</span> <span class="fl">0.7</span>,</span>
<span id="cb13-456"><a href="#cb13-456" aria-hidden="true" tabindex="-1"></a>      <span class="at">point_interval =</span> mean_qi,</span>
<span id="cb13-457"><a href="#cb13-457" aria-hidden="true" tabindex="-1"></a>      <span class="at">justification =</span> <span class="fl">1.1</span>,</span>
<span id="cb13-458"><a href="#cb13-458" aria-hidden="true" tabindex="-1"></a>      <span class="at">slab_linewidth =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb13-459"><a href="#cb13-459" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-460"><a href="#cb13-460" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">colour =</span> groupe), <span class="at">width =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb13-461"><a href="#cb13-461" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-462"><a href="#cb13-462" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(</span>
<span id="cb13-463"><a href="#cb13-463" aria-hidden="true" tabindex="-1"></a>      <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"test"</span> <span class="ot">=</span> egypt[<span class="dv">1</span>], <span class="st">"contr√¥le"</span> <span class="ot">=</span> egypt[<span class="dv">2</span>]),</span>
<span id="cb13-464"><a href="#cb13-464" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span>, <span class="st">"test"</span>),</span>
<span id="cb13-465"><a href="#cb13-465" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="st">"Contr√¥le"</span>, <span class="st">"test"</span> <span class="ot">=</span> <span class="st">"Test"</span>)) <span class="sc">+</span></span>
<span id="cb13-466"><a href="#cb13-466" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-467"><a href="#cb13-467" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(</span>
<span id="cb13-468"><a href="#cb13-468" aria-hidden="true" tabindex="-1"></a>      <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"test"</span> <span class="ot">=</span> egypt[<span class="dv">1</span>], <span class="st">"contr√¥le"</span> <span class="ot">=</span> egypt[<span class="dv">2</span>]),</span>
<span id="cb13-469"><a href="#cb13-469" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span>, <span class="st">"test"</span>),</span>
<span id="cb13-470"><a href="#cb13-470" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="st">"Contr√¥le"</span>, <span class="st">"test"</span> <span class="ot">=</span> <span class="st">"Test"</span>),</span>
<span id="cb13-471"><a href="#cb13-471" aria-hidden="true" tabindex="-1"></a>      <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb13-472"><a href="#cb13-472" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-473"><a href="#cb13-473" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(</span>
<span id="cb13-474"><a href="#cb13-474" aria-hidden="true" tabindex="-1"></a>      <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"test"</span> <span class="ot">=</span> <span class="dv">16</span>, <span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="dv">17</span>),</span>
<span id="cb13-475"><a href="#cb13-475" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span>, <span class="st">"test"</span>),</span>
<span id="cb13-476"><a href="#cb13-476" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="st">"Contr√¥le"</span>, <span class="st">"test"</span> <span class="ot">=</span> <span class="st">"Test"</span>)) <span class="sc">+</span></span>
<span id="cb13-477"><a href="#cb13-477" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-478"><a href="#cb13-478" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb13-479"><a href="#cb13-479" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-480"><a href="#cb13-480" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb13-481"><a href="#cb13-481" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Moyenne de la r√©ponse, en fonction du groupe"</span>,</span>
<span id="cb13-482"><a href="#cb13-482" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="st">"Intervalles de confiance robustes et distribution des donn√©es."</span>,</span>
<span id="cb13-483"><a href="#cb13-483" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb13-484"><a href="#cb13-484" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"R√©ponse moyenne"</span>) <span class="sc">+</span></span>
<span id="cb13-485"><a href="#cb13-485" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-486"><a href="#cb13-486" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(</span>
<span id="cb13-487"><a href="#cb13-487" aria-hidden="true" tabindex="-1"></a>      <span class="at">colour =</span> <span class="st">"none"</span>,</span>
<span id="cb13-488"><a href="#cb13-488" aria-hidden="true" tabindex="-1"></a>      <span class="at">shape =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb13-489"><a href="#cb13-489" aria-hidden="true" tabindex="-1"></a>        <span class="at">override.aes =</span> <span class="fu">list</span>(</span>
<span id="cb13-490"><a href="#cb13-490" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour =</span> <span class="fu">c</span>(egypt[<span class="dv">2</span>], egypt[<span class="dv">1</span>]),</span>
<span id="cb13-491"><a href="#cb13-491" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill   =</span> <span class="fu">c</span>(egypt[<span class="dv">2</span>], egypt[<span class="dv">1</span>]),</span>
<span id="cb13-492"><a href="#cb13-492" aria-hidden="true" tabindex="-1"></a>          <span class="at">slab_alpha =</span> <span class="dv">0</span>,</span>
<span id="cb13-493"><a href="#cb13-493" aria-hidden="true" tabindex="-1"></a>          <span class="at">linetype =</span> <span class="dv">0</span>)))</span>
<span id="cb13-494"><a href="#cb13-494" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-495"><a href="#cb13-495" aria-hidden="true" tabindex="-1"></a>p3</span>
<span id="cb13-496"><a href="#cb13-496" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb13-497"><a href="#cb13-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-498"><a href="#cb13-498" aria-hidden="true" tabindex="-1"></a>On pourrait certainement am√©liorer ce plot, qui est tr√®s charg√©, mais c'est d√©j√† un bon point de d√©part je crois.</span>
<span id="cb13-499"><a href="#cb13-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-500"><a href="#cb13-500" aria-hidden="true" tabindex="-1"></a><span class="fu"># Estimer la diff√©rence entre les groupes, en contr√¥lant pour le genre et l'√¢ge</span></span>
<span id="cb13-501"><a href="#cb13-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-502"><a href="#cb13-502" aria-hidden="true" tabindex="-1"></a>Seulement voil√† : ce plot est faux. Et nous le savons, car nous avons g√©n√©r√© des donn√©es pour lesquelles $\beta = 15$. Il faudrait donc, a minima, ajuster un mod√®le lin√©aire int√©grant le genre et l'√¢ge. Certains pourraient m√™me pr√©ciser qu'il vaudrait encore mieux int√©grer l'ensemble des interactions groupe x genre x √¢ge. </span>
<span id="cb13-503"><a href="#cb13-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-504"><a href="#cb13-504" aria-hidden="true" tabindex="-1"></a>Ici, on va rester calmes et plut√¥t ajuster le mod√®le suivant, qui autorise une h√©t√©rog√©n√©it√© de l'effet du groupe en fonction de l'√¢ge et du genre :</span>
<span id="cb13-505"><a href="#cb13-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-506"><a href="#cb13-506" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb13-507"><a href="#cb13-507" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb13-508"><a href="#cb13-508" aria-hidden="true" tabindex="-1"></a>Y_i</span>
<span id="cb13-509"><a href="#cb13-509" aria-hidden="true" tabindex="-1"></a>= {} &amp; \alpha</span>
<span id="cb13-510"><a href="#cb13-510" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span>\beta D_i</span>
<span id="cb13-511"><a href="#cb13-511" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span>\gamma G_i</span>
<span id="cb13-512"><a href="#cb13-512" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span>\delta A_i <span class="sc">\\</span></span>
<span id="cb13-513"><a href="#cb13-513" aria-hidden="true" tabindex="-1"></a>&amp; + \eta \, (D_i \times G_i)</span>
<span id="cb13-514"><a href="#cb13-514" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span>\theta \, (D_i \times A_i)</span>
<span id="cb13-515"><a href="#cb13-515" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span>\varepsilon_i</span>
<span id="cb13-516"><a href="#cb13-516" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb13-517"><a href="#cb13-517" aria-hidden="true" tabindex="-1"></a>$$ {#eq-controle_interaction}</span>
<span id="cb13-518"><a href="#cb13-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-519"><a href="#cb13-519" aria-hidden="true" tabindex="-1"></a>o√π : </span>
<span id="cb13-520"><a href="#cb13-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-521"><a href="#cb13-521" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$D_i$ indique l‚Äôappartenance de l‚Äôindividu $i$, telle que $D_i = 0$ si l‚Äôindividu $i$ est dans le groupe contr√¥le et $D_i = 1$ s‚Äôil l'individu $i$ est dans le groupe test.</span>
<span id="cb13-522"><a href="#cb13-522" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$G_i$ est une variable indicatrice telle que $G_i = 0$ si l‚Äôindividu $i$ est une fille et $G_i = 1$ s‚Äôil s‚Äôagit d‚Äôun gar√ßon.</span>
<span id="cb13-523"><a href="#cb13-523" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$A_i$ d√©signe l‚Äô√¢ge, mod√©lis√© comme une variable continue. </span>
<span id="cb13-524"><a href="#cb13-524" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Le param√®tre $\beta$ repr√©sente l‚Äôeffet du traitement pour l‚Äôindividu de r√©f√©rence ($G_i = 0$ et $A_i = 0$), $\gamma$ la diff√©rence moyenne associ√©e au genre dans le groupe contr√¥le, et $\delta$ l‚Äôeffet marginal de l‚Äô√¢ge dans le groupe contr√¥le pour l‚Äôindividu de r√©f√©rence. </span>
<span id="cb13-525"><a href="#cb13-525" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Les param√®tres $\eta$ et $\theta$ captent respectivement la modification de l‚Äôeffet du traitement selon le genre et selon l‚Äô√¢ge.</span>
<span id="cb13-526"><a href="#cb13-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-529"><a href="#cb13-529" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb13-530"><a href="#cb13-530" aria-hidden="true" tabindex="-1"></a>lm2 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb13-531"><a href="#cb13-531" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(reponse <span class="sc">~</span> groupe <span class="sc">*</span> (genre <span class="sc">+</span> age), .)</span>
<span id="cb13-532"><a href="#cb13-532" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb13-533"><a href="#cb13-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-534"><a href="#cb13-534" aria-hidden="true" tabindex="-1"></a>Il ne faut pas interpr√©ter directement les coefficients issus du mod√®le <span class="co">[</span><span class="ot">cf. @WestreichGreenland2013</span><span class="co">]</span>, mais passer par la comparaison de moyennes marginales contrefactuelles estim√©es √† partir de l'@eq-controle_interaction <span class="co">[</span><span class="ot">@RohrerArelBundock2025</span><span class="co">]</span>.</span>
<span id="cb13-535"><a href="#cb13-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-538"><a href="#cb13-538" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb13-539"><a href="#cb13-539" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-lm2</span></span>
<span id="cb13-540"><a href="#cb13-540" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Comparaison des moyennes marginales issues de l'@eq-controle_interaction, r√©gressant la R√©ponse par le Groupe, en contr√¥lant pour l'interaction avec le genre et l'√¢ge."</span></span>
<span id="cb13-541"><a href="#cb13-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-542"><a href="#cb13-542" aria-hidden="true" tabindex="-1"></a>marginal_comparisons_lm2 <span class="ot">&lt;-</span> <span class="fu">avg_comparisons</span>(lm2, <span class="at">variables =</span> <span class="st">"groupe"</span>, <span class="at">vcov =</span> <span class="st">"HC3"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-543"><a href="#cb13-543" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb13-544"><a href="#cb13-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-545"><a href="#cb13-545" aria-hidden="true" tabindex="-1"></a>marginal_comparisons_lm2 <span class="sc">%&gt;%</span></span>
<span id="cb13-546"><a href="#cb13-546" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-547"><a href="#cb13-547" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-548"><a href="#cb13-548" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> <span class="fu">ifelse</span>(p.value <span class="sc">&lt;</span> .<span class="dv">001</span>, <span class="st">"&lt; .001"</span>, <span class="fu">round</span>(p.value, <span class="dv">3</span>)),</span>
<span id="cb13-549"><a href="#cb13-549" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">2</span>)),</span>
<span id="cb13-550"><a href="#cb13-550" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">paste0</span>(estimate, <span class="st">"&lt;br&gt;"</span>, <span class="st">"["</span>, conf.low, <span class="st">"; "</span>, conf.high, <span class="st">"]"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-551"><a href="#cb13-551" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-552"><a href="#cb13-552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(term, contrast, s.value, conf.low, conf.high)) <span class="sc">%&gt;%</span></span>
<span id="cb13-553"><a href="#cb13-553" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-554"><a href="#cb13-554" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-555"><a href="#cb13-555" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-556"><a href="#cb13-556" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb13-557"><a href="#cb13-557" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">html</span>(<span class="st">"&lt;strong&gt;Estimation&lt;br&gt;[IC 95 %]&lt;/strong&gt;"</span>),</span>
<span id="cb13-558"><a href="#cb13-558" aria-hidden="true" tabindex="-1"></a>    <span class="at">std.error =</span> <span class="fu">html</span>(<span class="st">"&lt;strong&gt;Erreur standard&lt;/strong&gt;"</span>),</span>
<span id="cb13-559"><a href="#cb13-559" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="fu">html</span>(</span>
<span id="cb13-560"><a href="#cb13-560" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"&lt;strong&gt;Statistique &lt;em&gt;t&lt;/em&gt; ("</span>,</span>
<span id="cb13-561"><a href="#cb13-561" aria-hidden="true" tabindex="-1"></a>             broom<span class="sc">::</span><span class="fu">glance</span>(lm2)<span class="sc">$</span>df.residual,</span>
<span id="cb13-562"><a href="#cb13-562" aria-hidden="true" tabindex="-1"></a>             <span class="st">")&lt;/strong&gt;"</span>)),</span>
<span id="cb13-563"><a href="#cb13-563" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> <span class="fu">html</span>(<span class="st">"&lt;strong&gt;&lt;em&gt;p&lt;/em&gt;-valeur&lt;/strong&gt;"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-564"><a href="#cb13-564" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-565"><a href="#cb13-565" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_markdown</span>(<span class="at">columns =</span> <span class="fu">c</span>(estimate)) <span class="sc">%&gt;%</span></span>
<span id="cb13-566"><a href="#cb13-566" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-567"><a href="#cb13-567" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb13-568"><a href="#cb13-568" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>,</span>
<span id="cb13-569"><a href="#cb13-569" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(</span>
<span id="cb13-570"><a href="#cb13-570" aria-hidden="true" tabindex="-1"></a>      estimate,</span>
<span id="cb13-571"><a href="#cb13-571" aria-hidden="true" tabindex="-1"></a>      std.error,</span>
<span id="cb13-572"><a href="#cb13-572" aria-hidden="true" tabindex="-1"></a>      statistic,</span>
<span id="cb13-573"><a href="#cb13-573" aria-hidden="true" tabindex="-1"></a>      p.value)) <span class="sc">%&gt;%</span></span>
<span id="cb13-574"><a href="#cb13-574" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-575"><a href="#cb13-575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb13-576"><a href="#cb13-576" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html</span>(<span class="fu">paste0</span>(<span class="st">"&lt;em&gt;Note&lt;/em&gt; : n = "</span>,</span>
<span id="cb13-577"><a href="#cb13-577" aria-hidden="true" tabindex="-1"></a>            scales<span class="sc">::</span><span class="fu">number</span>(broom<span class="sc">::</span><span class="fu">glance</span>(lm2)<span class="sc">$</span>nobs),</span>
<span id="cb13-578"><a href="#cb13-578" aria-hidden="true" tabindex="-1"></a>            <span class="st">" observations. Comparaison des moyennes marginales estim√©es √† partir du mod√®le lin√©aire."</span>)))</span>
<span id="cb13-579"><a href="#cb13-579" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb13-580"><a href="#cb13-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-581"><a href="#cb13-581" aria-hidden="true" tabindex="-1"></a>Ouf ! Les choses sont bien faites et $\beta$ vaut bien (presque) 15. </span>
<span id="cb13-582"><a href="#cb13-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-583"><a href="#cb13-583" aria-hidden="true" tabindex="-1"></a><span class="fu">## Repr√©senter les r√©sultats de l'@eq-controle_interaction</span></span>
<span id="cb13-584"><a href="#cb13-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-585"><a href="#cb13-585" aria-hidden="true" tabindex="-1"></a>On pourrait rapporter la @tbl-lm2, et on serait d√©j√† bien content¬∑e. Sur le m√™me mode que la @fig-plot_exemple, on pourrait √©galement r√©aliser un graphique des moyennes marginales.</span>
<span id="cb13-586"><a href="#cb13-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-587"><a href="#cb13-587" aria-hidden="true" tabindex="-1"></a><span class="fu">### Repr√©senter un r√©sum√© des donn√©es</span></span>
<span id="cb13-588"><a href="#cb13-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-591"><a href="#cb13-591" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb13-592"><a href="#cb13-592" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot_lm2_simple</span></span>
<span id="cb13-593"><a href="#cb13-593" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Un exemple de graphiques qui fonctionnes eux aussi, mais qui pourraient eux aussi √™tre am√©lior√©s. La barre repr√©sente l'intervalle de confiance √† 95 %, calcul√© √† partir d'erreurs robustes √† l'h√©t√©rosc√©dasticit√©."</span></span>
<span id="cb13-594"><a href="#cb13-594" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb13-595"><a href="#cb13-595" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: "center"</span></span>
<span id="cb13-596"><a href="#cb13-596" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7.2</span></span>
<span id="cb13-597"><a href="#cb13-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-598"><a href="#cb13-598" aria-hidden="true" tabindex="-1"></a>p_ate_predictions_points <span class="ot">&lt;-</span> <span class="fu">avg_predictions</span>(lm2, <span class="at">variables =</span> <span class="st">"groupe"</span>, <span class="at">vcov =</span> <span class="st">"HC3"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-599"><a href="#cb13-599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-600"><a href="#cb13-600" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-601"><a href="#cb13-601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb13-602"><a href="#cb13-602" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> groupe, <span class="at">y =</span> estimate, <span class="at">color =</span> groupe, <span class="at">shape =</span> groupe) <span class="sc">+</span></span>
<span id="cb13-603"><a href="#cb13-603" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb13-604"><a href="#cb13-604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high), <span class="at">width =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb13-605"><a href="#cb13-605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Effets contrefactuels moyens"</span>,</span>
<span id="cb13-606"><a href="#cb13-606" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Point et intervalles de confiance √† 95 %."</span>,</span>
<span id="cb13-607"><a href="#cb13-607" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"R√©ponse"</span>) <span class="sc">+</span></span>
<span id="cb13-608"><a href="#cb13-608" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-609"><a href="#cb13-609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(</span>
<span id="cb13-610"><a href="#cb13-610" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"test"</span> <span class="ot">=</span> egypt[<span class="dv">1</span>], <span class="st">"contr√¥le"</span> <span class="ot">=</span> egypt[<span class="dv">2</span>]),</span>
<span id="cb13-611"><a href="#cb13-611" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span>, <span class="st">"test"</span>),</span>
<span id="cb13-612"><a href="#cb13-612" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="st">"Contr√¥le"</span>, <span class="st">"test"</span> <span class="ot">=</span> <span class="st">"Test"</span>)) <span class="sc">+</span></span>
<span id="cb13-613"><a href="#cb13-613" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-614"><a href="#cb13-614" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb13-615"><a href="#cb13-615" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"test"</span> <span class="ot">=</span> egypt[<span class="dv">1</span>], <span class="st">"contr√¥le"</span> <span class="ot">=</span> egypt[<span class="dv">2</span>]),</span>
<span id="cb13-616"><a href="#cb13-616" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span>, <span class="st">"test"</span>),</span>
<span id="cb13-617"><a href="#cb13-617" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="st">"Contr√¥le"</span>, <span class="st">"test"</span> <span class="ot">=</span> <span class="st">"Test"</span>),</span>
<span id="cb13-618"><a href="#cb13-618" aria-hidden="true" tabindex="-1"></a>    <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb13-619"><a href="#cb13-619" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-620"><a href="#cb13-620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(</span>
<span id="cb13-621"><a href="#cb13-621" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"test"</span> <span class="ot">=</span> <span class="dv">16</span>, <span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="dv">17</span>),</span>
<span id="cb13-622"><a href="#cb13-622" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span>, <span class="st">"test"</span>),</span>
<span id="cb13-623"><a href="#cb13-623" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="st">"Contr√¥le"</span>, <span class="st">"test"</span> <span class="ot">=</span> <span class="st">"Test"</span>)) <span class="sc">+</span></span>
<span id="cb13-624"><a href="#cb13-624" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-625"><a href="#cb13-625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb13-626"><a href="#cb13-626" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"none"</span>,</span>
<span id="cb13-627"><a href="#cb13-627" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb13-628"><a href="#cb13-628" aria-hidden="true" tabindex="-1"></a>      <span class="at">override.aes =</span> <span class="fu">list</span>(</span>
<span id="cb13-629"><a href="#cb13-629" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="fu">c</span>(egypt[<span class="dv">2</span>], egypt[<span class="dv">1</span>]),</span>
<span id="cb13-630"><a href="#cb13-630" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill   =</span> <span class="fu">c</span>(egypt[<span class="dv">2</span>], egypt[<span class="dv">1</span>]),</span>
<span id="cb13-631"><a href="#cb13-631" aria-hidden="true" tabindex="-1"></a>        <span class="at">slab_alpha =</span> <span class="dv">0</span>,</span>
<span id="cb13-632"><a href="#cb13-632" aria-hidden="true" tabindex="-1"></a>        <span class="at">linetype =</span> <span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb13-633"><a href="#cb13-633" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-634"><a href="#cb13-634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb13-635"><a href="#cb13-635" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), </span>
<span id="cb13-636"><a href="#cb13-636" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))</span>
<span id="cb13-637"><a href="#cb13-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-638"><a href="#cb13-638" aria-hidden="true" tabindex="-1"></a>p_ate_predictions_bars <span class="ot">&lt;-</span> <span class="fu">avg_predictions</span>(lm2, <span class="at">variables =</span> <span class="st">"groupe"</span>, <span class="at">vcov =</span> <span class="st">"HC3"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-639"><a href="#cb13-639" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-640"><a href="#cb13-640" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-641"><a href="#cb13-641" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb13-642"><a href="#cb13-642" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> groupe, <span class="at">y =</span> estimate, <span class="at">fill =</span> groupe) <span class="sc">+</span></span>
<span id="cb13-643"><a href="#cb13-643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb13-644"><a href="#cb13-644" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high), <span class="at">width =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb13-645"><a href="#cb13-645" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Effets contrefactuels moyens"</span>,</span>
<span id="cb13-646"><a href="#cb13-646" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Point et intervalles de confiance √† 95 %."</span>,</span>
<span id="cb13-647"><a href="#cb13-647" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"R√©ponse"</span>) <span class="sc">+</span></span>
<span id="cb13-648"><a href="#cb13-648" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-649"><a href="#cb13-649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb13-650"><a href="#cb13-650" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"test"</span> <span class="ot">=</span> egypt[<span class="dv">1</span>], <span class="st">"contr√¥le"</span> <span class="ot">=</span> egypt[<span class="dv">2</span>]),</span>
<span id="cb13-651"><a href="#cb13-651" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span>, <span class="st">"test"</span>),</span>
<span id="cb13-652"><a href="#cb13-652" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="st">"Contr√¥le"</span>, <span class="st">"test"</span> <span class="ot">=</span> <span class="st">"Test"</span>),</span>
<span id="cb13-653"><a href="#cb13-653" aria-hidden="true" tabindex="-1"></a>    <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb13-654"><a href="#cb13-654" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-655"><a href="#cb13-655" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb13-656"><a href="#cb13-656" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"none"</span>,</span>
<span id="cb13-657"><a href="#cb13-657" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb13-658"><a href="#cb13-658" aria-hidden="true" tabindex="-1"></a>      <span class="at">override.aes =</span> <span class="fu">list</span>(</span>
<span id="cb13-659"><a href="#cb13-659" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="fu">c</span>(egypt[<span class="dv">2</span>], egypt[<span class="dv">1</span>]),</span>
<span id="cb13-660"><a href="#cb13-660" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill   =</span> <span class="fu">c</span>(egypt[<span class="dv">2</span>], egypt[<span class="dv">1</span>]),</span>
<span id="cb13-661"><a href="#cb13-661" aria-hidden="true" tabindex="-1"></a>        <span class="at">slab_alpha =</span> <span class="dv">0</span>,</span>
<span id="cb13-662"><a href="#cb13-662" aria-hidden="true" tabindex="-1"></a>        <span class="at">linetype =</span> <span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb13-663"><a href="#cb13-663" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-664"><a href="#cb13-664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb13-665"><a href="#cb13-665" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), </span>
<span id="cb13-666"><a href="#cb13-666" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))</span>
<span id="cb13-667"><a href="#cb13-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-668"><a href="#cb13-668" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(</span>
<span id="cb13-669"><a href="#cb13-669" aria-hidden="true" tabindex="-1"></a>  p_ate_predictions_points, p_ate_predictions_bars,</span>
<span id="cb13-670"><a href="#cb13-670" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="st">"v"</span>, </span>
<span id="cb13-671"><a href="#cb13-671" aria-hidden="true" tabindex="-1"></a>  <span class="at">common.legend =</span> <span class="cn">TRUE</span>, </span>
<span id="cb13-672"><a href="#cb13-672" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="st">"bottom"</span>)</span>
<span id="cb13-673"><a href="#cb13-673" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb13-674"><a href="#cb13-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-675"><a href="#cb13-675" aria-hidden="true" tabindex="-1"></a>Finalement, on pourrait aussi r√©aliser un graphique de l'effet de traitement moyen.</span>
<span id="cb13-676"><a href="#cb13-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-679"><a href="#cb13-679" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb13-680"><a href="#cb13-680" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot_lm2_ate</span></span>
<span id="cb13-681"><a href="#cb13-681" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Exemple de graphique d'effet de traitement moyen. Le point repr√©sente l'effet de traitement moyen, la barre l'intervalle de confiance √† 95 %, calcul√© √† partir d'erreurs robustes √† l'h√©t√©rosc√©dasticit√©."</span></span>
<span id="cb13-682"><a href="#cb13-682" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb13-683"><a href="#cb13-683" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: "center"</span></span>
<span id="cb13-684"><a href="#cb13-684" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7.2</span></span>
<span id="cb13-685"><a href="#cb13-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-686"><a href="#cb13-686" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_comparisons</span>(lm2, <span class="at">variables =</span> <span class="st">"groupe"</span>, <span class="at">vcov =</span> <span class="st">"HC3"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-687"><a href="#cb13-687" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-688"><a href="#cb13-688" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-689"><a href="#cb13-689" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb13-690"><a href="#cb13-690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> term, <span class="at">y =</span> estimate) <span class="sc">+</span></span>
<span id="cb13-691"><a href="#cb13-691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb13-692"><a href="#cb13-692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high), <span class="at">width =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb13-693"><a href="#cb13-693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Effet de traitement moyen"</span>,</span>
<span id="cb13-694"><a href="#cb13-694" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Point et intervalles de confiance √† 95 %."</span>,</span>
<span id="cb13-695"><a href="#cb13-695" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"R√©ponse"</span>) <span class="sc">+</span></span>
<span id="cb13-696"><a href="#cb13-696" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-697"><a href="#cb13-697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb13-698"><a href="#cb13-698" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), </span>
<span id="cb13-699"><a href="#cb13-699" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))</span>
<span id="cb13-700"><a href="#cb13-700" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb13-701"><a href="#cb13-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-702"><a href="#cb13-702" aria-hidden="true" tabindex="-1"></a><span class="fu">### Repr√©senter un r√©sum√© des donn√©es *et* les observations</span></span>
<span id="cb13-703"><a href="#cb13-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-704"><a href="#cb13-704" aria-hidden="true" tabindex="-1"></a>On retombe ici sur le probl√®me soulev√© au d√©part : alors que l'on a 1 000 observations, les @fig-plot_lm2_simple et @fig-plot_lm2_ate ne les r√©sument qu'en une seule information. On va d√©sormais r√©aliser deux graphiques diff√©rents, qui repr√©sentent les observations *et* le r√©sum√© des donn√©es. Mais les choses se compliquent, car les donn√©es n'existent pas en tant que tel.</span>
<span id="cb13-705"><a href="#cb13-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-706"><a href="#cb13-706" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Un graphique des effets contrefactuels *individuels* **. Pour cela, on va</span>
<span id="cb13-707"><a href="#cb13-707" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Estimer $\widehat{Y_i}$, pour un contrefactuel dans lequel l'ensemble de l'√©chantillon serait *soit* dans le groupe test, *soit* dans le groupe contr√¥le. Dit autrement, on va doubler le jeu de donn√©es et (1) maintenir l'ensemble des covariables constantes, (2) modifier le fait que l'observation appartienne au groupe test ou contr√¥le √† covariables constantes, puis (3) estimer $\widehat{Y_i}$ selon que l'observation soit dans un groupe test ou contr√¥le.</span>
<span id="cb13-708"><a href="#cb13-708" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Estimer la moyenne de ces $\widehat{Y_i}$, *par groupe* test ou contr√¥le, ainsi que les intervalles de confiance.</span>
<span id="cb13-709"><a href="#cb13-709" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>R√©aliser le graphique. </span>
<span id="cb13-710"><a href="#cb13-710" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Un graphique des effets contrefactuels *moyens* **. Pour cela, on va</span>
<span id="cb13-711"><a href="#cb13-711" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Repartir des  donn√©es g√©n√©r√©es pour le premier graphique.</span>
<span id="cb13-712"><a href="#cb13-712" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Estimer la diff√©rence, *pour chaque observation*, selon qu'elle soit en groupe test ou contr√¥le.</span>
<span id="cb13-713"><a href="#cb13-713" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Estimer la diff√©rence *moyenne* de ces diff√©rences et les intervalles de confiance.</span>
<span id="cb13-714"><a href="#cb13-714" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>R√©aliser le graphique.</span>
<span id="cb13-715"><a href="#cb13-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-716"><a href="#cb13-716" aria-hidden="true" tabindex="-1"></a>Ca peut sembler √™tre beaucoup, mais c'est en r√©alit√© aujourd'hui (relativement) facilement faisable.</span>
<span id="cb13-717"><a href="#cb13-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-718"><a href="#cb13-718" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Estimer $\widehat{Y_i}$</span></span>
<span id="cb13-719"><a href="#cb13-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-720"><a href="#cb13-720" aria-hidden="true" tabindex="-1"></a>La premi√®re √©tape consiste √† utiliser les coefficients estim√©s par le mod√®le lin√©aire de l'@eq-controle_interaction afin de pr√©dire, pour chaque observation, la valeur que prendrait la r√©ponse dans chacun des √©tats contrefactuels consid√©r√©s.</span>
<span id="cb13-721"><a href="#cb13-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-722"><a href="#cb13-722" aria-hidden="true" tabindex="-1"></a>Pour le dire autrement, voici l'@eq-controle_interaction, int√©grant les coefficients estim√©s par r√©gression lin√©aire :</span>
<span id="cb13-723"><a href="#cb13-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-724"><a href="#cb13-724" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE}</span></span>
<span id="cb13-725"><a href="#cb13-725" aria-hidden="true" tabindex="-1"></a><span class="in">fmt &lt;- function(x) formatC(x, digits = 2, format = "f", decimal.mark = ".")</span></span>
<span id="cb13-726"><a href="#cb13-726" aria-hidden="true" tabindex="-1"></a><span class="in">b &lt;- coef(lm2)</span></span>
<span id="cb13-727"><a href="#cb13-727" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb13-728"><a href="#cb13-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-729"><a href="#cb13-729" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb13-730"><a href="#cb13-730" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb13-731"><a href="#cb13-731" aria-hidden="true" tabindex="-1"></a>Y_i</span>
<span id="cb13-732"><a href="#cb13-732" aria-hidden="true" tabindex="-1"></a>= {} &amp; <span class="in">`r fmt(b["(Intercept)"])`</span></span>
<span id="cb13-733"><a href="#cb13-733" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span><span class="in">`r fmt(b["groupetest"])`</span> D_i</span>
<span id="cb13-734"><a href="#cb13-734" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span><span class="in">`r fmt(b["genreGar√ßon"])`</span> G_i</span>
<span id="cb13-735"><a href="#cb13-735" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span><span class="in">`r fmt(b["age"])`</span> A_i <span class="sc">\\</span></span>
<span id="cb13-736"><a href="#cb13-736" aria-hidden="true" tabindex="-1"></a>&amp; + <span class="in">`r fmt(b["groupetest:genreGar√ßon"])`</span> \, (D_i \times G_i)</span>
<span id="cb13-737"><a href="#cb13-737" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span><span class="in">`r fmt(b["groupetest:age"])`</span> \, (D_i \times A_i)</span>
<span id="cb13-738"><a href="#cb13-738" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span>\varepsilon_i</span>
<span id="cb13-739"><a href="#cb13-739" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb13-740"><a href="#cb13-740" aria-hidden="true" tabindex="-1"></a>$$ {#eq-controle_interaction_estimee}</span>
<span id="cb13-741"><a href="#cb13-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-742"><a href="#cb13-742" aria-hidden="true" tabindex="-1"></a>A partir de ces coefficients, on peut, pour chaque observation, calculer ce que vaut $\widehat{Y}_i$. Ainsi, pour une observation du groupe test ($D_i = 1$), une fille ($G_i = 0$), √¢g√©e de 35 ans ($A_i = 35$), on obtient :</span>
<span id="cb13-743"><a href="#cb13-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-744"><a href="#cb13-744" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb13-745"><a href="#cb13-745" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb13-746"><a href="#cb13-746" aria-hidden="true" tabindex="-1"></a>\widehat{Y}_i</span>
<span id="cb13-747"><a href="#cb13-747" aria-hidden="true" tabindex="-1"></a>= {} &amp; <span class="in">`r fmt(b["(Intercept)"])`</span></span>
<span id="cb13-748"><a href="#cb13-748" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span><span class="in">`r fmt(b["groupetest"])`</span> \times 1</span>
<span id="cb13-749"><a href="#cb13-749" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span><span class="in">`r fmt(b["genreGar√ßon"])`</span> \times 0</span>
<span id="cb13-750"><a href="#cb13-750" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span><span class="in">`r fmt(b["age"])`</span> \times 35 <span class="sc">\\</span></span>
<span id="cb13-751"><a href="#cb13-751" aria-hidden="true" tabindex="-1"></a>&amp; + <span class="in">`r fmt(b["groupetest:genreGar√ßon"])`</span> \times (1 \times 0)</span>
<span id="cb13-752"><a href="#cb13-752" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span><span class="in">`r fmt(b["groupetest:age"])`</span> \times (1 \times 35)</span>
<span id="cb13-753"><a href="#cb13-753" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb13-754"><a href="#cb13-754" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb13-755"><a href="#cb13-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-756"><a href="#cb13-756" aria-hidden="true" tabindex="-1"></a>soit :</span>
<span id="cb13-757"><a href="#cb13-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-758"><a href="#cb13-758" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE}</span></span>
<span id="cb13-759"><a href="#cb13-759" aria-hidden="true" tabindex="-1"></a><span class="in">yhat_ex &lt;- predict(lm2, newdata = data.frame(groupe = "test", genre = "Fille", age = 35))</span></span>
<span id="cb13-760"><a href="#cb13-760" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb13-761"><a href="#cb13-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-762"><a href="#cb13-762" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb13-763"><a href="#cb13-763" aria-hidden="true" tabindex="-1"></a>\widehat{Y}_i = <span class="in">`r fmt(yhat_ex)`</span></span>
<span id="cb13-764"><a href="#cb13-764" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb13-765"><a href="#cb13-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-766"><a href="#cb13-766" aria-hidden="true" tabindex="-1"></a>On suit cette logique, pour l'ensemble des observations, doubl√©es soit pour appartenir au groupe de test soit au groupe de contr√¥le.</span>
<span id="cb13-767"><a href="#cb13-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-770"><a href="#cb13-770" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb13-771"><a href="#cb13-771" aria-hidden="true" tabindex="-1"></a><span class="co"># D√©finir une grille contrefactuelle</span></span>
<span id="cb13-772"><a href="#cb13-772" aria-hidden="true" tabindex="-1"></a>counterfactual_datagrid_lm2 <span class="ot">=</span> <span class="fu">datagrid</span>(</span>
<span id="cb13-773"><a href="#cb13-773" aria-hidden="true" tabindex="-1"></a>  <span class="at">groupe =</span> <span class="fu">c</span>(<span class="st">"test"</span>, <span class="st">"contr√¥le"</span>),</span>
<span id="cb13-774"><a href="#cb13-774" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid_type =</span> <span class="st">"counterfactual"</span>,</span>
<span id="cb13-775"><a href="#cb13-775" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> df)</span>
<span id="cb13-776"><a href="#cb13-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-777"><a href="#cb13-777" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimer, pour cette nouvelle grille, ce que vaudrait Y_hat</span></span>
<span id="cb13-778"><a href="#cb13-778" aria-hidden="true" tabindex="-1"></a>df_hat <span class="ot">&lt;-</span> <span class="fu">predictions</span>(</span>
<span id="cb13-779"><a href="#cb13-779" aria-hidden="true" tabindex="-1"></a>  lm2,</span>
<span id="cb13-780"><a href="#cb13-780" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> counterfactual_datagrid_lm2)</span>
<span id="cb13-781"><a href="#cb13-781" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb13-782"><a href="#cb13-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-783"><a href="#cb13-783" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Estimer la moyenne de ces $\widehat{Y}$, par groupe, selon ce contrefactuel</span></span>
<span id="cb13-784"><a href="#cb13-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-785"><a href="#cb13-785" aria-hidden="true" tabindex="-1"></a>Ici, on moyenne les pr√©dictions individuelles r√©alis√©es √† l'√©tape pr√©c√©dente.</span>
<span id="cb13-786"><a href="#cb13-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-789"><a href="#cb13-789" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb13-790"><a href="#cb13-790" aria-hidden="true" tabindex="-1"></a>avg_predictions_lm2 <span class="ot">&lt;-</span> <span class="fu">avg_predictions</span>(</span>
<span id="cb13-791"><a href="#cb13-791" aria-hidden="true" tabindex="-1"></a>  lm2,</span>
<span id="cb13-792"><a href="#cb13-792" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> counterfactual_datagrid_lm2,</span>
<span id="cb13-793"><a href="#cb13-793" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="st">"groupe"</span>,</span>
<span id="cb13-794"><a href="#cb13-794" aria-hidden="true" tabindex="-1"></a>  <span class="at">vcov =</span> <span class="st">"HC3"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-795"><a href="#cb13-795" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb13-796"><a href="#cb13-796" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb13-797"><a href="#cb13-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-798"><a href="#cb13-798" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Estimer la diff√©rence, pour chaque personne, pour ce m√™me contrefactuel.</span></span>
<span id="cb13-799"><a href="#cb13-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-800"><a href="#cb13-800" aria-hidden="true" tabindex="-1"></a>Notre jeu de donn√©es contient 1 000 observations, et la grille contrefactuelle en contient donc 2 000 (chaque observation est d√©doubl√©e pour appartenir une fois au groupe test et une fois au groupe contr√¥le). Calculons, pour chaque observation, la diff√©rence entre chaque √©tat *√† covariables constantes*.</span>
<span id="cb13-801"><a href="#cb13-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-804"><a href="#cb13-804" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb13-805"><a href="#cb13-805" aria-hidden="true" tabindex="-1"></a>delta_i <span class="ot">&lt;-</span> df_hat <span class="sc">%&gt;%</span></span>
<span id="cb13-806"><a href="#cb13-806" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(rowidcf, groupe, estimate) <span class="sc">%&gt;%</span></span>
<span id="cb13-807"><a href="#cb13-807" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> rowidcf, <span class="at">names_from =</span> groupe, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span></span>
<span id="cb13-808"><a href="#cb13-808" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-809"><a href="#cb13-809" aria-hidden="true" tabindex="-1"></a>    <span class="at">contraste =</span> <span class="st">"Test - Contr√¥le"</span>,</span>
<span id="cb13-810"><a href="#cb13-810" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> test <span class="sc">-</span> contr√¥le)</span>
<span id="cb13-811"><a href="#cb13-811" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb13-812"><a href="#cb13-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-813"><a href="#cb13-813" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Estimer la diff√©rence moyenne</span></span>
<span id="cb13-814"><a href="#cb13-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-815"><a href="#cb13-815" aria-hidden="true" tabindex="-1"></a>On l'a d√©j√† faut plus haut pour l'@eq-controle_interaction. Je le refais ici, car on va l√©g√®rement modifier l'objet pour l'int√©grer au sein du futur graphique.</span>
<span id="cb13-816"><a href="#cb13-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-819"><a href="#cb13-819" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb13-820"><a href="#cb13-820" aria-hidden="true" tabindex="-1"></a>delta_avg <span class="ot">&lt;-</span> <span class="fu">avg_comparisons</span>(</span>
<span id="cb13-821"><a href="#cb13-821" aria-hidden="true" tabindex="-1"></a>  lm2,</span>
<span id="cb13-822"><a href="#cb13-822" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> counterfactual_datagrid_lm2,</span>
<span id="cb13-823"><a href="#cb13-823" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="st">"groupe"</span>,</span>
<span id="cb13-824"><a href="#cb13-824" aria-hidden="true" tabindex="-1"></a>  <span class="at">vcov =</span> <span class="st">"HC3"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-825"><a href="#cb13-825" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-826"><a href="#cb13-826" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contraste =</span> <span class="st">"Test - Contr√¥le"</span>)</span>
<span id="cb13-827"><a href="#cb13-827" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb13-828"><a href="#cb13-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-829"><a href="#cb13-829" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Repr√©senter les donn√©es</span></span>
<span id="cb13-830"><a href="#cb13-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-831"><a href="#cb13-831" aria-hidden="true" tabindex="-1"></a>Je repr√©sente les donn√©es de deux fa√ßons : </span>
<span id="cb13-832"><a href="#cb13-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-833"><a href="#cb13-833" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>D'abord, les pr√©dictions pour le groupe test et le groupe contr√¥le, par observation.</span>
<span id="cb13-834"><a href="#cb13-834" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Puis, les pr√©dictions pour l'effet marginal estim√©, c'est-√†-dire la diff√©rence de pr√©diction entre le groupe test et contr√¥le, par observation.</span>
<span id="cb13-835"><a href="#cb13-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-838"><a href="#cb13-838" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb13-839"><a href="#cb13-839" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot_lm2_hetero</span></span>
<span id="cb13-840"><a href="#cb13-840" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Un exemple de graphique qui repr√©sente l'h√©t√©rog√©n√©it√©, calcul√© √† partir des donn√©es estim√©es par r√©gression lin√©aire. Effets individuels et effet moyen obtenus √† partir du mod√®le lin√©aire. Erreur robuste √† l‚Äôh√©t√©rosc√©dasticit√©. La ligne color√©e correspond √† l‚Äôintervalle de confiance √† 95 %. Le segment noir le plus √©pais contient 66 % de la masse de la distribution, et le segment plus fin 95 %."</span></span>
<span id="cb13-841"><a href="#cb13-841" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb13-842"><a href="#cb13-842" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: "center"</span></span>
<span id="cb13-843"><a href="#cb13-843" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7.2</span></span>
<span id="cb13-844"><a href="#cb13-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-845"><a href="#cb13-845" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> df_hat <span class="sc">%&gt;%</span></span>
<span id="cb13-846"><a href="#cb13-846" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-847"><a href="#cb13-847" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> groupe, <span class="at">y =</span> estimate)) <span class="sc">+</span></span>
<span id="cb13-848"><a href="#cb13-848" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-849"><a href="#cb13-849" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_slab</span>(</span>
<span id="cb13-850"><a href="#cb13-850" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill =</span> groupe),</span>
<span id="cb13-851"><a href="#cb13-851" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale =</span> <span class="fl">0.45</span>,</span>
<span id="cb13-852"><a href="#cb13-852" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="cn">NA</span>,</span>
<span id="cb13-853"><a href="#cb13-853" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> <span class="fl">0.7</span>,</span>
<span id="cb13-854"><a href="#cb13-854" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb13-855"><a href="#cb13-855" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-856"><a href="#cb13-856" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(</span>
<span id="cb13-857"><a href="#cb13-857" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill =</span> groupe, <span class="at">shape =</span> groupe),</span>
<span id="cb13-858"><a href="#cb13-858" aria-hidden="true" tabindex="-1"></a>    <span class="at">side =</span> <span class="st">"bottom"</span>,</span>
<span id="cb13-859"><a href="#cb13-859" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale =</span> <span class="fl">0.45</span>,</span>
<span id="cb13-860"><a href="#cb13-860" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_size =</span> <span class="fl">1.5</span>,</span>
<span id="cb13-861"><a href="#cb13-861" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> <span class="fl">0.7</span>,</span>
<span id="cb13-862"><a href="#cb13-862" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_interval =</span> mean_qi,</span>
<span id="cb13-863"><a href="#cb13-863" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="fl">1.1</span>,</span>
<span id="cb13-864"><a href="#cb13-864" aria-hidden="true" tabindex="-1"></a>    <span class="at">slab_linewidth =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb13-865"><a href="#cb13-865" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-866"><a href="#cb13-866" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">data =</span> avg_predictions_lm2,</span>
<span id="cb13-867"><a href="#cb13-867" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">colour =</span> groupe), <span class="at">width =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb13-868"><a href="#cb13-868" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-869"><a href="#cb13-869" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(</span>
<span id="cb13-870"><a href="#cb13-870" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"test"</span> <span class="ot">=</span> egypt[<span class="dv">1</span>], <span class="st">"contr√¥le"</span> <span class="ot">=</span> egypt[<span class="dv">2</span>]),</span>
<span id="cb13-871"><a href="#cb13-871" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span>, <span class="st">"test"</span>),</span>
<span id="cb13-872"><a href="#cb13-872" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="st">"Contr√¥le"</span>, <span class="st">"test"</span> <span class="ot">=</span> <span class="st">"Test"</span>)) <span class="sc">+</span></span>
<span id="cb13-873"><a href="#cb13-873" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-874"><a href="#cb13-874" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb13-875"><a href="#cb13-875" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"test"</span> <span class="ot">=</span> egypt[<span class="dv">1</span>], <span class="st">"contr√¥le"</span> <span class="ot">=</span> egypt[<span class="dv">2</span>]),</span>
<span id="cb13-876"><a href="#cb13-876" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span>, <span class="st">"test"</span>),</span>
<span id="cb13-877"><a href="#cb13-877" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="st">"Contr√¥le"</span>, <span class="st">"test"</span> <span class="ot">=</span> <span class="st">"Test"</span>),</span>
<span id="cb13-878"><a href="#cb13-878" aria-hidden="true" tabindex="-1"></a>    <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb13-879"><a href="#cb13-879" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-880"><a href="#cb13-880" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(</span>
<span id="cb13-881"><a href="#cb13-881" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"test"</span> <span class="ot">=</span> <span class="dv">16</span>, <span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="dv">17</span>),</span>
<span id="cb13-882"><a href="#cb13-882" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span>, <span class="st">"test"</span>),</span>
<span id="cb13-883"><a href="#cb13-883" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"contr√¥le"</span> <span class="ot">=</span> <span class="st">"Contr√¥le"</span>, <span class="st">"test"</span> <span class="ot">=</span> <span class="st">"Test"</span>)) <span class="sc">+</span></span>
<span id="cb13-884"><a href="#cb13-884" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-885"><a href="#cb13-885" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">100</span>), <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb13-886"><a href="#cb13-886" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-887"><a href="#cb13-887" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-888"><a href="#cb13-888" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Effets contrefactuels individuels :&lt;br&gt;Groupes Test &amp; Contr√¥le"</span>,</span>
<span id="cb13-889"><a href="#cb13-889" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Distribution des effets pr√©dits."</span>,</span>
<span id="cb13-890"><a href="#cb13-890" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb13-891"><a href="#cb13-891" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"≈∂"</span>) <span class="sc">+</span></span>
<span id="cb13-892"><a href="#cb13-892" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-893"><a href="#cb13-893" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb13-894"><a href="#cb13-894" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"none"</span>,</span>
<span id="cb13-895"><a href="#cb13-895" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb13-896"><a href="#cb13-896" aria-hidden="true" tabindex="-1"></a>      <span class="at">override.aes =</span> <span class="fu">list</span>(</span>
<span id="cb13-897"><a href="#cb13-897" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="fu">c</span>(egypt[<span class="dv">2</span>], egypt[<span class="dv">1</span>]),</span>
<span id="cb13-898"><a href="#cb13-898" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill   =</span> <span class="fu">c</span>(egypt[<span class="dv">2</span>], egypt[<span class="dv">1</span>]),</span>
<span id="cb13-899"><a href="#cb13-899" aria-hidden="true" tabindex="-1"></a>        <span class="at">slab_alpha =</span> <span class="dv">0</span>,</span>
<span id="cb13-900"><a href="#cb13-900" aria-hidden="true" tabindex="-1"></a>        <span class="at">linetype =</span> <span class="dv">0</span>)))</span>
<span id="cb13-901"><a href="#cb13-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-902"><a href="#cb13-902" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> delta_i <span class="sc">%&gt;%</span></span>
<span id="cb13-903"><a href="#cb13-903" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-904"><a href="#cb13-904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> contraste, <span class="at">y =</span> estimate)) <span class="sc">+</span></span>
<span id="cb13-905"><a href="#cb13-905" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-906"><a href="#cb13-906" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_slab</span>(</span>
<span id="cb13-907"><a href="#cb13-907" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill =</span> contraste),</span>
<span id="cb13-908"><a href="#cb13-908" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale =</span> <span class="fl">0.45</span>,</span>
<span id="cb13-909"><a href="#cb13-909" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="cn">NA</span>,</span>
<span id="cb13-910"><a href="#cb13-910" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> <span class="fl">0.7</span>,</span>
<span id="cb13-911"><a href="#cb13-911" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb13-912"><a href="#cb13-912" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-913"><a href="#cb13-913" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(</span>
<span id="cb13-914"><a href="#cb13-914" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill =</span> contraste),</span>
<span id="cb13-915"><a href="#cb13-915" aria-hidden="true" tabindex="-1"></a>    <span class="at">side =</span> <span class="st">"bottom"</span>,</span>
<span id="cb13-916"><a href="#cb13-916" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale =</span> <span class="fl">0.45</span>,</span>
<span id="cb13-917"><a href="#cb13-917" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_size =</span> <span class="dv">2</span>,</span>
<span id="cb13-918"><a href="#cb13-918" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> <span class="fl">0.7</span>,</span>
<span id="cb13-919"><a href="#cb13-919" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_interval =</span> mean_qi,</span>
<span id="cb13-920"><a href="#cb13-920" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="fl">1.1</span>,</span>
<span id="cb13-921"><a href="#cb13-921" aria-hidden="true" tabindex="-1"></a>    <span class="at">slab_linewidth =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb13-922"><a href="#cb13-922" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-923"><a href="#cb13-923" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(</span>
<span id="cb13-924"><a href="#cb13-924" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> delta_avg,</span>
<span id="cb13-925"><a href="#cb13-925" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">colour =</span> contraste),</span>
<span id="cb13-926"><a href="#cb13-926" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">0</span>,</span>
<span id="cb13-927"><a href="#cb13-927" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb13-928"><a href="#cb13-928" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-929"><a href="#cb13-929" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Test - Contr√¥le"</span> <span class="ot">=</span> egypt[<span class="dv">1</span>]), <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb13-930"><a href="#cb13-930" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-931"><a href="#cb13-931" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-932"><a href="#cb13-932" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Effets contrefactuels individuel :&lt;br&gt;Œî Test - Contr√¥le"</span>,</span>
<span id="cb13-933"><a href="#cb13-933" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Distribution des effets pr√©dits."</span>,</span>
<span id="cb13-934"><a href="#cb13-934" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb13-935"><a href="#cb13-935" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Œî ≈∂ (Test - Contr√¥le)"</span>) <span class="sc">+</span></span>
<span id="cb13-936"><a href="#cb13-936" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-937"><a href="#cb13-937" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="st">"none"</span>)</span>
<span id="cb13-938"><a href="#cb13-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-939"><a href="#cb13-939" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(</span>
<span id="cb13-940"><a href="#cb13-940" aria-hidden="true" tabindex="-1"></a>  p4, p5,</span>
<span id="cb13-941"><a href="#cb13-941" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="st">"v"</span>, </span>
<span id="cb13-942"><a href="#cb13-942" aria-hidden="true" tabindex="-1"></a>  <span class="at">common.legend =</span> <span class="cn">TRUE</span>, </span>
<span id="cb13-943"><a href="#cb13-943" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="st">"bottom"</span>)</span>
<span id="cb13-944"><a href="#cb13-944" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb13-945"><a href="#cb13-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-946"><a href="#cb13-946" aria-hidden="true" tabindex="-1"></a><span class="fu"># Conclusion</span></span>
<span id="cb13-947"><a href="#cb13-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-948"><a href="#cb13-948" aria-hidden="true" tabindex="-1"></a>L'@eq-controle_interaction a permis de retrouver le vrai effet moyen de l'intervention $\beta$ = <span class="in">`r round(marginal_comparisons_lm2$estimate, 2)`</span>. Cet effet moyen peut √™tre rapport√© de plusieurs fa√ßons :</span>
<span id="cb13-949"><a href="#cb13-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-950"><a href="#cb13-950" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Sous la forme d'une table (cf. @tbl-lm2).</span>
<span id="cb13-951"><a href="#cb13-951" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Sous la forme d'un graphique</span>
<span id="cb13-952"><a href="#cb13-952" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Soit les moyennes marginales des groupes tests &amp; contr√¥le, via des points ou des barres, comme la @fig-plot_lm2_simple.</span>
<span id="cb13-953"><a href="#cb13-953" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Soit l'effet de traitement moyen. C'est la @fig-plot_lm2_ate.</span>
<span id="cb13-954"><a href="#cb13-954" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Soit la distribution des effets contrefactuels *par groupe*. C‚Äôest-√†-dire, pour chaque observation et √† covariables constantes, $\hat{Y_i}$. C'est le graphique de gauche de la @fig-plot_lm2_hetero.</span>
<span id="cb13-955"><a href="#cb13-955" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Soit la distribution des effets contrefactuels *individuels*. C'est le graphique de droite de la @fig-plot_lm2_hetero. C‚Äôest-√†-dire, pour chaque observation et √† covariables constantes, la diff√©rence $\hat{Y_i}(\text{test}) - \hat{Y_i}(\text{contr√¥le})$.</span>
<span id="cb13-956"><a href="#cb13-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-957"><a href="#cb13-957" aria-hidden="true" tabindex="-1"></a>Au-del√† des aspects techniques, une question demeure pour ma part : est-ce coh√©rent de repr√©senter des quantit√©s contrefactuelles *√† la maille individuelle* ? Si l'effet de traitement moyen est non-biais√© </span>
<span id="cb13-958"><a href="#cb13-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-959"><a href="#cb13-959" aria-hidden="true" tabindex="-1"></a><span class="fu"># R√©f√©rences</span></span>
</code><button title="Copier vers le presse-papier" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>